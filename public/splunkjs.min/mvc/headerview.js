define("contrib/text!views/shared/splunkbar/AppMenu.html",[],function(){return'<%\n    currentAppname = currentApp ? currentApp.name : \'search\';   // TODO: search fallback is not always safe assumption\n%>\n<a href="#" class="dropdown-toggle"><%- currentApp ? _(\'App: \').t() + _(currentApp.label).t() : _(\'Apps\').t() %><b class="caret"></b></a>\n<div class="dropdown-menu dropdown-menu-selectable dropdown-menu-tall" id="global-apps-menu">\n    <div class="arrow"></div>\n    <ul class="menu-list">\n        <% _.each(apps, function(i) { %>\n        <li>\n            <a href="<%- i.href %>">\n                <% if (currentApp && i.name === currentApp.name) { %> <i class="icon-check"></i><% } %>\n                <% if (i.icon) { %> <img data-icosrc="<%-i.icon%>" alt="menu icon" class="menu-icon" style="display:none;"><% } %>\n                <span class="menu-label"><%- _(i.label).t() %></span>\n            </a>\n        </li>\n        <% }); %>\n    </ul>\n    <ul>\n        <li><a href="<%- make_url(\'manager\', currentAppname, \'apps\',\'local\') %>"><%- _("Manage Apps").t() %></a></li>\n        <% if(canManageRemoteApps){ %>\n        <li id="findMoreAppsNav"><a href="<%- make_url(\'manager\', currentAppname, \'apps\',\'remote\') %>" ><%- _("Find More Apps").t() %></a></li>\n        <%} %>\n    </ul>\n</div>\n'}),define("views/shared/splunkbar/AppMenu",["jquery","module","views/Base","views/shared/delegates/Popdown","splunk.util","contrib/text!views/shared/splunkbar/AppMenu.html","uri/route"],function(e,t,n,r,i,s,o){return n.extend({moduleId:t.id,template:s,tagName:"li",className:"dropdown menu-apps",initialize:function(){this.haveIcons=!1,n.prototype.initialize.apply(this,arguments),this.options.activeMenu&&this.options.activeMenu.name==="app"&&(this.currentApp=this.model.application.get("app")),this.collection.apps.on("ready change reset",this.debouncedRender,this),this.model.user.on("ready change",this.debouncedRender,this),this.collection.apps.length>0&&this.debouncedRender()},render:function(){this.haveIcons=!1;var e=this,t,n=null,s=this.collection.apps.map(function(r,s,u){var a=o.appIconAlt(e.model.application.get("root"),e.model.application.get("locale"),e.model.application.get("owner"),r.entry.get("name"));return t={href:i.make_url("/app/"+r.entry.get("name")),label:r.entry.content.get("label"),name:r.entry.get("name"),icon:a},r.entry.get("name")===e.currentApp&&(n=t),t}),u=this.compiledTemplate({apps:s,currentApp:n,make_url:i.make_url,canManageRemoteApps:e.model.user.canManageRemoteApps()});return this.$el.html(u),this.popdown=new r({el:this.$("#global-apps-menu").parent(),mode:"dialog"}),this.popdown.on("show",this.setIcons,this),this},setIcons:function(){if(this.haveIcons)return;this.haveIcons=!0;var t=this.$el.find(".menu-icon");t.each(function(t,n){n=e(n),n.attr("src",n.attr("data-icosrc")).show()})}})}),define("contrib/text!views/shared/splunkbar/SystemMenuSection.html",[],function(){return"<i class=\"icon icon-<%-this.model.get('icon')%>\"></i>\n<h5><%=this.model.get('label')%></h5>\n<ul class=\"menu\">\n    <% var addedItems = []; %>\n    <%_.each(this.model.get('items'), function(item, i){ %>\n        <% if(_.indexOf(addedItems, item.entry.content.get('menu.label')) === -1) {%>    \n            <li><a href=\"<%-item.get('url')%>\"><%-_(item.entry.content.get('menu.label')).t() || _(item.entry.get('name')).t() || ''%></a></li>\n            <% addedItems.push(item.entry.content.get('menu.label')); %>\n        <%}%>\n    <%});%>\n</ul>\n"}),define("views/shared/splunkbar/SystemMenuSection",["jquery","underscore","module","views/Base","contrib/text!views/shared/splunkbar/SystemMenuSection.html"],function(e,t,n,r,i){return r.extend({moduleId:n.id,template:i,className:"menu-section",initialize:function(){r.prototype.initialize.apply(this,arguments);var e=this.model.get("items");e.sort(function(e,t){return parseInt(e.get("order"),10)-parseInt(t.get("order"),10)})},render:function(){var e=this.compiledTemplate(this.model);return this.$el.html(e),this}})}),define("contrib/text!views/shared/splunkbar/SystemMenu.html",[],function(){return'<a href="#" class="dropdown-toggle"><%- _("Settings").t() %><b class="caret"></b></a>\n<div class="popdown-dialog mega-menu" id="global-system-menu">\n    <div class="arrow"></div>\n    <div class="popdown-dialog-body">\n    </div><!-- /.popdown-dialog-body -->\n</div><!-- /.podown -->'}),define("views/shared/splunkbar/SystemMenu",["jquery","underscore","backbone","module","splunk.util","views/Base","views/shared/delegates/Popdown","views/shared/splunkbar/SystemMenuSection","contrib/text!views/shared/splunkbar/SystemMenu.html"],function(e,t,n,r,i,s,o,u,a){return s.extend({moduleId:r.id,template:a,tagName:"li",className:"dropdown menu-system",initialize:function(){var e=this;s.prototype.initialize.apply(this,arguments),e.debouncedRender(),this.collection.sections.on("ready",function(){e.debouncedRender()},this)},render:function(){var t=this.compiledTemplate({}),n=e(t),r=n.find(".popdown-dialog-body");this.addSections(r),this.sectionCount<2&&r.parent().addClass("mega-menu-narrow"),this.$el.html(n);var i=this.$el.find("#global-system-menu");return this.children.popdown=new o({el:i.parent(),mode:"dialog"}),this},addSections:function(e){var t=this;this.sectionCount=0,this.collection.sections.each(function(n){if(n.get("items")&&n.get("items").length===0)return;var r=t.children[n.get("id")]=new u({model:n});t.sectionCount++,e.append(r.render().el)})}})}),define("contrib/text!views/shared/splunkbar/UserMenu.html",[],function(){return'<a href="#" class="dropdown-toggle"><span class="realname"><%-realName%></span><b class="caret"></b></a>\n<div class="dropdown-menu dropdown-menu-narrow global-user-menu">\n    <div class="arrow"></div>\n    <ul>\n        <li><a href="<%-accountLink%>" class="edit"><%- _("Edit Account").t() %></a></li>\n        <% if (logoutLink) { %>\n        <li><a href="<%-logoutLink%>" class="logout"><%- _("Logout").t() %></a></li>\n        <% } %>\n    </ul>\n</div>'}),define("views/shared/splunkbar/UserMenu",["underscore","module","views/Base","views/shared/delegates/Popdown","contrib/text!views/shared/splunkbar/UserMenu.html","uri/route"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,template:i,tagName:"li",className:"dropdown user",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.user.on("change",this.render,this),this.model.webConf.on("change reset",this.render,this),this.model.user.entry.get("name")&&this.render()},checkSSO:function(){var e=this.model.webConf&&this.model.webConf.entry&&this.model.webConf.entry.content&&this.model.webConf.entry.content.get("trustedIP");this.SSOModeOn=typeof e=="string"&&e.length>0&&this.model.config&&typeof this.model.config.get("REMOTE-USER")=="string"},render:function(){this.checkSSO();var e=this.model.user.entry.content.get("realname"),t=this.model.user.entry.get("name");if(!e||!e.length)e=t;var n=this.model.application.get("root"),i=this.model.application.get("locale"),o=s.manager(n,i,this.model.application.get("app"),["authentication","changepassword",t],{data:{action:"edit"}}),u=this.SSOModeOn?null:s.logout(n,i),a=this.compiledTemplate({userName:t,realName:e,accountLink:o,logoutLink:u});this.$el.html(a);var f=this.$el.find(".global-user-menu");return this.popdown=new r({el:f.parent(),mode:"dialog"}),this}})}),define("views/shared/splunkbar/messages/Message",["jquery","underscore","backbone","module","views/Base","splunk.util","util/time"],function(e,t,n,r,i,s,o){return i.extend({moduleId:r.id,className:"view-navbar-global navbar navbar-fixed-top",messageMap:{restart_required:t("Splunk must be restarted for changes to take effect. [[/manager/search/control|Click here to restart from the Manager]].").t()},initialize:function(){i.prototype.initialize.apply(this,arguments)},render:function(){var t=this.model.id,n=this.model.entry.get("name")||"",r,i=this.model.entry.content.get("severity")||"warn";n&&this.messageMap[n]?r=this.messageMap[n]:r=this.model.entry.content.get("message")||"";var u=this.model.entry.content.get("timeCreated_iso");if(u){var a=o.isoToDateObject(u);u=a.toLocaleString()}var f=this.compiledTemplate({msgId:n,msgFullId:t,msg:s.getWikiTransform(r),msgLevel:i,msgTime:u||""});return this.$el=e(f),this},template:'<li class="<%- msgLevel %>" data-id="<%- msgFullId %>">                <i class="message-icon icon-<%- msgLevel %>"></i>                <span class="message-content"><%= msg %></span>                <span class="message-time"><%= msgTime %></span>                <a href="#" class="delete-message"><i class="icon-x-circle"></i></a>            </li>'})}),define("views/shared/splunkbar/messages/LegacyMessage",["jquery","underscore","backbone","module","views/Base","splunk.util"],function(e,t,n,r,i,s){return i.extend({moduleId:r.id,className:"view-navbar-global navbar navbar-fixed-top",messageMap:{restart_required:t("Splunk must be restarted for changes to take effect. [[/manager/search/control|Click here to restart from the Manager]].").t()},initialize:function(){i.prototype.initialize.apply(this,arguments)},render:function(){var t=(this.model.get("id")||"").toLowerCase(),n,r=this.model.get("severity")||"warn";t&&this.messageMap[t]?n=this.messageMap[t]:n=this.model.get("content")||"";var i=this.compiledTemplate({msgId:t,msg:s.getWikiTransform(n),msgLevel:r});return this.$el=e(i),this},template:'<li class="<%- msgLevel %>" data-islegacy="1" data-id="<%- msgId %>">                <span class="message-content"><%= msg %></span>                <a href="#" class="delete-message"><i class="icon-x-circle"></i></a>            </li>'})}),define("contrib/text!views/shared/splunkbar/messages/Master.html",[],function(){return'<a href="#" class="dropdown-toggle">\n    <span class="label label-warning" style="display: none;"><%- collection.length %></span> <%- _("Messages").t() %><b class="caret"></b>\n</a>\n<div class="dropdown-menu" id="global-messages-menu">\n\n    <div class="arrow"></div>\n    <ul class="message-list" style="display: none;">\n    </ul>\n    <div class="no-messages">\n        <%- _("You have no messages.").t() %>\n    </div>\n    <div class="popdown-dialog-footer" style="display: none;">\n        <a href="#" class="delete-all-messages btn pull-right"><%- _("Delete All").t() %></a>\n    </div>\n</div>\n'}),define("views/shared/splunkbar/messages/Master",["jquery","underscore","module","views/Base","views/shared/delegates/Popdown","views/shared/delegates/StopScrollPropagation","collections/services/Messages","views/shared/splunkbar/messages/Message","views/shared/splunkbar/messages/LegacyMessage","contrib/text!views/shared/splunkbar/messages/Master.html","util/general_utils"],function(e,t,n,r,i,s,o,u,a,f,l){return r.extend({moduleId:n.id,template:f,tagName:"li",className:"dropdown messages",initialize:function(){r.prototype.initialize.apply(this,arguments),this.legacyMessages=this.collection.legacyMessages||!1,this.collection=this.collection.messages,this.collection.on("change reset remove",this.renderMessages,this),this.legacyMessages&&this.legacyMessages.on("reset remove",this.renderMessages,this),this.isLocalMouseSelection=!1},events:{"click .message-list .delete-message":"deleteMessage","click .delete-all-messages":"deleteAllMessages","mouseup .message-list":function(){this.isLocalMouseSelection=!0}},render:function(){var e=this.compiledTemplate({collection:this.collection});return this.$el.html(e),this.children.popdown=new i({el:this.el,mode:"dialog"}),this.children.stopScrollPropagation=new s({el:this.$("#global-messages-menu ul"),mode:"dialog"}),this},renderMessages:function(e){if(e!==!0&&this.isLocalMouseSelection&&l.getMouseSelection()&&l.getMouseSelection().length>0)return;this.isLocalMouseSelection=!1;var n=this.collection.length;this.legacyMessages&&(n+=this.legacyMessages.length),this.$(".label-warning").text(n),t.each(this.children,function(e,t){t.substr(0,7)=="message"&&(this.children[t].remove(),delete this.children[t])},this);var r;this.collection.each(function(e,t){r=new u({model:e}),this.children["message"+e.get("id")]=r,this.$("#global-messages-menu .message-list").append(r.render().$el)},this);var i=0;this.legacyMessages&&(i=this.legacyMessages.length,this.legacyMessages.each(function(e){r=new a({model:e}),this.children["messageLegacy"+e.get("id")]=r,this.$("#global-messages-menu .message-list").append(r.render().$el)},this)),this.collection.length>0||i>0?(this.$(".label-warning, .popdown-dialog-footer, .message-list").show(),this.$("#global-messages-menu").addClass("dropdown-menu-wide"),this.$(".no-messages").hide(),this.$("#global-messages-menu").is(":visible")&&this.children.popdown.adjustPosition()):(this.$(".label-warning, .popdown-dialog-footer, .message-list").hide(),this.$("#global-messages-menu").removeClass("dropdown-menu-wide"),this.$(".no-messages").show())},deleteMessage:function(t){t.preventDefault();var n=e(t.currentTarget).parent(),r=n.data("id"),i=n.data("islegacy"),s;this.legacyMessages&&i?(s=this.legacyMessages.get(r),s&&this.legacyMessages.remove(s)):(s=this.collection.get(r),s&&s.destroy()),this.collection.length===0&&(this.legacyMessages===!1||this.legacyMessages.length===0)&&this.children.popdown.hide(),this.renderMessages(!0)},deleteAllMessages:function(e){e.preventDefault(),this.collection.destroyAll(),this.legacyMessages&&this.legacyMessages.reset(),this.children.popdown.hide()}})}),define("contrib/text!views/shared/splunkbar/ActivityMenu.html",[],function(){return'<a href="#" class="dropdown-toggle"><%- _("Activity").t() %><b class="caret"></b></a>\n<div class="dropdown-menu dropdown-menu-narrow" id="global-activity-menu">\n    <div class="arrow"></div>\n    <ul>\n        <li>\n            <a class="primary-link" href="<%= jobLink %>"><%- _("Jobs").t() %></a>\n            <a class="secondary-link" href="<%= jobLink %>" target="_blank"><i class="icon-external"></i></a>\n        </li>\n        <li>\n            <a class="primary-link" href="<%= alertsLink %>"><%- _("Triggered Alerts").t() %></a>\n            <a class="secondary-link" href="<%= alertsLink %>" target="_blank"><i class="icon-external"></i></a>\n        </li>\n	<% if (typeof statusLink !== "undefined" && statusLink !== null) { %>\n		<li>\n		    <a class="primary-link" href="<%= statusLink %>"><%- _("System Activity").t() %></a>\n		    <a class="secondary-link" href="<%= statusLink %>" target="_blank"><i class="icon-external"></i></a>\n		</li>\n	<% } %>\n    </ul>\n</div>\n'}),define("views/shared/splunkbar/ActivityMenu",["underscore","jquery","module","views/Base","views/shared/delegates/Popdown","contrib/text!views/shared/splunkbar/ActivityMenu.html","splunk.util","uri/route"],function(e,t,n,r,i,s,o,u){return r.extend({moduleId:n.id,template:s,tagName:"li",className:"dropdown activity",initialize:function(){r.prototype.initialize.apply(this,arguments),this.render(),this.model.application.on("change",this.render),this.model.user.on("change",this.render)},render:function(){if(typeof this.model.application.get("app")=="undefined"||typeof this.model.user.entry.content.get("roles")=="undefined")return this;var e=this.model.application.get("app"),t=this.model.user.entry.content.get("roles").indexOf("admin")>-1,n=u.page(this.model.application.get("root"),this.model.application.get("locale"),e,"job_management"),r=u.triggeredAlerts(this.model.application.get("root"),this.model.application.get("locale"),e),s=null;e=="system"&&(n=u.page(this.model.application.get("root"),this.model.application.get("locale"),"search","job_management")),t&&(s=u.page(this.model.application.get("root"),this.model.application.get("locale"),"search","status_index"));var o=this.compiledTemplate({jobLink:n,alertsLink:r,statusLink:s});return this.$el.html(o),this.children.popdown=new i({el:this.el,mode:"dialog"}),this}})}),define("contrib/text!views/shared/whatsnewdialog/Master.html",[],function(){return'<h2><%=_("Empower More People").t()%></h2>\n<div class="feature">\n    <h3><%=_("Dashboard Editor Enhancements").t()%></h3>\n    <p><%=_("Build rich, dynamic dashboards with a point-and-click UI.").t()%></p>\n    <a href="<%=docLink%>whatsnew.dashboardeditor" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Contextual Drilldown").t()%></h3>\n    <p><%=_("Easy access to contextual information and analytics without leaving the page.").t()%></p>\n    <a href="<%=docLink%>whatsnew.contextualdrill" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Chart Overlay").t()%></h3>\n    <p><%=_("Plot disparate data on top of each other to visualize trends.").t()%></p>\n    <a href="<%=docLink%>whatsnew.chartoverlay" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Data Model Enhancements").t()%></h3>\n    <p><%=_("Create and share data models more easily via the new Data Model builder.").t()%></p>\n    <a href="<%=docLink%>whatsnew.newdatamodel" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Pan and Zoom Chart Controls").t()%></h3>\n    <p><%=_("Intuitively explore large amounts of data in your visualizations.").t()%></p>\n    <a href="<%=docLink%>whatsnew.panandzoom" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<h2><%=_("Mission Critical Enterprise").t()%></h2>\n<div class="feature">\n    <h3><%=_("Multi-site Clustering").t()%></h3>\n    <p><%=_("Site aware index replication across multiple locations for high availability of data in the event of an entire site failure.").t()%></p>\n    <a href="<%=docLink%>whatsnew.multisite" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Search Affinity").t()%></h3>\n    <p><%=_("Increase search efficiency with site-aware index replication so that search heads can distribute searches based on location.").t()%></p>\n    <a href="<%=docLink%>whatsnew.searchaffinity" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Data Preview with Structured Inputs").t()%></h3>\n    <p><%=_("View and interact with fields found in a file header or within the body of your structured data source.").t()%></p>\n    <a href="<%=docLink%>whatsnew.previewstructured" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("zLinux Forwarder").t()%></h3>\n    <p><%=_("Expand your ability to collect data from Mainframes running the zLinux operating system.").t()%></p>\n    <a href="<%=docLink%>whatsnew.zlinuxforwarder" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Low Privilege Windows Universal Forwarder").t()%></h3>\n    <p><%=_("Run the Splunk Universal forwarder on Windows platforms as a domain user without having to grant local administrator privileges.").t()%></p>\n    <a href="<%=docLink%>whatsnew.windowsforwarder" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n\n\n\n<h2><%=_("Better Collaboration").t()%></h2>\n<div class="feature">\n    <h3><%=_("Custom Email Alerts").t()%></h3>\n    <p><%=_("Create actionable alerts by controlling both the content and format of the email.").t()%></p>\n    <a href="<%=docLink%>whatsnew.newemailalerts" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n\n<div class="feature">\n    <h3><%=_("Embedded Reports").t()%></h3>\n    <p><%=_("Combine Splunk charts with any HTML-based dashboard or web-page with simplified sharing controls.").t()%></p>\n    <a href="<%=docLink%>whatsnew.embeddedreports" class="external" target="_blank"><%=_("Documentation").t()%></a>\n</div>\n'}),define("views/shared/whatsnewdialog/Master",["jquery","underscore","module","views/Base","views/shared/Modal","uri/route","splunk.util","contrib/text!views/shared/whatsnewdialog/Master.html"],function(e,t,n,r,i,s,o,u){return i.extend({moduleId:n.id,template:u,initialize:function(){i.prototype.initialize.apply(this,arguments);var e=this;this.on("hidden",function(){e.$el.remove(),e.modalWrapper.remove()}),this.render()},render:function(){var n=o.make_url("/static/img/"),r=s.docHelp(this.model.application.get("root"),this.model.application.get("locale"),""),u=this.compiledTemplate({imgPath:n,docLink:r});return this.$el.html(i.TEMPLATE),this.$(i.HEADER_TITLE_SELECTOR).html(t("What's new in 6.1").t()),this.$(i.BODY_SELECTOR).html(u),this.modalWrapper=e('<div class="splunk-components"></div>'),e(this.el).appendTo(this.modalWrapper),this.modalWrapper.appendTo("body"),this.show(),this}})}),define("contrib/text!views/shared/splunkbar/HelpMenu.html",[],function(){return'<a href="#" class="dropdown-toggle"><%- _("Help").t() %><b class="caret"></b></a>\n<div class="dropdown-menu" id="global-help-menu">\n    <div class="arrow"></div>\n    <ul>\n        <li><a class="whatsnew" href="#"><%- _("What\'s New in 6.1").t() %></a></li>\n        <li><a class="external" href="<%- makeDocLink(\'search_app.tutorial\') %>" target="_blank"><%- _("Tutorials").t() %></a></li>\n        <li><a class="external" href="http://splunk-base.splunk.com/" target="_blank"><%- _("Splunk Answers").t() %></a></li>\n        <li><a class="external" href="http://www.splunk.com/support" target="_blank"><%- _("Contact Support").t() %></a></li>\n        <li><a class="external" href="<%- docLink %>" target="_blank"><%- _("Documentation").t() %></a></li>\n    </ul>\n    <form class="form-search" action="#help" method="get">\n    </form>\n</div>\n'}),define("views/shared/splunkbar/HelpMenu",["underscore","jquery","module","views/Base","views/shared/delegates/Popdown","views/shared/controls/TextControl","views/shared/whatsnewdialog/Master","contrib/text!views/shared/splunkbar/HelpMenu.html","splunk.util","uri/route"],function(e,t,n,r,i,s,o,u,a,f){return r.extend({moduleId:n.id,template:u,tagName:"li",className:"dropdown help",initialize:function(){r.prototype.initialize.apply(this,arguments),this.children.searchInput=new s({placeholder:e("Search Documentation").t(),inputClassName:"input-medium search-query"}),this.model.appLocal.on("change reset",this.debouncedRender,this),this.debouncedRender()},events:{"keypress input":"onDocsSearch","click .whatsnew":"onWhatsNew","click .dropdown-menu a":"closePopdown"},render:function(){var e=this.compiledTemplate({docLink:this.makeDocLinkForPage(),makeDocLink:this.makeDocLink.bind(this)});this.$el.html(e);var t=this.$("#global-help-menu");return t.find(".form-search").append(this.children.searchInput.render().el),this.children.popdown=new i({el:t.parent(),mode:"dialog"}),this},onDocsSearch:function(e){if(e.keyCode===13){var n=t(e.target).val();e.preventDefault(),e.stopPropagation(),t.when(this.serverInfoDfd).then(function(){var e=f.docSearch(this.model.application.get("locale"),this.model.serverInfo.entry.content.get("version"),a.normalizeBoolean(this.model.serverInfo.entry.content.get("isFree")),a.normalizeBoolean(this.model.serverInfo.entry.content.get("isTrial")),n);window.open(e)}.bind(this)),t(e.target).val(""),this.closePopdown(),e.preventDefault()}},makeDocLink:function(e){return f.docHelpInAppContext(this.model.application.get("root"),this.model.application.get("locale"),e,this.model.application.get("app"),this.model.appLocal.entry.content.get("version"),this.model.appLocal.appAllowsDisable(),this.model.appLocal.entry.content.get("docs_section_override"))},makeDocLinkForPage:function(){var e="/help",t;if(this.model.application.get("page")==="_admin"){t="manager";if(window&&window.location&&typeof window.location.pathname=="string"){var n=window.location.pathname;n=n.substring(n.indexOf("/manager/")+9),n=n.substring(n.indexOf("/")+1),n=n.replace(new RegExp("/","g"),"."),t+="."+n}e=f.docHelp(this.model.application.get("root"),this.model.application.get("locale"),t)}else t=["app",this.model.application.get("app"),this.model.application.get("page")].join("."),e=this.makeDocLink(t);return e},onWhatsNew:function(e){e&&e.preventDefault(),this.children.whatsNewDialog=new o({model:this.model})},closePopdown:function(e){this.children.popdown.hide()}})}),define("views/shared/WaitSpinner",["underscore","module","views/Base"],function(e,t,n,r){return n.extend({moduleId:t.id,tagName:"div",initialize:function(){var t={size:"small",color:"gray",frameWidth:14,frameCount:8,fps:10};e.defaults(this.options,t),n.prototype.initialize.apply(this,arguments),this.$el.addClass("spinner-"+this.options.size+"-"+this.options.color),this.frame=0},stop:function(){return this.active=!1,this.interval&&window.clearInterval(this.interval),this},start:function(){return this.active=!0,this.interval&&window.clearInterval(this.interval),this.interval=setInterval(this.step.bind(this),1e3/this.options.fps),this},step:function(){return this.$el.css("backgroundPosition","-"+this.frame*this.options.frameWidth+"px top "),this.frame++,this.frame=this.frame==this.options.frameCount?0:this.frame,this},remove:function(){this.stop(),n.prototype.remove.apply(this,arguments)},render:function(){return this}})}),define("contrib/text!views/shared/splunkbar/messages/NoConnectionOverlay.html",[],function(){return'<div class="modal-backdrop fade in"></div>\n<div class="modal disconnection-warning-modal">\n	<h3><%= _("Reconnecting to Splunk server").t() %></h3>\n	<p><%= _("Your network connection may have been lost or Splunk server may be down.").t() %></p>\n</div>\n'}),define("views/shared/splunkbar/messages/NoConnectionOverlay",["underscore","module","views/Base","views/shared/WaitSpinner","contrib/text!views/shared/splunkbar/messages/NoConnectionOverlay.html","splunk.util"],function(e,t,n,r,i,s){var o=new Image;o.src=s.make_url("/static/img/skins/default/loading_medium_green.png");var u=new Image;return u.src=s.make_url("/static/img/skins/default/loading_medium_green_2x.png"),n.extend({moduleId:t.id,template:i,className:"splunk-components",initialize:function(){n.prototype.initialize.apply(this,arguments);var e={color:"green",size:"medium",frameWidth:19};this.children.spinner=new r(e),this.visible=!1,this.$el.hide()},show:function(){if(this.visible)return;this.visible=!0,this.$el.show(),this.children.spinner.start()},hide:function(){if(!this.visible)return;this.visible=!1,this.$el.hide(),this.children.spinner.stop()},render:function(){return this.$el.html(this.compiledTemplate),this.$(".modal").append(this.children.spinner.render().el),this}})}),define("contrib/text!views/shared/splunkbar/Master.html",[],function(){return'\n<div class="navbar-inner">\n    <div class="no_connection-overlay"></div>\n    <a href="<%-homeLink%>" class="brand" title="splunk &gt; <%- _(\'listen to your data\').t() %>">splunk<strong>&gt;</strong></a>\n    <ul class="navbar-global-nav nav">\n        <li class="dropdown apps">\n            <a href="#" class="dropdown-toggle"><%- _("Apps").t() %><b class="caret"></b></a>\n        </li>\n    </ul>\n\n    <ul class="navbar-global-nav nav pull-right">\n        <li class="dropdown user"></li>\n        <li class="dropdown messages"><a href="#" class="dropdown-toggle"><%- _("Messages").t() %><b class="caret"></b></a></li>\n        <li class="dropdown system<%- options.section==\'system\' ? \' active \' : \'\'%>">\n            <a href="#" class="dropdown-toggle"><%- _("System").t() %><b class="caret"></b></a>\n        </li>\n        <li class="dropdown activity"><a href="#"><%- _("Activity").t() %></a></li>\n        <li class="dropdown help"><a href="#" class="dropdown-toggle"><%- _("Help").t() %><b class="caret"></b></a></li>\n    </ul><!-- /.user-nav -->\n</div><!-- /.navbar-inner -->\n'}),define("util/csrf_protection",["jquery","splunk.util"],function(e,t){var n="X-Splunk-Form-Key",r=t.getFormKey();if(!r)return;if(!e)throw"Splunk's jQuery.ajax extension requires jQuery.";e.ajaxPrefilter(function(e,t,i){if(e.type&&e["type"].toUpperCase()=="GET")return;i.setRequestHeader(n,r)}),e(document).ready(function(){e(document).bind("ajaxError",function(e,n,r,i){var s=window.location.pathname;if(n.status===401&&s.indexOf("/account/logout")===-1){document.location=t.make_url("account/login?return_to="+encodeURIComponent(s+document.location.search));return}})})}),define("util/ajax_no_cache",["jquery"],function(e){if(!e)throw"ajax_no_cache requires jQuery.";e.ajaxPrefilter(function(e,t,n){e.type&&e.type.toUpperCase()=="GET"&&e.cache===undefined&&(e.cache=!1)})}),define("views/shared/splunkbar/Master",["jquery","underscore","backbone","module","splunk.util","helpers/Session","views/Base","views/shared/delegates/Popdown","views/shared/splunkbar/AppMenu","views/shared/splunkbar/SystemMenu","views/shared/splunkbar/UserMenu","views/shared/splunkbar/messages/Master","views/shared/splunkbar/ActivityMenu","views/shared/splunkbar/HelpMenu","views/shared/splunkbar/messages/NoConnectionOverlay","models/services/data/UserPref","models/services/AppLocal","models/services/authentication/User","models/services/server/ServerInfo","models/services/configs/Web","models/shared/Application","collections/services/authentication/CurrentContexts","collections/services/AppLocals","collections/services/Messages","collections/services/data/ui/Managers","collections/shared/splunkbar/SystemMenuSections","contrib/text!views/shared/splunkbar/Master.html","uri/route","splunk.util","util/splunkd_utils","util/csrf_protection","util/ajax_no_cache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){var O=o.extend({moduleId:r.id,template:C,className:"navbar",initialize:function(){o.prototype.initialize.apply(this,arguments),this.MAX_RETRIES_BEFORE_FAIL=3,this.MESSAGES_POLLING_DELAY_STANDARD=6e4,this.MESSAGES_POLLING_DELAY_HI_FREQ=1e3,this.isFreeDfd=e.Deferred(),this.cntRetries=0,this.model&&this.model.serverInfo&&this.model.serverInfo.entry.content.has("isFree")?L.normalizeBoolean(this.model.serverInfo.entry.content.get("isFree"))?this.isFreeDfd.resolve():this.isFreeDfd.reject():this.model&&this.model.serverInfo&&this.model.serverInfo.on("change reset",function(){L.normalizeBoolean(this.model.serverInfo.entry.content.get("isFree"))?this.isFreeDfd.resolve():this.isFreeDfd.reject()}.bind(this)),s.on("restart timeout",function(){this.collection.messages.stopPolling()},this),s.on("start",function(){this.collection.messages.startPolling()},this)},remove:function(){return o.prototype.remove.apply(this,arguments),s.off("restart timeout start",null,this),this},render:function(){var n=k.page(this.model.application.get("root"),this.model.application.get("locale"),"launcher","home"),r=this.compiledTemplate({makeUrl:i.make_url,options:this.options,homeLink:n});this.$el.html(r);var s=this.getActiveMenu();return this.children.apps=new a({collection:this.collection,model:this.model,activeMenu:s}),this.$(".apps.dropdown").replaceWith(this.children.apps.el),this.children.systemMenu=new f({collection:{sections:this.collection.sections},model:{application:this.model.application}}),this.$(".system.dropdown").replaceWith(this.children.systemMenu.el),this.isFreeDfd.fail(function(){this.children.userMenu=new l({collection:{currentContext:this.model.currentContext},model:{user:this.model.user,application:this.model.application,webConf:this.model.webConf,config:this.model.config}}),this.$(".user.dropdown").replaceWith(this.children.userMenu.el)}.bind(this)),this.children.messages=new c({collection:{messages:this.collection.messages,legacyMessages:this.collection.legacyMessages}}),this.children.noConnectionOverlay=new d,e("body").append(this.children.noConnectionOverlay.render().el),this.collection.messages.on("serverValidated",function(e,n,r){if(e&&this.cntRetries>0){this.restartMessagePolling(this.MESSAGES_POLLING_DELAY_STANDARD),this.children.noConnectionOverlay.hide(),this.cntRetries=0;return}var i=t.find(r,function(e){return e.type==A.NETWORK_ERROR||"network_error"});i&&(this.cntRetries==0&&this.restartMessagePolling(this.MESSAGES_POLLING_DELAY_HI_FREQ),this.cntRetries>=this.MAX_RETRIES_BEFORE_FAIL&&this.children.noConnectionOverlay.show(),this.cntRetries+=1)},this),this.$(".messages.dropdown").replaceWith(this.children.messages.render().el),this.restartMessagePolling(this.MESSAGES_POLLING_DELAY_STANDARD),this.children.activityMenu=new h({model:{user:this.model.user,application:this.model.application}}),this.$(".activity").replaceWith(this.children.activityMenu.el),this.children.helpMenu=new p({model:this.model}),this.$(".help").replaceWith(this.children.helpMenu.el),s&&this.$(s.selector).addClass("active"),this},restartMessagePolling:function(e){this.collection.messages.stopPolling(),this.collection.messages.startPolling({delay:e,uiInactivity:!0,stopOnError:!1,data:{count:1e3}})},getActiveMenu:function(){var e=n.history.location.pathname,t=e.split("/"),r=t.length,i=[t[r-2],t[r-1]],s=i.join("/"),o=this.model.application.get("locale"),u=this.model.application.get("app"),a=["search/status_index","search/search_status","search/search_detail_activity","search/search_activity_by_user","search/splunkweb_status","search/internal_messages","search/scheduler_status","search/scheduler_user_app","search/scheduler_savedsearch","search/scheduler_status_errors","search/pdf_activity"],f="authentication/changepassword",l=u+"/job_management",c=o+"/alerts",h="launcher/home",p=o+"/manager",d=null,v="";return a.indexOf(s)>-1||e.indexOf(l)>-1||e.indexOf(c)>-1?(d=".activity",v="activity"):e.indexOf(f)>-1?(d=".user",v="user"):e.indexOf(p)>-1?(d="menu-system",v="manager"):e.indexOf(h)>-1?(d=".brand",v="home"):(d=".menu-apps",v="app"),{selector:d,name:v}}},{create:function(n){n=n||{},n.collection=n.collection||{},n.model=n.model||{};var r=e.Deferred();n.model.application||(n.model.application=new w),n.model.application.get("app")?r.resolve():n.model.application.on("change",r.resolve),n.model.appLocal||(n.model.appLocal=new m,r.done(function(){n.model.application.get("app")!=="system"&&n.model.appLocal.fetch({url:A.fullpath(n.model.appLocal.url+"/"+encodeURIComponent(n.model.application.get("app"))),data:{app:n.model.application.get("app"),owner:n.model.application.get("owner")}})}));var s=e.Deferred();s.resolve(n.model.application.get("owner"));var o=e.Deferred(),u;n.collection.apps?o.resolve():(u=n.collection.apps=new S,e.when(s).done(function(){u.fetch({data:{sort_key:"name",sort_dir:"asc",app:"-",owner:n.model.application.get("owner"),search:"visible=true AND disabled=0 AND name!=launcher",count:-1}}),u.on("reset sort",o.resolve)})),n.model.userPref||(n.model.userPref=new v,n.model.userPref.fetch({data:{app:"user-prefs",owner:n.model.application.get("owner"),count:-1}}),u=n.collection.apps,n.model.userPref.on("change",function(){o.done(function(){u.sortWithString(n.model.userPref.entry.content.get("appOrder")),u.trigger("ready")})})),n.model.user||(n.model.user=new g,e.when(s).done(function(e){n.model.user.set("id",encodeURIComponent(e)),n.model.user.fetch()})),n.collection.messages||(n.collection.messages=new x,n.collection.messages.fetchData.set({sort_key:"timeCreated_epochSecs",sort_dir:"desc"})),n.collection.managers||(n.collection.managers=new T,e.when(s).done(function(e){n.collection.managers.fetch({data:{app:"-",owner:e,count:0,digest:1}})}));var a=n.collection.sections=new N;return a.add({id:"knowledge_configurations",label:t("Knowledge").t(),icon:"bookmark",order:1}),a.add({id:"auth_configurations",label:t("Users and authentication").t(),icon:"user",order:6}),a.add({id:"deployment_configurations",label:t("Distributed environment").t(),icon:"distributed-environment",order:5}),a.add({id:"system_configurations",label:t("System").t(),icon:"settings",order:2}),a.add({id:"data_configurations",label:t("Data").t(),icon:"data",order:4}),n.collection.managers.on("reset",function(){n.collection.managers.each(function(e){var t=e.entry.content.get("menu.url")||"",r=e.entry.content.get("menu.name"),s=L.normalizeBoolean(e.entry.content.get("disabled_by_license")||!1),o=e.entry.content.get("menu.order")||1e3,u=k.encodeRoot(n.model.application.get("root"),n.model.application.get("locale")),f=u+i.sprintf(t,{namespace:n.model.application.get("app")||"NOTHING"});if(!s&&r){var l=a.get(r);if(l){var c=l.get("items");c&&c.push(e)}}e.set({url:f,order:o})}),a.trigger("ready")}),n.model.serverInfo||(n.model.serverInfo=new y,n.model.serverInfo.fetch()),n.model.webConf=new b({id:"settings"}),n.model.webConf.fetch(),new O(n)}});return O}),define("contrib/text!views/shared/appbar/NavItem.html",[],function(){return'<% var hasSubmenu = item.submenu && item.submenu.length && item.submenu.length > 0; %>\n<a href="<%-item.uri%>" title="<%- _(item.label).t() %>" class="<%=hasSubmenu ? \'dropdown-toggle\' : \'\'%>" <%=hasSubmenu ? \'data-toggle="popdown"\' : \'\'%>>\n    <%- _(item.label).t() %>\n    <%if(hasSubmenu){%>\n       <b class="caret"></b>\n    <%}%>\n</a>\n<%if(hasSubmenu){%>\n    <div class="dropdown-menu">\n    	<div class="arrow"></div>\n    	<div class="slideNavPlaceHolder"></div>\n    </div>\n<%}%>\n'}),define("contrib/text!views/shared/AppNav-SlideNavTemplate.html",[],function(){return'<%if(!submenu){return "";}%>\n<ul class="slidenavList scroll-group">\n    <% _.each(submenu, function(i, index) { %>\n    <li data-index="<%=index%>" class="<%=i.divider ? \'divider\':\'\'%>">\n        <% if(!i.divider){ %>\n            <% if(i.submenu && i.submenu.length>0){ %>\n                <a href="#">\n                    <%- _.unescape(_(i.label).t()) %>\n                </a>\n                <i class="icon-triangle-right-small"></i>\n            <%}else if (i.hasOwnProperty(\'reportUri\')) { %>\n                <a href="<%=i.reportUri%>" class="primary-link">\n                    <%- _.unescape(_(i.label).t()) %>\n                </a>\n                <a href="<%=i.uri%>" class="secondary-link">\n                    <i class="icon-<%= i.hasOwnProperty(\'dispatchView\') && i.dispatchView === \'pivot\' ? \'pivot\' : \'search\' %>"></i>\n                </a>\n            <%} else { %>\n                <a href="<%=i.uri%>">\n                    <%- _.unescape(_(i.label).t()) %>\n                </a>\n            <%}%>\n        <%}%>\n    </li>\n    <% }); %>\n</ul>\n'}),define("splunk.widget.slidenav",["jquery","jquery.ui.widget","jquery.ui.position"],function(e){return e.widget("splunk.slidenav",{options:{levelTemplate:"",navData:{},childPropertyName:"children",backText:"Back"},_create:function(){var t=this;this.isAnimating=!1,this.$el=e(this.element),this.$wrap=e('<div class="auto"></div>'),this.$el.append(this.$wrap),this._chain=[this.addLevel(this.options.navData)],this.$backButton=e(t.templateBack()),this.$el.prepend(this.$backButton),this.$backButton.on("click",function(e){t.back(),e.preventDefault()}),this.$el.on("click","LI",function(n){var r=e(n.target).closest("LI");t.select(r,n)})},addLevel:function(t){var n=e(this.options.levelTemplate(t));return this.$wrap.append(n),this._chain&&n.position({of:this._chain[this._chain.length-1],my:"left top",at:"right top",collision:"none",offset:"0 0"}),n.data("slidenav",t),n},select:function(e,t){if(this.isAnimating)return!1;var n=e.closest("ul"),r=n.data("slidenav"),i=e.data("index");e.find("a").addClass("slideNavActiveParent"),e=r[this.options.childPropertyName][i],e[this.options.childPropertyName]&&e[this.options.childPropertyName].length>0?(t&&t.preventDefault(),this.next(e)):this._trigger("select",t,e)},next:function(e){var t=this._chain[this._chain.length-1]||null;e.domReference=e.domReference||this.addLevel(e),this._chain.push(this.slide(e.domReference.show(),function(){t.find("a").prop("tabindex","-1"),e.domReference.find("a").first().focus()})),this.$backButton.show()},back:function(){if(this._chain.length<=1||this.isAnimating)return!1;this._chain.length===2&&this.$backButton.hide();var e=this._chain.pop(),t=this._chain[this._chain.length-1];t.find(".slideNavActiveParent").removeClass("slideNavActiveParent").focus(),this.slide(t,function(){e.scrollTop(0).hide(),t.find("a").prop("tabindex","0")})},slide:function(e,t){var n=this;return this.$wrap.outerHeight(e.outerHeight()),this.isAnimating=!0,this.$wrap.animate({left:-e.position().left},{duration:200,complete:function(){n.isAnimating=!1,t&&t.apply(n,arguments)}}),e},templateBack:function(){return this.options.templateBack||'<div class="backbutton" style="display: none;"><a href="#" class="slidenavback "><i class="icon-chevron-left"></i>'+this.options.backText+"</a></div>"}})}),define("views/shared/appbar/NavItem",["jquery","underscore","module","views/Base","views/shared/delegates/Popdown","contrib/text!views/shared/appbar/NavItem.html","contrib/text!views/shared/AppNav-SlideNavTemplate.html","views/shared/delegates/StopScrollPropagation","splunk.widget.slidenav"],function(e,t,n,r,i,s,o,u){var a=t.template(o),f=r.extend({moduleId:n.id,className:"nav-item",tagName:"li",initialize:function(){r.prototype.initialize.apply(this,arguments)},render:function(){var e;return this.options.navItemObj.divider?e=t.template(this.dividerTemplate,{}):e=t.template(s,{item:this.options.navItemObj,isActive:this.options.isActive}),this.$el.append(e),this.$el.addClass("nav-item-"+this.options.navItemObj.viewName),this.options.navItemObj.submenu&&this.options.navItemObj.submenu.length>0&&(this.$el.addClass("dropdown"),this.slideNav=this.$el.find(".slideNavPlaceHolder").slidenav({navData:this.options.navItemObj,levelTemplate:a,childPropertyName:"submenu",backText:t("Back").t()}),this.popdown=new i({el:this.$el,dialog:this.slidenav,mode:"dialog"}),this.children.stopScrollPropagation=new u({el:this.slideNav.find(".slidenavList")})),this},dividerTemplate:'<span class="divider" style="display: block;float: left;height: 10px;margin: 0 15px;opacity: 0.2;"></span>'});return f}),define("views/shared/appbar/AppNav",["jquery","underscore","backbone","module","views/Base","views/shared/appbar/NavItem"],function(e,t,n,r,i,s){return i.extend({moduleId:r.id,tagName:"ul",className:"nav nav-pills",initialize:function(){i.prototype.initialize.apply(this,arguments),this.listenTo(this.model.appNav,"change:nav",this.debouncedRender),this.listenTo(this.model.application,"change:page",this.setActiveItem)},render:function(){var t=this,n=this.model.appNav.get("nav");return n?(this.$el.html(""),e.each(n,function(e,n){var r=new s({navItemObj:n});t.$el.append(r.render().$el)}),this.setActiveItem.call(this),this):this},setActiveItem:function(){var e=this;if(this.model.application.get("page")){var t=this.model.application.get("page"),n=e.$el.find(".nav-item-"+t);n.addClass("active")}}})}),define("contrib/text!views/shared/appbar/AppLabel.html",[],function(){return'<a class="app-link" href="<%=appLink%>">\n    <div class="app-logo"></div>\n\n    <div class="app-name">\n        <span class="app-label">\n            <%-_(appLabel).t()%>\n        </span>\n    </div>\n</a>\n'}),define("views/shared/appbar/AppLabel",["underscore","module","views/Base","contrib/text!views/shared/appbar/AppLabel.html"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"app-bar-label-wrapper",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.appNav.on("change",this.render,this)},showLogo:function(){this.$el.find(".app-logo").show(),this.$el.find(".app-name").hide()},showName:function(){this.$el.find(".app-name").show(),this.$el.find(".app-logo").hide()},render:function(){var t=this.model.appNav.get("label")||"",n=e.template(r,{appLink:this.model.appNav.get("link"),appLabel:t,appIcon:this.model.appNav.get("icon"),appLogo:this.model.appNav.get("logo")});return this.$el.html(n),this.setAppLabelDisplay(),this},setAppLabelDisplay:function(){if(this.model.appNav.get("logo")){var e=new Image;e.onload=function(){parseInt(e.width,10)<2?this.showName():(this.$el.find(".app-logo").empty().append(e),this.showLogo())}.bind(this),e.onerror=function(){this.showName()}.bind(this),e.src=this.model.appNav.get("logo")}}})}),define("contrib/text!views/shared/appbar/Master.html",[],function(){return'<h2 class="app-name pull-right"></h2>\n<div class="nav">\n</div>\n'}),define("helpers/AppNav",["jquery","underscore","backbone","splunk.util"],function(e,t,n,r){function c(e,t,n){return e.filter(function(e){var r=e.entry.acl.get("app"),s=e.entry.get("name"),o=e.entry.acl.get("sharing")==="global";return!o&&r!==i?!1:t?s.toLowerCase().indexOf(t.toLowerCase())>-1&&!(n&&n.indexOf(i+"/"+s)>-1):!(n&&n.indexOf(i+"/"+s)>-1)})}function h(e){var t,n,o,u;s=s||[];for(o=0;o<s.length;o++){u=s.at(o);if(u.entry.get("name").toLowerCase()===e.toLowerCase()){if(u.entry.acl.get("app")==i){n=u;break}u.entry.acl.get("sharing")=="global"&&(n=u)}}return n?n.entry.content.get("isVisible")?(t={label:n.entry.content.get("label")||e,uri:r.make_url("app",i,e),viewName:e,app:i},t):!1:!1}function p(e){var t,n=u.find(function(t){return t.entry.get("name").toLowerCase()===e.toLowerCase()});return n?(t={uri:r.make_full_url("app/"+encodeURIComponent(i)+"/@go",{s:n.id}),sharing:n.get("sharing"),label:e,reportUri:r.make_full_url("app/"+encodeURIComponent(i)+"/report",{s:n.id})},n.entry.content.get("request.ui_dispatch_view")&&(t.dispatchView=n.entry.content.get("request.ui_dispatch_view")),t):!1}function d(t){if(typeof t!="string")return!1;var n=e("<div></div>").html(t).text();n=window.decodeURI(n),n=n.replace(/(\r\n|\n|\r|\s)/gm,"").toLowerCase();if(n.indexOf(":")>-1&&n.indexOf("javascript:")>-1||n.indexOf("vbscript:")>-1||n.indexOf("data:")>-1||n.indexOf("livescript:")>-1)t=!1;return t}function v(n){var o=[],a;for(a=0;a<n.length;a++){var m=n[a],g=e(m),y=r.lowerTrimStr(m.nodeName),b;if(y==="collection"){b={label:g.attr("label"),uri:"#"};var w=v(g.children());if(!w.submenu.length||!t.find(w.submenu,function(e){return!e.divider}))continue;t.extend(b,w)}else if(y==="view"){var E=g.attr("name"),S=r.normalizeBoolean(g.attr("default")||"false"),x=r.lowerTrimStr(g.attr("source")),T=g.attr("match");if(E){b=h(E);if(!b)continue;S&&(b.isDefault=S),f.push(i+"/"+E)}else if(x){var N=[],C;x=="all"?N=c(s,T):x=="unclassified"&&(N=c(s,T,f));for(C=0;C<N.length;C++){E=N[C].entry.get("name"),b=h(E);if(!b)continue;if(!N[C].entry.content.get("isDashboard"))continue;f.push(i+"/"+E),o.push(b)}b=!1}}else if(y==="saved"){var k=g.attr("name");x=r.lowerTrimStr(g.attr("source")),T=g.attr("match");if(k){b=p(k);if(!b)continue;l.push(i+"/"+k)}else if(x){var L=[];x=="all"?L=c(u,T):x=="unclassified"&&(L=c(u,T,l));for(C=0;C<L.length;C++){k=L[C].entry.get("name"),b=p(k);if(!b)continue;l.push(i+"/"+k),o.push(b)}b=!1}}else if(y==="a"){var A=d(g.attr("href"));A===!1?b=!1:(A.indexOf("/")===0&&A[1]!=="/"&&(A=r.make_url(A)),b={label:g.text(),uri:A,viewName:g.attr("name")||""})}else y==="divider"?b={label:"",divider:!0}:b={label:"unknown node in nav"};b&&o.push(b)}return{submenu:o}}function m(t,r,a,c){var h=t.entry.content.get("eai:data").replace(/\&/g,"&amp;"),p=e(e.parseXML(h)),d=p.find("nav"),m=d.attr("search_view"),g=d.attr("color");return f=l=[],i=t.entry.content.get("eai:appName"),s=r,o=c||"",u=new n.Collection(a.filter(function(e){var t=e.entry.acl.get("app")==i,n=e.entry.acl.get("sharing")=="global";return t||n})),{nav:v(d.children()).submenu,searchView:m,color:g}}function g(e,t,n,r){var i=[];return o=r||"",f=l=[],!e||e.length==0?null:(e.each(function(e){i.push(m(e,t,n))}),i)}var i,s,o,u,a,f=[],l=[];return{parseNavModel:m,parseNavCollection:g}}),define("util/color_utils",["underscore"],function(e){var t=function(e){var t=e[0],n=e[1],r=e[2],i=0,s=0,o=0;if(t===null||n===null||r===null||isNaN(t)||isNaN(n)||isNaN(r))return null;if(t<0||n<0||r<0||t>255||n>255||r>255)return null;t/=255,n/=255,r/=255;var u=Math.min(t,Math.min(n,r)),a=Math.max(t,Math.max(n,r)),f=a-u,l=0;f==0?l=0:a==t?l=(n-r)/f%6:a==n?l=(r-t)/f+2:a==r&&(l=(t-n)/f+4);var c=l*60;while(c<0)c+=360;while(c>360)c-=360;var h=.5*(a+u),p=0;return f==0?p=0:p=f/(1-Math.abs(2*h-1)),p<0&&(p=0),p>1&&(p=1),h<0&&(h=0),h>1&&(h=1),[c,p*100,h*100]},n=function(e){if(e.length!=3)return null;var t=e[0],n=e[1],r=e[2];n/=100,r/=100;while(t<0)t+=360;while(t>360)t-=360;if(t<0||t>360||n<0||n>1||r<0||r>1)return null;var i=(1-Math.abs(2*r-1))*n,s=t/60,o=i*(1-Math.abs(s%2-1)),u=0,a=0,f=0;s<1?(u=i,a=o):s<2?(u=o,a=i):s<3?(a=i,f=o):s<4?(a=o,f=i):s<5?(u=o,f=i):(u=i,f=o);var l=r-.5*i,c=u+l,h=a+l,p=f+l;return c*=255,h*=255,p*=255,[c,h,p]},r=function(e){var t=e.match(/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);if(t===null)return null;var n=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)];return n},i=function(t){if(t.length!=3)return null;var n=e.map(t,Math.round),r="rgb("+n[0]+", "+n[1]+", "+n[2]+")";return r},s=function(t){if(t.length!=3)return null;var n=e.map(t,Math.round),r="hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";return r},o=function(e){var t=e.match(/^hsl\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)$/);if(t===null)return null;var n=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)];return n},u=function(e){var t=f(e),n=t.match(/^#?([\dA-Fa-f]{2})([\dA-Fa-f]{2})([\dA-Fa-f]{2})$/);if(n===null)return null;var r=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)];return r},a=function(t){if(t.length!=3)return null;var n=e.map(t,Math.round),r=e.map(n,function(e){var t=e.toString(16);return t.length<2&&(t="0"+t),t.toUpperCase()}),i="#"+r[0]+r[1]+r[2];return i},f=function(e){var t="#"+e.replace("#","");t=t.toUpperCase();var n=t.match(/^#?([\dA-F])([\dA-F])([\dA-F])$/);return n!==null&&(t="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),t},l=function(e,t){var n=e.slice(0);return n[2]*=t,n[2]>100?n[2]=100:n[2]<0&&(n[2]=100),n},c=function(e,r){var i=t(e),s=l(i,r),o=n(s);return o},h=function(e,t){var n=u(e),r=c(n,t),i=a(r);return i},p=function(e,t,n,r){var i=[" -webkit-gradient(linear, 0 0, 0 100%, from(@startColor), color-stop(@colorStop, @midColor), to(@endColor)) "," -webkit-linear-gradient(@startColor, @midColor @colorStop, @endColor) "," -moz-linear-gradient(top, @startColor, @midColor @colorStop, @endColor) "," -o-linear-gradient(@startColor, @midColor @colorStop, @endColor) "," linear-gradient(@startColor, @midColor @colorStop, @endColor) "," progid:DXImageTransform.Microsoft.gradient(startColorstr='@startColor', endColorstr='@endColor', GradientType=0) "];for(var s=0;s<i.length;s++)i[s]=i[s].replace(/@startColor/g,e),i[s]=i[s].replace(/@midColor/g,t),i[s]=i[s].replace(/@colorStop/g,n),i[s]=i[s].replace(/@endColor/g,r);return i},d=function(e,t){var n=[" -moz-linear-gradient(top, @startColor, @endColor) "," -webkit-gradient(linear, 0 0, 0 100%, from(@startColor), to(@endColor))"," -webkit-linear-gradient(top, @startColor, @endColor) "," -o-linear-gradient(top, @startColor, @endColor) "," linear-gradient(to bottom, @startColor, @endColor) "," progid:DXImageTransform.Microsoft.gradient(startColorstr='@startColor', endColorstr='@endColor', GradientType=0)  "];for(var r=0;r<n.length;r++)n[r]=n[r].replace(/@startColor/g,e),n[r]=n[r].replace(/@endColor/g,t);return n};return{hslColorFromRgbColor:t,rgbColorFromHslColor:n,hslColorFromHslString:o,rgbColorFromRgbString:r,hslStringFromHslColor:s,rgbStringFromRgbColor:i,rgbColorFromHexString:u,hexStringFromRgbColor:a,normalizeHexString:f,modifyLuminosityOfHslColor:l,modifyLuminosityOfRgbColor:c,modifyLuminosityOfHexString:h,generateGradientStylesWithMidColor:p,generateGradientStyles:d}}),define("views/shared/appbar/Master",["jquery","underscore","backbone","module","views/Base","views/shared/appbar/NavItem","views/shared/appbar/AppNav","views/shared/appbar/AppLabel","models/shared/Application","models/services/data/ui/Nav","models/services/AppLocal","collections/services/data/ui/Views","collections/services/SavedSearches","contrib/text!views/shared/appbar/Master.html","helpers/AppNav","uri/route","util/color_utils","util/console"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=i.extend({moduleId:r.id,className:"app-bar",initialize:function(e){i.prototype.initialize.apply(this,arguments),this.children.appNav=new o({model:this.model,collection:this.collection}),this.children.appLabel=new u({model:this.model,collection:this.collection}),this.setBannerColor(),this.model.appNav.on("change:color",this.setBannerColor,this),e.autoRender!==!1&&this.debouncedRender()},render:function(){var e=t.template(p);return this.$el.html(e),this.$el.find(".nav").html(this.children.appNav.render().el),this.$el.find(".app-name").html(this.children.appLabel.render().el),this},setBannerColor:function(){if(!this.model.appNav)return!1;var e=m.normalizeHexString(this.model.appNav.get("color")||""),t=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e);if(!t)return!1;this.$el.css("background-color",e)}},{END_GRADIENT_LUMINOSITY:.9,createWithAppNavUrl:function(t){var n=this,r=t.model.application.get("app"),i=t.model.application.get("owner"),s=new e.Deferred;r&&i?s.resolve(r,i):t.model.application.once("change",function(){var e=t.model.application.get("app"),n=t.model.application.get("owner");e&&n&&s.resolve(e,n)}),s.done(function(){var r=v.appNavUrl(t.model.application.get("root"),t.model.application.get("locale"),t.model.application.get("app"));e.ajax({url:r,dataType:"json"}).done(function(e){n._applyAppNavData(e,t.model.appNav,t,!1)}).fail(function(){n.createWithBackbone(t)})})},createWithAppNavModel:function(e){var t=e.model.appNav;this._applyAppNavData(t.entry.content.toJSON(),t,e,!1)},createWithBackbone:function(t){function u(){var e=d.parseNavModel(t.model.splunkDappNav,t.collection.views,t.collection.savedSearches,t.model.application.get("root")),r;e.appLabel?r=e.appLabel:t.model.app&&t.model.app.entry&&t.model.app.entry.content&&t.model.app.entry.content.get("label")&&(r=t.model.app.entry.content.get("label")||""),n._applyAppNavData({nav:e.nav,color:e.color,label:r,defaultView:e.defaultView,searchView:e.searchView},t.model.appNav,t,!1)}var n=this,r=e.Deferred(),i=e.Deferred(),s=e.Deferred(),o=e.Deferred(),a=t.model.application.get("app"),p=t.model.application.get("owner");a&&p?r.resolve(a,p):t.model.application.once("change",function(){var e=t.model.application.get("app"),n=t.model.application.get("owner");e&&n&&r.resolve(e,n)}),t.model.app||(t.model.app=new l,r.done(function(e,n){t.model.app.set({id:"apps/local/"+e}),t.model.app.fetch({data:{app:e,owner:n}})})),t.collection.views||(t.collection.views=new c,r.done(function(e,n){t.collection.views.fetch({data:{app:e,owner:n,count:-1,digest:1}})})),t.collection.savedSearches||(t.collection.savedSearches=new h,r.done(function(e,n){t.collection.savedSearches.fetch({data:{app:e,owner:"-",search:"is_visible=1 AND disabled=0",count:-1}})})),t.model.splunkDappNav||(t.model.splunkDappNav=new f,r.done(function(e,n){t.model.splunkDappNav.fetch({data:{app:e,owner:n}})})),t.collection.views.once("reset",s.resolve),t.collection.savedSearches.once("reset",o.resolve),t.model.splunkDappNav.once("change",i.resolve),e.when(s,o,i).then(u)},_applyAppNavData:function(e,t,n,r){var i=n.model.application,s=v.page(i.get("root"),i.get("locale")||"",i.get("app")),o=v.appIcon(i.get("root"),i.get("locale")||"",i.get("owner"),i.get("app")),u=v.appLogo(i.get("root"),i.get("locale")||"",i.get("owner"),i.get("app"));g.DEBUG_ENABLED&&(this._lastApply?g.log("Applying app nav data %o after %o ms",e,(new Date).getTime()-this._lastApply):(this._lastApply=(new Date).getTime(),g.log("Applying app nav data: %o",e))),t.set({nav:e.nav,color:e.color,label:e.label,icon:o,logo:u,link:s,defaultView:e.defaultView,searchView:e.searchView}),r||this._cacheValue(e,n)},_supportsSessionStorage:function(){return"sessionStorage"in window&&window.sessionStorage},_cachePrefix:"splunk-appnav",_cacheKey:function(e){return[this._cachePrefix,e.get("app"),e.get("owner"),e.get("locale")].join(":")},_cacheValue:function(e,n){if(this._supportsSessionStorage()){e=t(e).pick("nav","color","label","defaultView","searchView"),g.log("Caching app nav data: %o",e);try{window.sessionStorage.setItem(this._cacheKey(n.model.application),JSON.stringify(e))}catch(r){g.warn("Update to store app nav data in sessionStorage: ",r)}}},_createFromCache:function(e){if(this._supportsSessionStorage())try{var r=this._cacheKey(e.model.application),i=JSON.parse(window.sessionStorage.getItem(r));if(i){g.log("Applying cached app nav data: %o",i);var s=new n.Model;this._applyAppNavData(i,s,e,!0),e.model.appNav=s,t.delay(t.bind(this._loadDefault,this,e),1e3);return}}catch(o){g.warn("Unable load cached app nav data: ",o)}this._createDefault(e)},_loadDefault:function(e){e.appServerUrl?this.createWithAppNavUrl(e):this.createWithBackbone(e)},_createDefault:function(e){e.model.appNav?this.createWithAppNavModel(e):(e.model.appNav=new n.Model,this._loadDefault(e))},create:function(e){return e=e||{},e.collection=e.collection||{},e.model=e.model||{},e.useSessionStorageCache===!0?this._createFromCache(e):this._createDefault(e),new y(e)}});return y}),define("models/config",["jquery","splunk.config","models/Base"],function(e,t,n){var r=n.extend({id:"config",initialize:function(){n.prototype.initialize.apply(this,arguments)},sync:function(e,t,n){throw new Error("invalid method: "+e)}});return new r(e.extend(!0,{},t))}),define("splunkjs/mvc/headerview",["require","exports","module","./mvc","./basesplunkview","views/shared/splunkbar/Master","views/shared/appbar/Master","./sharedmodels","helpers/user_agent","models/config"],function(e,t,n){var r=e("./mvc"),i=e("./basesplunkview"),s=e("views/shared/splunkbar/Master"),o=e("views/shared/appbar/Master"),u=e("./sharedmodels"),a=e("helpers/user_agent"),f=e("models/config"),l=i.extend({moduleId:n.id,className:"splunk-header",options:{appbar:!0,acceleratedAppNav:!1,useSessionStorageCache:!1},initialize:function(){this.configure(),this.model=this.model||{},this.model.application=u.get("app"),this.model.user=u.get("user"),this.model.appLocal=u.get("appLocal"),this.model.serverInfo=u.get("serverInfo");var e=this.settings.get("acceleratedAppNav")&&a.isIE7();this.collection=this.collection||{},this.collection.appLocals=u.get("appLocals"),this.globalNav=s.create({model:{application:this.model.application,appLocal:this.model.appLocal,user:this.model.user,serverInfo:this.model.serverInfo,config:f},collection:{apps:this.collection.appLocals}}),this.settings.get("appbar")&&(this.appNav=o.create({model:{application:this.model.application,app:this.model.appLocal},appServerUrl:e,useSessionStorageCache:this.settings.get("useSessionStorageCache"),autoRender:!1}))},render:function(){return this.$el.empty().append(this.globalNav.render().el),this.settings.get("appbar")&&this.$el.append(this.appNav.render().el),this}});return l});
