define("collections/search/Reports",["models/search/Report","collections/services/SavedSearches"],function(e,t){return t.extend({model:e,initialize:function(){t.prototype.initialize.apply(this,arguments)}},{ALERT_SEARCH_STRING:'(is_scheduled=1 AND (alert_type!=always OR alert.track=1 OR (dispatch.earliest_time="rt*" AND dispatch.latest_time="rt*" AND actions="*" )))'})}),define("util/xml",["jquery","underscore"],function(e,t){function n(t){var n=e.parseXML(t);return e(n.childNodes[0])}function r(e){return n(l(e))}function i(t){var n=e.parseXML("<x></x>");return n.createCDATASection(t)}function s(t,n){var r=t.TEXT_NODE||3,i,o,u=t.childNodes;for(i=u.length-1;i>=0;i--)o=u[i],o!==undefined&&o.nodeType===r&&(/^\s*$/.test(o.nodeValue)?t.removeChild(o):o.nodeValue=e.trim(o.nodeValue));u=t.childNodes;for(i=u.length-1;i>=0;i--)o=u[i],(o.nodeType===t.ELEMENT_NODE||o.nodeType===t.DOCUMENT_NODE)&&(n==null||!n[o.nodeName])&&s(o,n)}function u(e){var t=["\n"],n=e;while(n--)t.push(o);return t.join("")}function a(e,n,r){if(!n||!n.childNodes)return;var i=n.TEXT_NODE||3;for(var s=0;s<=n.childNodes.length;s++){var o=n.childNodes[s-1],f=n.childNodes[s];f&&f.nodeType!==i&&(!o||o.nodeType!==i)&&n.insertBefore(e.createTextNode(u(r)),f),s===n.childNodes.length&&o&&o.nodeType!==i&&n.appendChild(e.createTextNode(u(r-1)))}t.chain(n.childNodes).filter(function(e){return e.nodeType===n.ELEMENT_NODE}).each(function(t){a(e,t,r+1)})}function f(e,n){return s(e[0],t.object(n,n)),a(e[0],e[0].childNodes[0],1),e}function l(t){return t instanceof e&&(t=t[0]),Object.prototype.hasOwnProperty.call(t,"xml")?t.xml:(new XMLSerializer).serializeToString(t)}function c(n){var r=n.node,i=n.where,s=n.container,o=n.selectors||[],u=n.fallback,a=e(s);for(var f=0;f<o.length;f++){var l=o[f],c=a.children(l);if(c.length)return c[i](r),!0}return t.isString(u)?(a[u](r),!0):t.isFunction(u)?(u(a,r),!0):!1}function h(e){d(e.node,e.selector,e.container,"append")}function p(e){d(e.node,e.selector,e.container,"prepend")}function d(n,r,i,s){var o=e(i),u=o.children(r);u.length?(e(t.rest(u)).remove(),e(u.first()).replaceWith(n)):o[s](n)}var o="  ";return{$node:n,cdata:i,stripEmptyTextNodes:s,formatXMLDocument:f,serialize:l,clone:r,inject:c,replaceOrAppend:h,replaceOrPrepend:p}}),define("models/search/Dashboard",["jquery","underscore","splunk.util","models/services/data/ui/View","util/xml","models/Base"],function(e,t,n,r,i,s){var o="html",u="chart",a="event",f="single",l="map",c="table",h=[u,a,f,l,c],p=s.extend({constructor:function(e){this._dash=e,s.prototype.constructor.call(this)},apply:function(){this._dash._applyMetadata(this.toJSON())},save:function(){return arguments.length&&this.set.apply(this,arguments),this._dash._applyMetadata(this.toJSON()),this._dash.save.apply(this._dash,arguments)},fetch:function(){var t=this._dash._extractMetadata();this.set(t);var n=e.Deferred();return n.resolve(this),n}}),d=r.extend({initialize:function(e,t){r.prototype.initialize.apply(this,arguments),this.indent=(t||{}).indent!==!1},initializeAssociated:function(){r.prototype.initializeAssociated.apply(this,arguments);var e=this.meta=this.meta||new p(this);this.entry.content.on("change:eai:data",function(){e.fetch()},this),e.fetch()},associatedOff:function(e,t,n){r.prototype.associatedOff.apply(this,arguments),this.meta.off(e,t,n)},set$XML:function(e){var t=i.serialize(this.indent?this.formatXML(e):e);this.setXML(t)},formatXML:function(e){return i.formatXMLDocument(e,["delimiter","html"])},setXML:function(e){this.entry.content.set("eai:data",e),this.entry.content.set("eai:type","views")},setHTML:function(e){this.entry.content.set("eai:data",e),this.entry.content.set("eai:type","html")},_extractMetadata:function(){var e=this.isXML(),t=e?this.get$XML():null;return{label:this.entry.content.get("label")||this.entry.get("name"),description:e&&t.find(":eq(0) > description").text()||""}},_applyMetadata:function(e){var t=this.get$XML(),n=t.find(":eq(0) > label"),r=t.find(":eq(0) > description"),s=e.label,o=e.description;s!==undefined&&s!==null&&(n.length||(n=i.$node("<label/>"),t.find(":eq(0)").prepend(n)),n.text(s),this.entry.content.set("label",s)),o!==undefined&&o!==null&&(o!==undefined&&o!==""||!r.length?r.length||(r=i.$node("<description/>"),n.length?r.insertAfter(n):t.find(":eq(0)").prepend(r)):r.remove(),r.text(o)),this.set$XML(t)},getLabel:function(){var e=this.meta.get("label");return e===undefined?"":e},setLabel:function(e){this.setLabelAndDescription(e,undefined)},getDescription:function(){return this.meta.get("description")},setDescription:function(e){this.setLabelAndDescription(undefined,e)},setLabelAndDescription:function(e,t){this._applyMetadata({label:e,description:t})},get$Rows:function(){var e=this.get$XML();return e.find(":eq(0) > row")},appendNewPanel:function(n,r){var s=t.indexOf(h,n)!=-1,u=n===o,a,f;if(s||u){s?a=t.template(this.nonHTMLPanelTemplate,{panelType:n,properties:r}):a=t.template(this.HTMLPanelTemplate,{properties:r}),f=this.get$XML();var l=i.$node("<row/>"),c=i.$node("<panel/>").appendTo(l);e(c).append(i.$node(a)),f.find(":eq(0)").append(l),this.set$XML(f)}},nonHTMLPanelTemplate:'                <<%- panelType %>>                    <% if (properties.title) { %>                        <title><%- properties.title %></title>                    <% } %>                    <% if (properties.searchString) { %>                        <searchString><%- properties.searchString %></searchString>                        <% if (properties.earliestTime !== undefined) { %>                            <earliestTime><%- properties.earliestTime %></earliestTime>                        <% } %>                        <% if (properties.latestTime !== undefined) { %>                            <latestTime><%- properties.latestTime %></latestTime>                        <% } %>                    <% } else if (properties.pivotSearch) { %>                        <pivotSearch>                            <model><%= properties.pivotSearch.model %></model>                            <object><%= properties.pivotSearch.object %></object>                            <filters><%= properties.pivotSearch.filters %></filters>                            <cells><%= properties.pivotSearch.cells %></cells>                            <rows><%= properties.pivotSearch.rows %></rows>                            <columns><%= properties.pivotSearch.columns %></columns>                        </pivotSearch>                    <% } else if (properties.searchName) { %>                        <searchName><%- properties.searchName %></searchName>                    <% } %>                    <% if (properties.fields) { %>                        <fields><%- properties.fields %></fields>                    <% } %>                    <% _.each(properties.options, function(value, key) { %>                        <option name="<%- key %>"><%- value %></option>                    <% }) %>                </<%- panelType %>>            ',HTMLPanelTemplate:"<html><%= properties.html %></html>"},{panelXMLToPanelTypeAndProperties:function(t){var n={},r=e(t),s;return t.nodeName===o?(s=i.serialize(t),{panelType:t.nodeName,properties:{html:e.trim(s.replace(/^\s*<html>|<\/html>\s*$/g,""))}}):(r.children().each(function(t,r){var i=e(r);r.nodeName!=="option"?n[r.nodeName]=i.text():(n.options=n.options||{},n.options[i.attr("name")]=i.text())}),{panelType:t.nodeName,properties:n})},reportToPropertiesFromPanelType:function(e,n,r){var i=t.indexOf(h,e)!=-1,s={},o,a,c,p;if(!i)throw"Unsupported panel type";return!n.isNew()&&!r?s.searchName=n.entry.get("name"):(s.searchString=n.entry.content.get("search"),c=n.entry.content.get("dispatch.earliest_time"),c!==undefined&&(s.earliestTime=c),p=n.entry.content.get("dispatch.latest_time"),p!==undefined&&(s.latestTime=p)),e===u?s.options=n.entry.content.filterByWildcards(["^display.visualizations.charting..*"],{strip:"display.visualizations."}):e===f?s.options=n.entry.content.filterByWildcards(["^display.visualizations.singlevalue..*"],{strip:"display.visualizations.singlevalue."}):e===l&&(s.options=n.entry.content.filterByWildcards(["^display.visualizations.mapping..*"],{strip:"display.visualizations."}),delete s.options["mapping.data.bounds"]),s}});d.Entry=d.Entry.extend({});var v=d.Entry.Content;return d.Entry.Content=v.extend({initialize:function(){v.prototype.initialize.apply(this,arguments)},validate:function(t){var n=t["eai:data"],r,i;if(n!=void 0){r=e.parseXML(n),i=r.firstChild;if(i.nodeName!=="dashboard"&&i.nodeName!=="form")return{"eai:data":"You must declare a dashboard node."}}}}),d}),define("splunkjs/mvc/simplexml/dashboardmodel",["require","underscore","jquery","../../mvc","models/search/Dashboard","util/xml","util/general_utils","util/console"],function(e){var t=e("underscore"),n=e("jquery"),r=e("../../mvc"),i=e("models/search/Dashboard"),s=e("util/xml"),o=e("util/general_utils"),u=e("util/console"),a=i.extend({initialize:function(){i.prototype.initialize.apply(this,arguments)},getFlattenedXML:function(e){if(!this._structure)throw new Error("Cannot create flattened XML without the item order being captured first");var n=s.$node,i=this;e=e||{};var o=n("<dashboard/>");return n("<label/>").text(this.meta.get("label")).appendTo(o),this.meta.has("description")&&n("<description/>").text(this.meta.get("description")).appendTo(o),t(this._structure.rows).each(function(u){var a=n("<row/>");if(t(u).any(function(e){return e.elements.length>1})){var f=t(u).map(function(e){return e.elements.length}).join(",");a.attr("grouping",f)}t(u).chain().flatten().pluck("elements").flatten().each(function(n){var o=r.Components.get(n),u=o.model.mapToXML(t.extend({tokens:!1,flatten:!0},e)),f=s.$node("<"+u.type+"/>");u.attributes!==undefined&&f.attr(u.attributes);if(u.content)u.cdata?f.append(s.cdata(u.content)):f.text(u.content);else{i._applyTitle(f,u);var l=r.Components.get(o.model.entry.content.get("display.general.manager"));e.useLoadjob!==!1&&l&&l.job?i._applySearch(f,{search:{type:"inline",search:"| loadjob "+l.job.sid+" ignore_running=t"}}):i._applySearch(f,u),i._applyOptions(f,u),i._applyTags(f,u)}f.appendTo(a)}),a.appendTo(o)}),e&&e.indent&&this.formatXML(o),s.serialize(o)},updateElement:function(e,r,i){u.log("About to update item=%o with settings=%o",e,r);var o=this.get$XML(),a=this.getXMLNode(e,o);if(!a)throw new Error("Unable to find dashboard element with ID "+e);var f=s.$node("<"+r.type+"/>");return t(["id","depends","rejects"]).each(function(e){var t=n(a).attr(e);t&&f.attr(e,t)}),f.append(n(a).children()),i&&i.clearOptions&&(f.find("option").remove(),delete r.options),this._applyTitle(f,r),r.search&&r.search.type==="global"?this._applyGlobalSearch(o,r):this._applySearch(f,r),this._applyOptions(f,r),this._applyTags(f,r),n(a).replaceWith(f),u.DEBUG_ENABLED&&(this.formatXML(o),u.log(s.serialize(o))),this.set$XML(o),this.save()},deleteElement:function(e){var n={fieldset:this._structure.fieldset,rows:t(this._structure.rows).map(function(n){return t(n).map(function(n){return{inputs:n.inputs,elements:t(n.elements).without(e)}})})};return this.updateStructure(n)},addElement:function(e,t){var n=s.$node("<row/>"),r=s.$node("<panel/>").appendTo(n),i=s.$node("<"+t.type+"/>").appendTo(r);this._structure.rows.push([{inputs:[],elements:[t.id]}]),this._applyTitle(i,t),this._applySearch(i,t);var o=this.get$XML();return o.find(":eq(0)").append(n),u.DEBUG_ENABLED&&(this.formatXML(o),u.log(s.serialize(o))),this.set$XML(o),this.save()},_migrateViewType:function(e,r){var i=e.find(":eq(0)");if(i.prop("tagName")!==r){e=n(n.parseXML("<"+r+"/>"));var s=e.find(":eq(0)"),o=i[0];t(o.attributes).each(function(e){s.attr(e.nodeName,e.nodeValue)});while(o.childNodes.length)s.append(o.childNodes[0]);this.trigger("change:rootNodeName",this,r)}return e},_applyOptions:function(e,n){n.options&&t.each(n.options,function(t,n){var r=e.find('option[name="'+n+'"]');t===""||t===null||t===void 0?r.remove():r.length?r.text(t):s.$node("<option/>").attr("name",n).text(t).appendTo(e)}),n.removeOptions&&t(n.removeOptions).each(function(t){e.find('option[name="'+t+'"]').remove()})},_applyTags:function(e,n){n.tags&&t.each(n.tags,function(n,r){e.find(r).remove(),(t.isArray(n)&&n.length||n)&&s.$node("<"+r+"/>").text(n).appendTo(e)})},_applyTitle:function(e,t){var n=e.find("title");t.title?(n.length||(n=s.$node("<title/>").prependTo(e)),n.text(t.title)):n.remove()},_applySearch:function(e,t){if(t.search){e.find("searchString,searchTemplate,searchName,searchPostProcess,pivotSearch,earliestTime,latestTime").remove();var n=e.find("title");switch(t.search.type){case"inline":case"global":var r=s.$node("<searchString/>").text(t.search.search);n.length?r.insertAfter(n):r.prependTo(e),t.search.latest_time!==undefined&&s.$node("<latestTime/>").text(t.search.latest_time).insertAfter(r),t.search.earliest_time!==undefined&&s.$node("<earliestTime/>").text(t.search.earliest_time).insertAfter(r);break;case"postprocess":var i=s.$node("<searchPostProcess/>").text(t.search.search);n.length?i.insertAfter(n):i.prependTo(e);break;case"saved":var o=s.$node("<searchName/>").text(t.search.name);n.length?o.insertAfter(n):o.prependTo(e);break;case"pivot":throw new Error("Pivot search not implemented!");default:throw new Error("Unknown search type: "+t.search.type)}}},_applyGlobalSearch:function(e,t){var n=e.find(":eq(0)");n.children("searchTemplate,earliestTime,latestTime").remove();var r=n.children("label"),i=n.children("description"),o=s.$node("<searchTemplate/>").text(t.search.search);i.length?o.insertAfter(i):r.length?o.insertAfter(r):o.prependTo(n),t.search.latest_time&&s.$node("<latestTime/>").text(t.search.latest_time).insertAfter(o),t.search.earliest_time&&s.$node("<earliestTime/>").text(t.search.earliest_time).insertAfter(o)},captureDashboardStructure:function(e){var t=this.get$XML();this.validateItemOrder(this._getItemOrderMap(e.rows,t)),this.validateInputOrder(this._getInputOrderMap(e,t)),this._structure=e},getStructureMap:function(e,n){return t.extend({},this._getItemOrderMap(e.rows,n),this._getInputOrderMap(e,n))},getXMLNode:function(e,t){e=String(e);var n=t.find(":eq(0)>fieldset>#"+e+",:eq(0)>row>#"+e+",:eq(0)>row>panel>#"+e);return n.length?n[0]:this.getStructureMap(this._structure,t)[e]},_getItemOrderMap:function(e,r){var i=t(r.find("row").children()).map(function(e){return n(e).is("panel")?n(e).children(":not(input)").toArray():e}),s=function(e,n,r){if(e.length!==n.length)throw new Error("Item order did not match XML structure ("+e.length+" keys, "+n.length+" nodes)");return t.object(e,n)};return s(t(e).chain().flatten().pluck("elements").flatten().value(),t.flatten(i))},validateItemOrder:function(e){t(e).each(function(e,t){var r=n(e).attr(t);if(r!==undefined&&r!==t)throw new Error("Invalid Item order. Expected node with ID "+t+". Instead saw "+r)})},inputSettingsToXML:function(e,r){var i=r?n(r):s.$node("<input/>"),u=e.toJSON({tokens:!0});i.attr("type",u.type),i.attr("token",u.token||null),i.attr("searchWhenChanged",u.searchWhenChanged!=null?String(o.normalizeBoolean(u.searchWhenChanged)):null);var a=n.trim(u.label);a!==undefined&&a!==u.token?s.replaceOrPrepend({node:s.$node("<label/>").text(a),selector:"label",container:i}):i.children("label").remove();if(u.choices&&u.choices.length){var f=t(u.choices).map(function(e){return s.$node("<choice/>").attr("value",e.value).text(e.label)});s.replaceOrAppend({node:f,container:i,selector:"choice"})}else i.children("choice").remove();this._applyPopulatingSearch(u,i);var l=u["default"];if(l){var c=s.$node("<default/>");u.type=="time"?(s.$node("<earliestTime></earliestTime>").text(l.earliest_time==null?"":l.earliest_time).appendTo(c),s.$node("<latestTime></latestTime>").text(l.latest_time==null?"":l.latest_time).appendTo(c)):c.text(l),s.replaceOrAppend({node:c,selector:"default",container:i})}else i.children("default").remove();return t(["prefix","suffix","seed","valuePrefix","valueSuffix","delimiter"]).each(function(e){var t=u[e];if(t){var n=s.$node("<"+e+"/>").text(t);s.replaceOrAppend({node:n,container:i,selector:e})}else i.children(e).remove()}),i},_applyPopulatingSearch:function(e,t){var n;if(e.searchType==="saved"){if(!e.searchName){t.children("populatingSavedSearch,populatingSearch").remove();return}n=s.$node("<populatingSavedSearch/>"),n.text(e.searchName)}else{if(!e.search){t.children("populatingSavedSearch,populatingSearch").remove();return}n=s.$node("<populatingSearch/>"),n.text(e.search),n.attr("earliest",e.earliest_time),n.attr("latest",e.latest_time)}e.labelField&&n.attr("fieldForLabel",e.labelField),e.valueField&&n.attr("fieldForValue",e.valueField),s.replaceOrAppend({node:n,container:t,selector:"populatingSavedSearch,populatingSearch"})},updateInputXML:function(e,t,r){u.log("About to update input=%o with settings=%o",e,t.toJSON());var i=this.get$XML(),o=this.getXMLNode(e,i);if(!o)throw new Error("Unable to find input with ID=",e);o=n(o);var a=this.inputSettingsToXML(t,o);return n(o).replaceWith(a),u.DEBUG_ENABLED&&(this.formatXML(i),u.log(s.serialize(i))),this.set$XML(i),this.save()},isFormAutoRun:function(){var e=this.get$XML(),t=e.find("fieldset");return o.normalizeBoolean(t.attr("autoRun"))},updateFormSettings:function(e){var t=this._migrateViewType(this.get$XML(),"form"),n=t.find("fieldset");return n.length||(n=this._createNewFieldset(t)),e.hasOwnProperty("submitButton")&&n.attr("submitButton",String(e.submitButton)),e.hasOwnProperty("autoRun")&&n.attr("autoRun",String(e.autoRun)),this.set$XML(t),this.save()},_createNewFieldset:function(e){var t=s.$node('<fieldset submitButton="false"></fieldset>');return s.inject({node:t,where:"after",container:e.find(":eq(0)"),selectors:["description","label"],fallback:"prepend"}),t},deleteInput:function(e){var n={fieldset:t(this._structure.fieldset).without(e),rows:t(this._structure.rows).map(function(n){return t(n).map(function(n){return{inputs:t(n.inputs).without(e),elements:n.elements}})})};return this.updateStructure(n)},_getInputOrderMap:function(e,n){var r={},i=function(e,n,r){if(e.length!==n.length)throw new Error("Input ("+r+") order did not match XML structure ("+e.length+" keys, "+n.length+" nodes)");return t.object(e,n)};return t.extend(r,i(e.fieldset,n.find(":eq(0)>fieldset>input,:eq(0)>fieldset>html"),"fieldset")),t.extend(r,i(t(e.rows).chain().flatten().pluck("inputs").flatten().value(),n.find(":eq(0)>row>panel>input"),"panels")),r},validateInputOrder:function(e){t(e).each(function(e,t){var r=n(e).attr(t);if(r!==undefined&&r!==t)throw new Error("Invalid Input order. Expected node with ID "+t+". Instead saw "+r)})},updateInput:function(e){return this.updateInputXML(e.get("name"),e,{})},addInput:function(e){var t=this.inputSettingsToXML(e),n=this._migrateViewType(this.get$XML(),"form"),r=n.find(":eq(0)>fieldset");return r.length||(r=this._createNewFieldset(n)),r.append(t),this._structure.fieldset.push(e.get("id")),this.set$XML(n),this.save()},updateStructure:function(e){this._structure||(u.warn("No captured dashboard structure"),this.captureDashboardStructure(e));if(!t.isEqual(e,this._structure)){e.rows=t(e.rows).map(function(e){return t(e).filter(function(e){return e.elements.length>0||e.inputs.length>0})}),e.rows=t(e.rows).filter(function(e){return e.length>0});var r=s.$node,i=this.get$XML(),o=i.find(":eq(0)"),a=this._getItemOrderMap(this._structure.rows,i),f=this._getInputOrderMap(this._structure,i);o.children("row").detach(),t(e.rows).each(function(e){var i=r("<row/>");t(e).each(function(e){var s=r("<panel/>");t(e.elements).each(function(e){var t=a[e];n(t).find("script").remove(),s.append(t)}),i.append(s)}),o.append(i)});var l=o.children("fieldset");l.length||(l=this._createNewFieldset(i)),l.children().detach(),t(e.fieldset).each(function(e){var t=f[e];t?(n(t).find("script").remove(),l.append(t)):u.warn("input not found",e)}),l.children().length==0&&l.remove();var c=o.children("row");return t(e.rows).each(function(e,r){var i=c[r],s=n(i).children("panel");t(e).each(function(e,r){var i=s[r];t(e.inputs).chain().clone().reverse().each(function(e){var t=f[e];n(t).find("script").remove(),n(i).prepend(t)})})}),u.log("Updated dashboard structure",JSON.stringify(e),i.find(":eq(0)")[0]),this._structure=e,o.children("row>panel:empty").remove(),o.children("row:empty").remove(),this.hasInputs()?i=this._migrateViewType(i,"form"):i=this._migrateViewType(i,"dashboard"),this.set$XML(i),u.log("Saving XML changes"),this.save()}return u.log("no changes to input order"),n.Deferred().resolve()},isEditable:function(){return this.isDashboard()||this.isForm()},getRootNodeName:function(){return(this.get$XML().find(":eq(0)").prop("nodeName")||"").toLowerCase()},hasInputs:function(){return this._structure.fieldset.length>0||t(this._structure.rows).any(function(e){return t(e).any(function(e){return e.inputs&&e.inputs.length>0})})}});return a}),define("splunkjs/mvc/simplexml/dashboardurl",["underscore","models/shared/ClassicURL","util/console"],function(e,t,n){function r(t){if(e.isObject(t))throw n.error("Encountered non-primitive value %o to be encoded as URL param.",t),new Error("Non-primitive values are not allowed in the query string");return encodeURIComponent(t)}var i=t.extend({encode:function(t){var n=this.toJSON(),i=[],s;return t=e.extend({preserveEmptyStrings:!0,preserveNull:!0},t),e.each(n,function(n,o){if(e.isUndefined(n)||n===null&&!t.preserveNull||n===""&&!t.preserveEmptyStrings)return;s=encodeURIComponent(o),n===null?i.push(s):e.isArray(n)?e.each(n,function(e){i.push(s+"="+r(e))}):i.push(s+"="+r(n))}),i.join("&")},decode:function(t){t=(t||"").replace(/^[&\?#]|[&#]$/g,"");if(!t)return{};var n={};return e(t.split("&")).each(function(t){var r=t.split("=",2),i=decodeURIComponent(r[0]),s=r.length>1?decodeURIComponent(r[1]):null;if(n.hasOwnProperty(i)){var o=n[i];e.isArray(o)||(o=n[i]=[o]),o.push(s)}else n[i]=s}),n}});return new i}),define("splunkjs/mvc/simplexml/router",["require","underscore","backbone","./dashboardurl","util/console"],function(e){var t=e("underscore"),n=e("backbone"),r=e("./dashboardurl"),i=e("util/console"),s=n.Router.extend({initialize:function(e){this.model=e.model,this.app=e.app},routes:{":locale/app/:app/:page?*qs":"view",":locale/app/:app/:page":"view",":locale/app/:app/:page/?*qs":"view",":locale/app/:app/:page/":"view",":locale/app/:app/:page/edit?*qs":"edit",":locale/app/:app/:page/edit":"edit","*root/:locale/app/:app/:page?*qs":"rootedView","*root/:locale/app/:app/:page":"rootedView","*root/:locale/app/:app/:page/?*qs":"rootedView","*root/:locale/app/:app/:page/":"rootedView","*root/:locale/app/:app/:page/edit?*qs":"rootedEdit","*root/:locale/app/:app/:page/edit":"rootedEdit",":locale/manager/:app/:page?*qs":"view",":locale/manager/:app/:page":"view",":locale/manager/:app/:page/?*qs":"view",":locale/manager/:app/:page/":"view","*root/:locale/manager/:app/:page?*qs":"rootedView","*root/:locale/manager/:app/:page":"rootedView","*root/:locale/manager/:app/:page/?*qs":"rootedView","*root/:locale/manager/:app/:page/":"rootedView","dj/:app/:page/":"splunkdj","dj/:app/:page/?*qs":"splunkdj","*root/dj/:app/:page/":"rootedSplunkdj","*root/dj/:app/:page/?*qs":"rootedSplunkdj"},view:function(){i.log("ROUTE: view"),this.page.apply(this,arguments),this.model.set("edit",!1)},edit:function(){i.log("ROUTE: edit"),this.page.apply(this,arguments),this.model.set("edit",!0)},rootedView:function(e){this.app.set("root",e),this.view.apply(this,t.rest(arguments))},rootedEdit:function(e){this.app.set("root",e),this.edit.apply(this,t.rest(arguments))},page:function(e,t,n){i.log("ROUTE: page(locale=%o, app=%o, page=%o)",e,t,n),this.app.set({locale:e,app:t,page:n}),r.fetch(),r.get("dialog")==="schedulePDF"&&(this.model.set("dialog",r.get("dialog")),r.unset("dialog"),this.updateUrl({replace:!0}))},splunkdj:function(e,t){this.page("en-US",e,t)},rootedSplunkdj:function(e){this.app.set("root",e),this.splunkdj.apply(this,t.rest(arguments))},updateUrl:function(e){var n=[this.app.get("root")||"",this.app.get("locale"),"app",this.app.get("app"),this.app.get("page")];this.model.get("edit")&&n.push("edit");var i=[n.join("/")],s=r.encode();s.length&&i.push(s),this.navigate(i.join("?"),t.extend({replace:!1},e))}});return s}),define("splunkjs/mvc/simplexml/controller",["require","util/router_utils","backbone","jquery","underscore","../utils","util/pdf_utils","util/console","uri/route","../sharedmodels","util/splunkd_utils","splunk.util","../protections","collections/search/Reports","./dashboardmodel","./router","util/ajax_no_cache"],function(e){var t=e("util/router_utils"),n=e("backbone"),r=e("jquery"),i=e("underscore"),s=e("../utils"),o=e("util/pdf_utils"),u=e("util/console"),a=e("uri/route"),f=e("../sharedmodels"),l=e("util/splunkd_utils"),c=e("splunk.util"),h=e("../protections"),p=e("collections/search/Reports"),d=e("./dashboardmodel"),v=e("./router");e("util/ajax_no_cache"),h.enableCSRFProtection(r),h.enableUnauthorizationRedirection(r,c.make_url("account/login"),"/account/logout");var m=function(){this.readyDfd=r.Deferred();var e=this.model=new n.Model,i=this.collection={},s=this.model.app=f.get("app"),u=this.model.appLocal=f.get("appLocal"),l=this.model.user=f.get("user"),c=this.collection.times=f.get("times");this.router=new v({model:this.model,app:s}),t.start_backbone_history();var h=this.model.view=new d;this.model.view.fetch({url:a.splunkdNS(s.get("root"),s.get("locale"),s.get("owner"),s.get("app"),[h.url,s.get("page")].join("/"))}).done(this._onViewModelLoad.bind(this)),o.isPdfServiceAvailable().always(function(t){e.set("pdf_available",t)}),this._onViewModelLoadDfd=r.Deferred(),this.model.on("change:edit",this.router.updateUrl,this.router),this.on("addInput",this.model.view.addInput,this.model.view)};i.extend(m.prototype,n.Events,{_onViewModelLoad:function(){var e=this.model;e.set("editable",e.view.isEditable()&&e.view.entry.acl.canWrite()),e.view.isXML()&&(e.set("label",this.model.view.getLabel()),e.set("description",this.model.view.getDescription()),e.on("change:label change:description",function(){e.view.setLabelAndDescription(e.get("label"),e.get("description")),e.view.save()}),e.set("rootNodeName",e.view.getRootNodeName()),e.view.on("change:rootNodeName",function(t,n){e.set("rootNodeName",n)})),this._onViewModelLoadDfd.resolve(this.model.view)},onViewModelLoad:function(e,t){this._onViewModelLoadDfd.done(e.bind(t||null))},getStateModel:function(){return this.model},isEditMode:function(){return this.model.get("edit")===!0},onReady:function(e){var t=r.when(this.readyDfd,this._onViewModelLoadDfd);return e&&t.then(e),t},ready:function(){this.readyDfd.resolve()},isReady:function(){return this.readyDfd.state()==="resolved"},fetchCollection:function(){this.reportsCollection=new p,this.reportsCollection.REPORTS_LIMIT=150;var e=this.model.app,t={data:{count:this.reportsCollection.REPORTS_LIMIT,app:e.get("app"),owner:e.get("owner"),search:'is_visible="1"'}};this.reportsCollection.initialFetchDfd=this.reportsCollection.fetch(t)}});var g=new m;return u.DEBUG_ENABLED&&(window.Dashboard=g),g}),define("models/services/authorization/Role",["models/SplunkDBase"],function(e){return e.extend({url:"authorization/roles",initialize:function(){e.prototype.initialize.apply(this,arguments)}})}),define("collections/services/authorization/Roles",["models/services/authorization/Role","collections/SplunkDsBase","models/shared/fetchdata/EAIFetchData"],function(e,t,n){return t.extend({FREE_PAYLOAD:{links:{create:"/services/authorization/roles/_new"},generator:{},entry:[{name:"admin",links:{alternate:"/services/authorization/roles/admin",list:"/services/authorization/roles/admin",edit:"/services/authorization/roles/admin",remove:"/services/authorization/roles/admin"},author:"system",acl:{app:"",can_list:!0,can_write:!0,modifiable:!1,owner:"system",perms:{read:["*"],write:["*"]},removable:!1,sharing:"system"},content:{capabilities:[],cumulativeRTSrchJobsQuota:400,cumulativeSrchJobsQuota:200,defaultApp:"","eai:acl":null,imported_capabilities:[],imported_roles:[],imported_rtSrchJobsQuota:20,imported_srchDiskQuota:500,imported_srchFilter:"",imported_srchIndexesAllowed:["*"],imported_srchIndexesDefault:["main"],imported_srchJobsQuota:10,imported_srchTimeWin:-1,rtSrchJobsQuota:100,srchDiskQuota:1e4,srchFilter:"*",srchIndexesAllowed:["*","_*"],srchIndexesDefault:["main","os"],srchJobsQuota:50,srchTimeWin:0}}],paging:{total:1,perPage:30,offset:0},messages:[]},initialize:function(e,r){r=r||{},r.fetchData=r.fetchData||new n({count:0}),t.prototype.initialize.call(this,e,r)},url:"authorization/roles",model:e})}),define("splunkjs/mvc/simplexml/mapper",["require","underscore","../mvc","backbone","util/console"],function(e){var t=e("underscore"),n=e("../mvc"),r=e("backbone"),i=e("util/console"),s=function(){};t.extend(s.prototype,{tagName:"#abstract",map:function(){},getSearch:function(e,t){var n;return e.entry.get("name")?(i.log("Mapping Saved Search"),n={type:"saved",name:e.entry.get("name",t)}):(i.log("Mapping Inline Search"),n={type:e.entry.content.get("display.general.search.type")||"inline",search:e.entry.content.get("search",t),earliest_time:e.entry.content.get("dispatch.earliest_time",t),latest_time:e.entry.content.get("dispatch.latest_time",t)},t.flatten&&n.type==="postprocess"&&(n.type="inline",n.search=e.entry.content.get("fullSearch",t))),n},toXML:function(e,t){t=t||{tokens:!0};var n={type:this.tagName,title:e.entry.content.get("display.general.title",t),search:this.getSearch(e,t),options:{},tags:{}};return this.map(e.entry.content,n,t),n.options.fields&&(n.tags.fields||(n.tags.fields=n.options.fields),n.options.fields=null),n}});var o={};return s.register=function(e,t){o[e]=t},s.get=function(e){var t=o[e];if(!t)throw new Error("No mapper for type "+e);return new t},s.extend=r.Model.extend,s}),define("models/dashboards/DashboardReport",["require","jquery","underscore","models/search/Report","splunkjs/mvc/simplexml/controller","splunkjs/mvc/simplexml/mapper","util/console","splunkjs/mvc/tokenawaremodel"],function(e){var t=e("jquery"),n=e("underscore"),r=e("models/search/Report"),i=e("splunkjs/mvc/simplexml/controller"),s=e("splunkjs/mvc/simplexml/mapper"),o=e("util/console"),u=e("splunkjs/mvc/tokenawaremodel"),a=r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments)},saveXML:function(e){var t=this.entry.content.get("display.general.id");return o.log("[%o] Saving Panel Element XML...",t),i.model.view.updateElement(t,this.mapToXML(),e)},mapToXML:function(e){var t=this.entry.content.get("display.general.type"),n=["display",t,"type"].join(".");this.entry.content.has(n)&&(t=[t,this.entry.content.get(n)].join(":")),o.log("Looking up mapper for type ",t);var r=s.get(t);return o.log("Found mapper",r),r.toXML(this,e)},deleteXML:function(){return i.model.view.deleteElement(this.entry.content.get("display.general.id"))},fetch:function(e){var t=this;t.entry.content._applyTokensByDefault=!1,t._fetching=!0;var n=r.prototype.fetch.call(this,e);return n.always(function(){t.entry.content._applyTokensByDefault=!0,t._fetching=!1}),n},setFromSplunkD:function(e,t){return t||(t={}),this._fetching&&t.tokens===undefined&&(t.tokens=!1),r.prototype.setFromSplunkD.call(this,e,t)},parse:function(){this.entry.content._applyTokensByDefault=!1;var e=r.prototype.parse.apply(this,arguments);return this.entry.content._applyTokensByDefault=!0,e},defaults:{"display.visualizations.charting.axisY.scale":"linear","display.visualizations.charting.axisX.scale":"linear","display.visualizations.charting.axisX.minimumNumber":"","display.visualizations.charting.axisX.maximumNumber":"","display.visualizations.charting.axisY.minimumNumber":"","display.visualizations.charting.axisY.maximumNumber":"","display.visualizations.charting.axisTitleX.text":"","display.visualizations.charting.axisTitleY.text":"","display.visualizations.charting.axisLabelsX.majorUnit":"","display.visualizations.charting.axisLabelsY.majorUnit":"","display.visualizations.charting.legend.placement":"right","display.visualizations.charting.legend.labelStyle.overflowMode":"ellipsisMiddle","display.visualizations.charting.chart.stackMode":"default","display.visualizations.charting.chart.nullValueMode":"zero","display.visualizations.charting.chart.rangeValues":'["0","30","70","100"]',"display.visualizations.charting.chart.style":"shiny","display.visualizations.charting.gaugeColors":[8710400,16771072,12529712],"display.prefs.events.count":"10","display.prefs.statistics.count":"10"},validation:{"display.visualizations.charting.axisX.minimumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisX.maximumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisY.minimumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisY.maximumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisY2.minimumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateYAxis2Extremes",required:!1}],"display.visualizations.charting.axisY2.maximumNumber":[{pattern:"number",msg:"Please enter a number",required:!1},{fn:"validateYAxis2Extremes",required:!1}],"display.visualizations.charting.axisLabelsX.majorUnit":{pattern:"number",min:Number.MIN_VALUE,msg:"Please enter a positive number",required:!1},"display.visualizations.charting.axisLabelsY.majorUnit":{pattern:"number",min:Number.MIN_VALUE,msg:"Please enter a positive number",required:!1},"display.visualizations.charting.axisLabelsY2.majorUnit":{pattern:"number",min:Number.MIN_VALUE,msg:"Please enter a positive number",required:!1},"display.visualizations.charting.axisY.scale":{fn:"validateYScaleAndStacking",required:!1},"display.visualizations.charting.chart.stackMode":{fn:"validateYScaleAndStacking",required:!1},"display.visualizations.charting.chart.rangeValues":{fn:"validateRangeValues",required:!1},"display.prefs.events.count":{pattern:"number",min:1,msg:n("Rows Per Page must be a positive number.").t(),required:!1},"display.prefs.statistics.count":{pattern:"number",min:1,msg:n("Rows Per Page must be a positive number.").t(),required:!1}},validateXAxisExtremes:function(e,t,r){var i=parseFloat(r["display.visualizations.charting.axisX.minimumNumber"]),s=parseFloat(r["display.visualizations.charting.axisX.maximumNumber"]);if(!n.isNaN(i)&&!n.isNaN(s)&&s<=i)return"The minimum value must be less than maximum value"},validateYAxisExtremes:function(e,t,r){var i=parseFloat(r["display.visualizations.charting.axisY.minimumNumber"]),s=parseFloat(r["display.visualizations.charting.axisY.maximumNumber"]);if(!n.isNaN(i)&&!n.isNaN(s)&&s<=i)return"The minimum value must be less than maximum value"},validateYAxis2Extremes:function(e,t,r){var i=parseFloat(r["display.visualizations.charting.axisY2.minimumNumber"]),s=parseFloat(r["display.visualizations.charting.axisY2.maximumNumber"]);if(!n.isNaN(i)&&!n.isNaN(s)&&s<=i)return"The minimum value must be less than maximum value"},validateYScaleAndStacking:function(e,t,n){var r=n["display.visualizations.charting.axisY.scale"],i=n["display.visualizations.charting.chart.stackMode"];if(r==="log"&&i!=="default")return"Log scale and stacking cannot be enabled at the same time"},validateRangeValues:function(e){var r=n(e?JSON.parse(e):[]).map(parseFloat);if(n(r).any(n.isNaN)||!e)return"All color ranges must be valid numbers";var i=n.uniq(r),s=t.extend([],r).sort(function(e,t){return e-t});if(!n.isEqual(r,i)||!n.isEqual(r,s))return"Color ranges must be entered from lowest to highest"},attrToArray:function(e){var t=this.get(e);return t?n.values(JSON.parse(t)):[]},rangesValuesToArray:function(){return this.attrToArray("display.visualizations.charting.chart.rangeValues")},gaugeColorsToArray:function(){return this.attrToArray("display.visualizations.charting.gaugeColors")}},{Entry:r.Entry.extend({},{Content:u.extend({applyTokensByDefault:!0,clone:function(){return new r.Entry.Content(this.toJSON())}})})});return a}),define("util/moment/compactFromNow",["util/moment"],function(e){function n(e,n,r){var i=t(Math.abs(e)/1e3),s=t(i/60),o=t(s/60),u=t(o/24),a=t(u/365),f=i<45&&["s",i]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",t(u/30)]||a===1&&["y"]||["yy",a],l=f[0],c=f[1]||1,h=e>0,p=(r._compactRelativeTime||{})[l];return p===undefined?r.relativeTime(c,!!n,l,h):typeof p=="function"?p(c,n,l,h):p.replace(/%d/i,c)}var t=Math.round;return e.duration.fn.humanizeCompact=function(e){var t=+this,r=n(t,!e,this.lang());return e&&(r=this.lang().pastFuture(t,r)),this.lang().postformat(r)},e.fn.compactFromNow=function(t){return e.duration(this.diff(e())).lang(this.lang()._abbr).humanizeCompact(!t)},e}),define("splunkjs/mvc/refreshtimeindicatorview",["require","exports","module","./mvc","./basesplunkview","util/moment","util/moment/compactFromNow","underscore","splunk.util","util/general_utils"],function(e,t,n){function c(){o(f).each(function(e){e()})}function h(e){delete f[e],o.isEmpty(f)&&(clearInterval(l),l=null)}function p(e,t,n){f[e]&&h(e),f[e]=o.bind(t,n),l||(l=setInterval(c,1e3))}var r=e("./mvc"),i=e("./basesplunkview"),s=e("util/moment");e("util/moment/compactFromNow");var o=e("underscore"),u=e("splunk.util"),a=e("util/general_utils"),f={},l,d=i.extend({moduleId:n.id,className:"splunk-timeindicator",events:{"click a.refresh-btn":"refresh"},configure:function(){this.options.manager&&(this.options.managerid=this.options.manager),this.options["refresh.time.visible"]=a.normalizeBoolean(this.options["refresh.time.visible"],{"default":!0}),u.isInt(this.options["refresh.auto.interval"])?this.options["refresh.auto.interval"]=parseInt(this.options["refresh.auto.interval"],10):this.options["refresh.auto.interval"]=0,i.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.bindToComponentSetting("managerid",this.onManagerChange,this),this.timer=o.uniqueId("timer_"),this.listenTo(this.settings,"change",this.updateContent)},onManagerChange:function(e,t){this.manager&&this.manager.off(null,null,this);if(!t)return;this.manager=t,this.manager.on("search:start",this.clear,this),this.manager.on("search:progress",this.onSearchProgress,this),this.manager.on("search:done",this.onSearchProgress,this),this.manager.on("search:fail",this.clear,this),this.manager.on("search:cancelled",this.clear,this),t.replayLastSearchEvent(this)},clear:function(){h(this.timer),this.$el.html("&nbsp;")},updateRefreshTime:function(){this.refreshTime&&s().diff(this.refreshTime)>=1e4&&(this.$(".time-freshness").text(this.refreshTime.compactFromNow()).show(),this.$(".time-freshness").attr("title",o("Last refresh: ").t()+this.refreshTime.format("LLL")),this.$el.show())},onSearchProgress:function(e){this.lastContent=(e||{}).content||{},this.updateContent()},updateContent:function(){var e=this.lastContent;this.autoRefresh&&(clearInterval(this.autoRefresh),this.autoRefresh=null),e.dispatchState==="FAILED"?this.clear():e.dispatchState==="PARSING"||e.dispatchState==="QUEUED"?this.clear():e.dispatchState==="RUNNING"?e.isRealTimeSearch?(h(this.timer),this.$el.text(o("Real-time").t())):this.clear():e.dispatchState==="DONE"&&(this.$el.hide(),this.refreshTime=s(this.manager.job.published()),this.clear(),this.refreshTime&&this.settings.get("refresh.time.visible")&&(this.$el.append($('<span class="time-freshness"/>')),this.updateRefreshTime(),p(this.timer,this.updateRefreshTime,this)),this.settings.get("refresh.auto.interval")&&(this.autoRefresh=setTimeout(o.bind(this.refresh,this),1e3*this.settings.get("refresh.auto.interval"))))},refresh:function(e){e&&e.preventDefault(),this.manager.startSearch()},render:function(){return this.$el.html("&nbsp;"),this},remove:function(){return h(this.timer),this.autoRefresh&&(clearInterval(this.autoRefresh),this.autoRefresh=null),this.onManagerChange(null,null),i.prototype.remove.call(this)}});return d}),define("splunkjs/mvc/resultslinkview",["require","exports","module","jquery","underscore","splunk.util","splunk.window","models/search/Job","uri/route","views/shared/jobstatus/buttons/ExportResultsDialog","./basesplunkview","./mvc","models/dashboards/DashboardReport","./savedsearchmanager","./utils","./sharedmodels","splunk.util","./postprocessmanager"],function(e,t,n){var r=e("jquery"),i=e("underscore"),s=e("splunk.util"),o=e("splunk.window"),u=e("models/search/Job"),a=e("uri/route"),f=e("views/shared/jobstatus/buttons/ExportResultsDialog"),l=e("./basesplunkview"),c=e("./mvc"),h=e("models/dashboards/DashboardReport"),p=e("./savedsearchmanager"),d=e("./utils"),v=e("./sharedmodels"),m=e("splunk.util"),g=e("./postprocessmanager"),y=l.extend({moduleId:n.id,events:{"click a.refresh-button":"refresh"},configure:function(){this.options.manager&&(this.options.managerid=this.options.manager),l.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.bindToComponentSetting("managerid",this.onManagerChange,this),this.searchJobModel=new u,this.applicationModel=v.get("app"),this.model=this.model||new h,this.listenTo(this.model.entry.content,"change:search",i.bind(this.render,this))},onManagerChange:function(e,t){this.manager&&(this.manager.off(null,null,this),this.manager=null);if(!t)return;this.manager=t,this.listenTo(t,"search:start",this.onSearchStart),this.listenTo(t,"search:done",this.onSearchDone),this.manager.job&&this.onSearchStart(this.manager.job),this.manager.replayLastSearchEvent(this)},onSearchStart:function(e){this.searchJobModel.set("id",e.sid),this.$pivotButton&&this.$pivotButton.off("click").on("click",this.openPivot.bind(this)).show(),this.$searchButton&&this.$searchButton.off("click").on("click",this.openSearch.bind(this)).show(),this.$refreshButton&&this.$refreshButton.show(),this.$exportButton&&(this.manager instanceof g?(this.$exportButton.tooltip("destroy"),this.$exportButton.attr("title",i("Export - You cannot export results for post-process jobs.").t()),this.$exportButton.tooltip({animation:!1,container:"body"}),this.$exportButton.addClass("disabled"),this.$exportButton.off("click").on("click",function(e){e.preventDefault()}).show()):(this.$exportButton.addClass("disabled"),this.$exportButton.off("click").on("click",function(e){e.preventDefault()}).show())),this.$inspectButton&&this.$inspectButton.off("click").on("click",this.inspectSearch.bind(this)).show()},onSearchDone:function(e){this.searchJobModel.setFromSplunkD({entry:[this.manager.job.state()]}),this.$exportButton&&(this.manager instanceof g?(this.$exportButton.tooltip("destroy"),this.$exportButton.attr("title",i("Export - You cannot export results for post-process jobs.").t()),this.$exportButton.tooltip({animation:!1,container:"body"}),this.$exportButton.addClass("disabled"),this.$exportButton.off("click").on("click",function(e){e.preventDefault()}).show()):(this.$exportButton.tooltip("destroy"),this.$exportButton.attr("title",i("Export").t()),this.$exportButton.tooltip({animation:!1,container:"body"}),this.$exportButton.removeClass("disabled"),this.$exportButton.off("click").on("click",this.exportResults.bind(this)).show()))},openSearch:function(e){e&&e.preventDefault();var t=this.options,n=this.manager,r,i,s;t["link.openSearch.search"]?(r={q:t["link.openSearch.search"]},i=t["link.openSearch.searchEarliestTime"],!i&&n.job.properties().earliestTime?i=m.getEpochTimeFromISO(n.job.properties().earliestTime):i=n.settings.get("earliest_time"),i!=null&&(r.earliest=i),s=t["link.openSearch.searchLatestTime"],!s&&n.job.properties().latestTime?s=m.getEpochTimeFromISO(n.job.properties().latestTime):s=n.settings.get("latest_time"),s!=null&&(r.latest=s)):t["link.openSearch.viewTarget"]?r={sid:this.searchJobModel.get("id")}:(r={sid:this.searchJobModel.get("id"),q:n.settings.resolve()},n instanceof p&&(r.s=n.get("searchname")),i=n.settings.get("earliest_time"),i!=null&&(r.earliest=i),s=n.settings.get("latest_time"),s!=null&&(r.latest=s));var o=d.getPageInfo(),u=a.page(o.root,o.locale,o.app,t["link.openSearch.viewTarget"]||"search",{data:r});window.open(u,"_blank")},exportResults:function(e){e&&e.preventDefault();var t=new f({model:{searchJob:this.searchJobModel,application:this.applicationModel,report:this.model},usePanelType:!0});t.render().appendTo(r("body")),t.show()},inspectSearch:function(e){e&&e.preventDefault();var t=d.getPageInfo(),n=a.jobInspector(t.root,t.locale,t.app,this.searchJobModel.get("id"));o.open(n,"splunk_job_inspector",{width:870,height:560,menubar:!1})},openPivot:function(e){e&&e.preventDefault();var t=d.getPageInfo(),n,r;if(this.model.has("id")){var i=this.model.get("id");n={s:i},this.model.entry.content.has("dispatch.earliest_time")&&(n.earliest=this.model.entry.content.get("dispatch.earliest_time"),n.latedst=this.model.entry.content.get("dispatch.latest_time")),r=a.pivot(t.root,t.locale,t.app,{data:n}),d.redirect(r,!0)}else{var s=this.model.entry.content.get("search");n={q:s},this.model.entry.content.has("dispatch.earliest_time")&&(n.earliest=this.model.entry.content.get("dispatch.earliest_time"),n.latest=this.model.entry.content.get("dispatch.latest_time")),r=a.pivot(t.root,t.locale,t.app,{data:n}),d.redirect(r,!0)}},render:function(){var e;return this.model.isPivotReport()?e=i.template(this.pivotTemplate):e=i.template(this.template),this.$el.html(e({options:this.options})),this.resolveBooleanOptions("link.openPivot.visible","link.visible",!0)?this.$pivotButton=this.$(".pivot-button").hide():this.$(".pivot-button").remove(),this.resolveBooleanOptions("link.openSearch.visible","link.visible",!0)?this.$searchButton=this.$(".search-button").hide():this.$(".search-button").remove(),this.resolveBooleanOptions("link.exportResults.visible","link.visible",!0)?this.$exportButton=this.$(".export-button").hide():this.$(".export-button").remove(),this.resolveBooleanOptions("link.inspectSearch.visible","link.visible",!0)?this.$inspectButton=this.$(".inspect-button").hide():this.$(".inspect-button").remove(),this.resolveBooleanOptions("refresh.link.visible","link.visible",!0)?this.$refreshButton=this.$(".refresh-button").hide():this.$(".refresh-button").remove(),this.$searchButton||this.$exportButton||this.$inspectButton||this.$refreshButton?this.$el.show():this.$el.hide(),this.$("> a").tooltip({animation:!1,container:"body"}),this},resolveBooleanOptions:function(){var e=this.options,t;for(var n=0,r=arguments.length-1;n<r;n++){t=e[arguments[n]];if(t!=null)return s.normalizeBoolean(t)}return s.normalizeBoolean(arguments[arguments.length-1])},refresh:function(e){e&&e.preventDefault(),this.manager.startSearch("refresh")},template:'            <a href="#search" class="search-button btn-pill" title="<%- options[\'link.openSearch.text\'] || _(\'Open in Search\').t() %>">                <i class="icon-search"></i>                <span class="hide-text"><%- options[\'link.openSearch.text\'] || _("Open in Search").t() %></span>            </a><a href="#export" class="export-button btn-pill" title="<%- _(\'Export - You can only export results for completed jobs.\').t() %>">                <i class="icon-export"></i>                <span class="hide-text"><%- _("Export").t() %></span>            </a><a href="#inspect" class="inspect-button btn-pill" title="<%- _(\'Inspect\').t() %>">                <i class="icon-info"></i>                <span class="hide-text"><%- _("Inspect").t() %></span>            </a><a href="#refresh" class="refresh-button btn-pill" title="<%- _(\'Refresh\').t() %>">                <i class="icon-rotate-counter"></i>                <span class="hide-text"><%- _("Refresh").t() %></span>            </a>        ',pivotTemplate:'            <a href="#pivot" class="pivot-button btn-pill" title="<%- _(\'Open in Pivot\').t() %>">                <i class="icon-pivot"></i>                <span class="hide-text"><%- _("Open in Pivot").t() %></span>            </a><a href="#export" class="export-button btn-pill" title="<%- _(\'Export\').t() %>">                <i class="icon-export"></i>                <span class="hide-text"><%- _("Export").t() %></span>            </a><a href="#inspect" class="inspect-button btn-pill" title="<%- _(\'Inspect\').t() %>">                <i class="icon-info"></i>                <span class="hide-text"><%- _("Inspect").t() %></span>            </a><a href="#refresh" class="refresh-button btn-pill" title="<%- _(\'Refresh\').t() %>">                <i class="icon-rotate-counter"></i>                <span class="hide-text"><%- _("Refresh").t() %></span>            </a>        '});return y}),define("views/shared/vizcontrols/custom_controls/DrilldownRadio",["underscore","jquery","module","views/shared/controls/SyntheticRadioControl","splunk.util"],function(e,t,n,r,i){return r.extend({moduleId:n.id,initialize:function(){t.extend(this.options,{modelAttribute:"display.visualizations.charting.drilldown",items:[{label:e("Yes").t(),value:"all"},{label:e("No").t(),value:"none"}],save:!1,elastic:!0}),r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/DrilldownRadioGroup",["underscore","module","views/shared/controls/ControlGroup","./DrilldownRadio"],function(e,t,n,r){return n.extend({moduleId:t.id,initialize:function(){var t=new r({model:this.model});this.options.label=e("Drilldown").t(),this.options.controls=[t],n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/StackModeControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){var t=[{value:"default",icon:"bar-beside",tooltip:e("not stacked").t()},{value:"stacked",icon:"bar-stacked",tooltip:e("stacked").t()}];this.options.allowStacked100!==!1&&t.push({value:"stacked100",icon:"bar-stacked-100",tooltip:e("stacked 100%").t()}),this.options.label=e("Stack Mode").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.chart.stackMode",model:this.model,className:"btn-group",items:t},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/NullValueModeControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Null Values").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.chart.nullValueMode",model:this.model,className:"btn-group",items:[{value:"gaps",icon:"missing-value-skipped",tooltip:e("Gaps").t()},{value:"zero",icon:"missing-value-zero",tooltip:e("Zero").t()},{value:"connect",icon:"missing-value-join",tooltip:e("Connect").t()}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/GaugeStyleControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Style").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.chart.style",model:this.model,items:[{label:e("Minimal").t(),value:"minimal"},{label:e("Shiny").t(),value:"shiny"}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/SingleValueBeforeLabelControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Before Label").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.singlevalue.beforeLabel",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/SingleValueAfterLabelControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("After Label").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.singlevalue.afterLabel",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/SingleValueUnderLabelControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Under Label").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.singlevalue.underLabel",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MultiSeriesRadio",["underscore","jquery","module","views/shared/controls/ControlGroup"],function(e,t,n,r){return r.extend({moduleId:n.id,initialize:function(){this.options.label=e("Multi-series Mode").t(),this.options.controlType="SyntheticRadio",this.options.controlClass="controls-halfblock",this.options.controlOptions={modelAttribute:"display.visualizations.charting.layout.splitSeries",model:this.model,items:[{label:e("Yes").t(),value:"1"},{label:e("No").t(),value:"0"}],save:!1,elastic:!0},r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MapDrilldownControlGroup",["underscore","jquery","module","views/shared/controls/ControlGroup"],function(e,t,n,r){return r.extend({moduleId:n.id,initialize:function(){this.options.label=e("Drilldown").t(),this.options.controlType="SyntheticRadio",this.options.controlClass="controls-halfblock",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.drilldown",model:this.model,items:[{label:e("Yes").t(),value:"all"},{label:e("No").t(),value:"none"}],elastic:!0},r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/General",["underscore","jquery","module","views/Base","views/shared/controls/ControlGroup","views/shared/vizcontrols/custom_controls/DrilldownRadioGroup","views/shared/vizcontrols/custom_controls/StackModeControlGroup","views/shared/vizcontrols/custom_controls/NullValueModeControlGroup","views/shared/vizcontrols/custom_controls/GaugeStyleControlGroup","views/shared/vizcontrols/custom_controls/SingleValueBeforeLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueAfterLabelControlGroup","views/shared/vizcontrols/custom_controls/SingleValueUnderLabelControlGroup","views/shared/vizcontrols/custom_controls/MultiSeriesRadio","views/shared/vizcontrols/custom_controls/MapDrilldownControlGroup"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToGeneralComponents:{line:["nullValue","multiseries","drilldown"],area:["stack","nullValue","multiseries","drilldown"],column:["stack","multiseries","drilldown"],bar:["stack","multiseries","drilldown"],pie:["drilldown"],scatter:["drilldown"],radialGauge:["style"],fillerGauge:["style"],markerGauge:["style"],single:["before","after","under"],mapping:["mapDrilldown"]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToGeneralComponents[this.model.get("viz_type")];e.indexOf(n,"stack")>-1&&(this.children.stackMode=new o({model:this.model,controlClass:"controls-thirdblock"})),e.indexOf(n,"nullValue")>-1&&(this.children.nullValueMode=new u({model:this.model,controlClass:"controls-thirdblock"})),e.indexOf(n,"multiseries")>-1&&(this.children.multiSeries=new h({model:this.model})),e.indexOf(n,"drilldown")>-1&&(this.children.drilldown=new s({model:this.model,controlClass:"controls-halfblock"})),e.indexOf(n,"style")>-1&&(this.children.gaugeStyle=new a({model:this.model,controlClass:"controls-halfblock"})),e.indexOf(n,"before")>-1&&(this.children.beforeLabel=new f({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"after")>-1&&(this.children.afterLabel=new l({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"under")>-1&&(this.children.underLabel=new c({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"mapDrilldown")>-1&&(this.children.mapDrilldown=new p({model:this.model}))},render:function(){return this.children.stackMode&&this.children.stackMode.render().appendTo(this.$el),this.children.nullValueMode&&this.children.nullValueMode.render().appendTo(this.$el),this.children.multiSeries&&this.children.multiSeries.render().appendTo(this.$el),this.children.drilldown&&this.children.drilldown.render().appendTo(this.$el),this.children.gaugeStyle&&this.children.gaugeStyle.render().appendTo(this.$el),this.children.beforeLabel&&this.children.beforeLabel.render().appendTo(this.$el),this.children.afterLabel&&this.children.afterLabel.render().appendTo(this.$el),this.children.underLabel&&this.children.underLabel.render().appendTo(this.$el),this.children.events&&this.children.events.render().appendTo(this.$el),this.children.statistics&&this.children.statistics.render().appendTo(this.$el),this.children.mapDrilldown&&this.children.mapDrilldown.render().appendTo(this.$el),this}})}),define("views/shared/vizcontrols/custom_controls/AxisTitleControlGroup",["underscore","module","models/Base","views/shared/controls/ControlGroup","views/shared/controls/Control"],function(e,t,n,r,i){return r.extend({moduleId:t.id,initialize:function(){this.axisTitleVisibilityAttr="display.visualizations.charting."+this.options.axisType+".visibility",this.axisTitleTextAttr="display.visualizations.charting."+this.options.axisType+".text",this.titleStateModel=new n,this.setInitialTitleState(),this.axisTitleText=this.model.get(this.axisTitleTextAttr),this.options.label=e("Title").t(),this.options.controlClass="controls-block",this.options.controls=[{type:"SyntheticSelect",options:{className:i.prototype.className+" input-prepend",model:this.titleStateModel,modelAttribute:"state",toggleClassName:"btn",menuWidth:"narrow",items:[{value:"default",label:e("Default").t()},{value:"custom",label:e("Custom").t()},{value:"none",label:e("None").t()}]}},{type:"Text",options:{className:i.prototype.className+" input-prepend",model:this.model,modelAttribute:this.axisTitleTextAttr,inputClassName:this.options.inputClassName}}],r.prototype.initialize.call(this,this.options),this.showHideControl=this.childList[0],this.labelControl=this.childList[1],this.titleStateModel.on("change:state",this.handleTitleState,this),this.model.on("change:"+this.axisTitleTextAttr,function(){this.titleStateModel.get("state")!=="default"&&(this.axisTitleText=this.model.get(this.axisTitleTextAttr))},this)},setInitialTitleState:function(){this.model.get(this.axisTitleVisibilityAttr)==="collapsed"?this.titleStateModel.set({state:"none"}):this.model.get(this.axisTitleTextAttr)?this.titleStateModel.set({state:"custom"}):this.titleStateModel.set({state:"default"})},render:function(){return r.prototype.render.apply(this,arguments),this.handleTitleState(),this},handleTitleState:function(){var e=this.titleStateModel.get("state"),t={};e==="none"?(t[this.axisTitleVisibilityAttr]="collapsed",this.hideTitleTextInput()):e==="custom"?(t[this.axisTitleVisibilityAttr]="visible",t[this.axisTitleTextAttr]=this.axisTitleText,this.showTitleTextInput()):(t[this.axisTitleVisibilityAttr]="visible",t[this.axisTitleTextAttr]="",this.hideTitleTextInput()),this.model.set(t)},showTitleTextInput:function(){this.labelControl.insertAfter(this.showHideControl.$el),this.showHideControl.$el.addClass("input-prepend")},hideTitleTextInput:function(){this.labelControl.detach(),this.showHideControl.$el.removeClass("input-prepend")}},{X_AXIS:"axisTitleX",Y_AXIS:"axisTitleY",Y_AXIS_2:"axisTitleY2"})}),define("views/shared/vizcontrols/custom_controls/AxisScaleControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Scale").t(),this.options.controlType="SyntheticRadio";var t=[{label:e("Linear").t(),value:"linear"},{label:e("Log").t(),value:"log"}];this.options.supportInherit&&t.unshift({label:e("Inherit").t(),value:"inherit"}),this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".scale",model:this.model,className:"btn-group",items:t},n.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisX",Y_AXIS:"axisY",Y_AXIS_2:"axisY2"})}),define("views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Interval").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".majorUnit",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisLabelsX",Y_AXIS:"axisLabelsY",Y_AXIS_2:"axisLabelsY2"})}),define("views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Min Value").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".minimumNumber",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisX",Y_AXIS:"axisY",Y_AXIS_2:"axisY2"})}),define("views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Max Value").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".maximumNumber",model:this.model,placeholder:e("optional").t(),inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisX",Y_AXIS:"axisY",Y_AXIS_2:"axisY2"})}),define("views/shared/vizcontrols/custom_controls/AxisLabelRotationControlGroup",["jquery","underscore","module","views/shared/controls/ControlGroup"],function(e,t,n,r){return r.extend({moduleId:n.id,initialize:function(){this.options.label=t("Label Rotation").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".majorLabelStyle.rotation",model:this.model,items:[{value:"-90",icon:"label-rotation--90",tooltip:"-90&deg;"},{value:"-45",icon:"label-rotation--45",tooltip:"-45&deg;"},{value:"0",icon:"label-rotation-0",tooltip:"0&deg;"},{value:"45",icon:"label-rotation-45",tooltip:"45&deg;"},{value:"90",icon:"label-rotation-90",tooltip:"90&deg;"}],className:"btn-group"},r.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisLabelsX",Y_AXIS:"axisLabelsY",Y_AXIS_2:"axisLabelsY2"})}),define("views/shared/vizcontrols/custom_controls/AxisLabelElisionControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Label Truncation").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".majorLabelStyle.overflowMode",model:this.model,className:"btn-group",items:[{label:e("Yes").t(),value:"ellipsisMiddle"},{label:e("No").t(),value:"ellipsisNone"}]},n.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisLabelsX",Y_AXIS:"axisLabelsY",Y_AXIS_2:"axisLabelsY2"})}),define("views/shared/vizcontrols/components/XAxis",["underscore","jquery","module","views/Base","views/shared/vizcontrols/custom_controls/AxisTitleControlGroup","views/shared/vizcontrols/custom_controls/AxisScaleControlGroup","views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup","views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup","views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup","views/shared/vizcontrols/custom_controls/AxisLabelRotationControlGroup","views/shared/vizcontrols/custom_controls/AxisLabelElisionControlGroup"],function(e,t,n,r,i,s,o,u,a,f,l){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToGeneralComponents:{line:["title","elision","rotation"],area:["title","elision","rotation"],column:["title","elision","rotation"],bar:["title"],pie:[],scatter:["title","elision","rotation","scale","interval","min","max"],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToGeneralComponents[this.model.get("viz_type")];e.indexOf(n,"title")>-1&&(this.children.title=new i({model:this.model,axisType:i.X_AXIS})),e.indexOf(n,"elision")>-1&&(this.children.elision=new l({model:this.model,axisType:l.X_AXIS})),e.indexOf(n,"rotation")>-1&&(this.children.rotation=new f({model:this.model,axisType:f.X_AXIS})),e.indexOf(n,"scale")>-1&&(this.children.scale=new s({model:this.model,className:"scale control-group",controlClass:"controls-halfblock",axisType:s.X_AXIS})),e.indexOf(n,"interval")>-1&&(this.children.interval=new o({model:this.model,controlClass:"controls-block",axisType:o.X_AXIS})),e.indexOf(n,"min")>-1&&(this.children.min=new u({model:this.model,controlClass:"controls-block",axisType:u.X_AXIS})),e.indexOf(n,"max")>-1&&(this.children.max=new a({model:this.model,controlClass:"controls-block",axisType:a.X_AXIS})),this.model.get("display.visualizations.charting.axisX.scale")=="log"&&this.children.interval&&this.children.interval.$el.hide(),this.children.elision&&this.model.on("change:display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation",this.handleRotation,this)},events:{"click .scale button":function(e){this.intervalVal=this.intervalVal||this.model.get("display.visualizations.charting.axisLabelsX.majorUnit"),t(e.currentTarget).data("value")=="log"?(this.children.interval&&this.children.interval.$el.hide(),this.model.set("display.visualizations.charting.axisLabelsX.majorUnit","")):(this.children.interval&&this.children.interval.$el.show(),this.model.set("display.visualizations.charting.axisLabelsX.majorUnit",this.intervalVal))}},render:function(){return this.children.title&&this.children.title.render().appendTo(this.$el),this.children.elision&&this.children.elision.render().appendTo(this.$el),this.children.rotation&&this.children.rotation.render().appendTo(this.$el),this.children.scale&&this.children.scale.render().appendTo(this.$el),this.children.interval&&this.children.interval.render().appendTo(this.$el),this.children.min&&this.children.min.render().appendTo(this.$el),this.children.max&&this.children.max.render().appendTo(this.$el),this.children.elision&&this.handleRotation(),this},handleRotation:function(){this.model.get("display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation")==="0"?this.children.elision&&this.children.elision.disable():this.children.elision&&this.children.elision.enable()}})}),define("views/shared/vizcontrols/components/YAxis",["underscore","jquery","module","views/Base","views/shared/vizcontrols/custom_controls/AxisTitleControlGroup","views/shared/vizcontrols/custom_controls/AxisScaleControlGroup","views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup","views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup","views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup"],function(e,t,n,r,i,s,o,u,a){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToYAxisComponents:{line:["title","scale","interval","min","max"],bar:["title","scale","interval","min","max"],area:["title","scale","interval","min","max"],column:["title","scale","interval","min","max"],scatter:["title","scale","interval","min","max"],pie:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToYAxisComponents[this.model.get("viz_type")];e.indexOf(n,"title")>-1&&(this.children.title=new i({className:"y-axis-title control-group",model:this.model,axisType:i.Y_AXIS})),e.indexOf(n,"scale")>-1&&(this.children.scale=new s({model:this.model,className:"scale control-group",controlClass:"controls-halfblock",axisType:s.Y_AXIS})),e.indexOf(n,"interval")>-1&&(this.children.interval=new o({model:this.model,controlClass:"controls-block",axisType:o.Y_AXIS})),e.indexOf(n,"min")>-1&&(this.children.min=new u({model:this.model,controlClass:"controls-block",axisType:u.Y_AXIS})),e.indexOf(n,"max")>-1&&(this.children.max=new a({model:this.model,controlClass:"controls-block",axisType:a.Y_AXIS})),this.model.get("display.visualizations.charting.axisY.scale")=="log"&&this.children.interval&&this.children.interval.$el.hide()},events:{"click .scale button":function(e){this.intervalVal=this.intervalVal||this.model.get("display.visualizations.charting.axisLabelsY.majorUnit"),t(e.currentTarget).data("value")=="log"?(this.children.interval&&this.children.interval.$el.hide(),this.model.set("display.visualizations.charting.axisLabelsY.majorUnit","")):(this.children.interval&&this.children.interval.$el.show(),this.model.set("display.visualizations.charting.axisLabelsY.majorUnit",this.intervalVal))}},render:function(){return this.children.title&&this.children.title.render().appendTo(this.$el),this.children.scale&&this.children.scale.render().appendTo(this.$el),this.children.interval&&this.children.interval.render().appendTo(this.$el),this.children.min&&this.children.min.render().appendTo(this.$el),this.children.max&&this.children.max.render().appendTo(this.$el),this}})}),define("views/shared/controls/MultiInputControl",["underscore","module","views/shared/controls/Control","splunk.util","select2/select2"],function(e,t,n,r){var i="::::";return n.extend({moduleId:t.id,events:{"change input":function(e){var t=e.val||[];this.setValue(r.fieldListToString(t),!1)}},render:function(){if(this.el.innerHTML)return;this.$el.html(this.compiledTemplate({options:this.options}));var t=this.$("input");return t.select2({placeholder:this.options.placeholder,tags:this.options.autoCompleteFields||[],formatNoMatches:function(){return"&nbsp;"},dropdownCssClass:"empty-results-allowed",separator:i,openOnEnter:!1,initSelection:function(t,n){var r=t.val();if(!r){n([]);return}var s=e(r.split(i)).map(function(e){return{id:e,text:e}});n(s)}}).select2("val",r.stringToFieldList(this._value||"")).on("removed",function(n){var r=n.val.toString(),s=t.val();s=e(s).isString()?s.split(i):s;var o=e(s).without(r);t.select2("val",o)}).on("open",function(){var n=t.val(),r=t.data("select2").results;n=e(n).isString()?n.split(i):n,r.find(".select2-result").each(function(){var t=$(this),r=t.data("select2-data").id.toString();e(n).contains(r)&&t.addClass("select2-selected")})}),this},remove:function(){return this.$("input").select2("close").select2("destroy"),n.prototype.remove.apply(this,arguments)},template:'            <input class="<%= options.inputClassName %>" />        '})}),define("views/shared/vizcontrols/custom_controls/OverlayFieldsControlGroup",["underscore","module","views/shared/controls/ControlGroup","views/shared/controls/MultiInputControl"],function(e,t,n,r){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Overlay").t(),this.options.controlType="Text";var t=new r({modelAttribute:"display.visualizations.charting.chart.overlayFields",model:this.model.visualization,autoCompleteFields:this.model.report.entry.content.get("currentChartFields")||[],placeholder:e("type in field name(s)").t()});this.options.controls=[t],n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/AxisEnabledControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=this.options.label||e("Enabled").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting."+this.options.axisType+".enabled",model:this.model,className:"btn-group",items:[{label:e("Off").t(),value:"0"},{label:e("On").t(),value:"1"}]},n.prototype.initialize.call(this,this.options)}},{X_AXIS:"axisX",Y_AXIS:"axisY",Y_AXIS_2:"axisY2"})}),define("views/shared/vizcontrols/components/ChartOverlay",["underscore","jquery","module","views/Base","views/shared/vizcontrols/custom_controls/OverlayFieldsControlGroup","views/shared/vizcontrols/custom_controls/AxisEnabledControlGroup","views/shared/vizcontrols/custom_controls/AxisTitleControlGroup","views/shared/vizcontrols/custom_controls/AxisScaleControlGroup","views/shared/vizcontrols/custom_controls/AxisIntervalControlGroup","views/shared/vizcontrols/custom_controls/AxisMinValueControlGroup","views/shared/vizcontrols/custom_controls/AxisMaxValueControlGroup","splunk.util"],function(e,t,n,r,i,s,o,u,a,f,l,c){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToYAxisComponents:{line:["overlayFields","enabled","title","scale","interval","min","max"],bar:["overlayFields","enabled","title","scale","interval","min","max"],area:["overlayFields","enabled","title","scale","interval","min","max"],column:["overlayFields","enabled","title","scale","interval","min","max"],scatter:[],pie:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToYAxisComponents[this.model.visualization.get("viz_type")];e.indexOf(n,"overlayFields")>-1&&(this.children.overlayFields=new i({model:{visualization:this.model.visualization,report:this.model.report},controlClass:"controls-block"})),e.indexOf(n,"enabled")>-1&&(this.children.enabled=new s({label:e("View as Axis").t(),model:this.model.visualization,controlClass:"controls-halfblock",axisType:s.Y_AXIS_2})),e.indexOf(n,"title")>-1&&(this.children.title=new o({className:"y-axis-title control-group",model:this.model.visualization,axisType:o.Y_AXIS_2})),e.indexOf(n,"scale")>-1&&(this.children.scale=new u({model:this.model.visualization,className:"scale control-group",controlClass:"controls-thirdblock",supportInherit:!0,axisType:u.Y_AXIS_2})),e.indexOf(n,"interval")>-1&&(this.children.interval=new a({model:this.model.visualization,controlClass:"controls-block",axisType:a.Y_AXIS_2})),e.indexOf(n,"min")>-1&&(this.children.min=new f({model:this.model.visualization,controlClass:"controls-block",axisType:f.Y_AXIS_2})),e.indexOf(n,"max")>-1&&(this.children.max=new l({model:this.model.visualization,controlClass:"controls-block",axisType:l.Y_AXIS_2})),this.model.visualization.get("display.visualizations.charting.axisY2.scale")=="log"&&this.children.interval.$el.hide(),this.model.visualization.on("change:display.visualizations.charting.axisY2.enabled",this.handleSecondAxisEnabled,this),this.model.visualization.on("change:display.visualizations.charting.chart.overlayFields",this.handleOverlayFields,this)},events:{"click .scale button":function(e){this.intervalVal=this.intervalVal||this.model.visualization.get("display.visualizations.charting.axisLabelsY2.majorUnit"),t(e.currentTarget).data("value")=="log"?(this.children.interval.$el.hide(),this.model.visualization.set("display.visualizations.charting.axisLabelsY2.majorUnit","")):(this.children.interval.$el.show(),this.model.visualization.set("display.visualizations.charting.axisLabelsY2.majorUnit",this.intervalVal))}},render:function(){return this.children.overlayFields&&this.children.overlayFields.render().appendTo(this.$el),this.children.enabled&&this.children.enabled.render().appendTo(this.$el),this.children.title&&this.children.title.render().appendTo(this.$el),this.children.scale&&this.children.scale.render().appendTo(this.$el),this.children.interval&&this.children.interval.render().appendTo(this.$el),this.children.min&&this.children.min.render().appendTo(this.$el),this.children.max&&this.children.max.render().appendTo(this.$el),this.handleSecondAxisEnabled(),this.handleOverlayFields(),this},handleSecondAxisEnabled:function(){var e=c.normalizeBoolean(this.model.visualization.get("display.visualizations.charting.axisY2.enabled"));e?(this.children.title.enable(),this.children.scale.enable(),this.children.interval.enable(),this.children.min.enable(),this.children.max.enable()):(this.children.title.disable(),this.children.scale.disable(),this.children.interval.disable(),this.children.min.disable(),this.children.max.disable())},handleOverlayFields:function(){this.model.visualization.get("display.visualizations.charting.chart.overlayFields")?this.children.enabled.enable():this.children.enabled.disable()}})}),define("views/shared/vizcontrols/custom_controls/LegendPlacementControlGroup",["jquery","underscore","module","views/shared/controls/ControlGroup"],function(e,t,n,r){return r.extend({moduleId:n.id,initialize:function(){this.options.label=this.options.label||t("Position").t(),this.options.controlType="SyntheticSelect",this.options.controlOptions={modelAttribute:"display.visualizations.charting.legend.placement",model:this.model,popdownOptions:this.options.popdownOptions,items:[{label:t("Right").t(),value:"right"},{label:t("Bottom").t(),value:"bottom"},{label:t("Left").t(),value:"left"},{label:t("Top").t(),value:"top"},{label:t("None").t(),value:"none"}],toggleClassName:"btn"},r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/LegendTruncationControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=this.options.label||e("Truncation").t(),this.options.controlType="SyntheticRadio",this.options.controlOptions={modelAttribute:"display.visualizations.charting.legend.labelStyle.overflowMode",model:this.model,className:"btn-group",items:[{label:e("A...").t(),value:"ellipsisEnd",tooltip:e("Truncate End").t()},{label:e("A...Z").t(),value:"ellipsisMiddle",tooltip:e("Truncate Middle").t()},{label:e("...Z").t(),value:"ellipsisStart",tooltip:e("Truncate Start").t()}]},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/Legend",["underscore","jquery","module","views/Base","views/shared/vizcontrols/custom_controls/LegendPlacementControlGroup","views/shared/vizcontrols/custom_controls/LegendTruncationControlGroup"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,className:"form form-horizontal",vizToLegendComponents:{line:["placement","truncation"],bar:["placement","truncation"],area:["placement","truncation"],column:["placement","truncation"],scatter:["placement","truncation"],pie:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],events:[],statistics:[]},initialize:function(t){r.prototype.initialize.apply(this,arguments);var n=this.vizToLegendComponents[this.model.get("viz_type")];e.indexOf(n,"placement")>-1&&(this.children.placement=new i({model:this.model,controlClass:"controls-block"})),e.indexOf(n,"truncation")>-1&&(this.children.truncation=new s({model:this.model,controlClass:"controls-thirdblock"}))},render:function(){return this.children.placement&&this.children.placement.render().appendTo(this.$el),this.children.truncation&&this.children.truncation.render().appendTo(this.$el),this}})}),define("views/shared/vizcontrols/custom_controls/GaugeAutoRangesControlGroup",["underscore","module","models/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticRadioControl"],function(e,t,n,r,i){var s=i.extend({initialize:function(){this.vizModel=this.options.vizModel,this.model.set({autoMode:this.vizModel.gaugeIsInAutoMode()?"1":"0"}),this.options.modelAttribute="autoMode",this.options.items=[{label:e("Automatic").t(),value:"1",tooltip:e("Uses base search to set color ranges.").t()},{label:e("Manual").t(),value:"0",tooltip:e("Manually set color ranges. Overrides search settings.").t()}],this._ranges='["0", "30", "70", "100"]',this._colors="[0x84E900, 0xFFE800, 0xBF3030]",this.model.on("change:autoMode",this.handleModeChange,this),i.prototype.initialize.call(this,this.options)},handleModeChange:function(){var e=this.model.get("autoMode")==="1";e?(this._ranges=this.vizModel.get("display.visualizations.charting.chart.rangeValues"),this._colors=this.vizModel.get("display.visualizations.charting.gaugeColors"),this.vizModel.set({"display.visualizations.charting.chart.rangeValues":"","display.visualizations.charting.gaugeColors":""})):this.vizModel.set({"display.visualizations.charting.chart.rangeValues":this._ranges,"display.visualizations.charting.gaugeColors":this._colors})}});return r.extend({moduleId:t.id,initialize:function(){var e=new s({model:this.model,vizModel:this.options.vizModel});this.options.controlClass="controls-halfblock",this.options.controls=[e],r.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/color/ColorPicker",["underscore","jquery","module","views/shared/PopTart"],function(e,t,n,r){var i=["#7e9f44","#ebe42d","#d13b3b","#6cb8ca","#f7912c","#956e96","#c2da8a","#fac61d","#ebb7d0","#324969","#d85e3d","#a04558"];return r.extend({moduleId:n.id,className:"popdown-dialog color-picker-container",initialize:function(){r.prototype.initialize.apply(this,arguments),this.clone=this.model.clone(),this.on("shown",function(){this.$(".swatch").first().focus()})},events:{"click .swatch":function(e){var n=t(e.currentTarget).data().color,r="0x"+n.substring(1);this.clone.set({color:r}),this.$(".swatch-hex input").val(n.substring(1)),this.$(".big-swatch").css("background-color",n),e.preventDefault()},"click .color-picker-apply":function(e){this.model.set({color:this.clone.get("color"),shadedcolor:this.options.shadeColor(this.clone.get("color").substring(2),-40)}),this.model.trigger("color-picker-apply",this.options.index),this.hide(),e.stopPropagation()},"click .color-picker-cancel":function(e){this.hide(),e.stopPropagation()},"keyup .hex-input":function(e){var n=t(e.currentTarget).val();this.clone.set("color","0x"+n),this.$(".big-swatch").css("background-color","#"+n),e.preventDefault()}},render:function(){this.$el.html(r.prototype.template),this.$el.append(this._buttonTemplate),this.$(".popdown-dialog-body").addClass("color-picker-content");var e=t('<div class="clearfix"></div>').appendTo(this.$(".popdown-dialog-body"));e.append(this.compiledTemplate({model:this.clone,colors:i}))},template:'                <div class="swatches">                    <ul class="swatch-holder unstyled">                        <% _(colors).each(function(color) { %>                            <li>                                <a href="#" class="swatch" data-color="<%= color %>" style="background-color: <%= color %>"></a>                            </li>                        <% }) %>                    </ul>                </div>                <div class="big-swatch" data-color="<%- model.get("color").substring(2) %>" style="background-color: #<%- model.get("color").substring(2) %>;"></div>                <div class="swatch-hex">                    <div class="input-prepend views-shared-controls-textcontrol">                        <span class="add-on">#</span>                        <input type="text" class="hex-input" value="<%-model.get("color").substring(2) %>">                    </div>                </div>            ',_buttonTemplate:'                <div class="popdown-dialog-footer color-picker-buttons clearfix">                    <a href="#" class="color-picker-cancel btn pull-left">'+e("Cancel").t()+'</a>                    <a href="#" class="color-picker-apply btn btn-primary pull-right"> '+e("Apply").t()+"</a>                </div>            "})}),define("views/shared/vizcontrols/components/color/Ranges",["underscore","jquery","module","views/Base","views/shared/vizcontrols/components/color/ColorPicker","collections/Base"],function(e,t,n,r,i,s){return r.extend({className:"tab-pane clearfix",moduleId:n.id,palette:["0x7e9f44","0xebe42d","0xd13b3b","0x6cb8ca","0xf7912c","0x956e96","0xc2da8a","0xfac61d","0xebb7d0","0x324969","0xd85e3d","0xa04558"],initialize:function(){r.prototype.initialize.apply(this,arguments),this.collection={},this.collection.rows=new s,this.initRowsFromModel(),this.collection.rows.on("add remove color-picker-apply",function(){this.syncModel(),this.render()},this),this.collection.rows.on("change",this.syncModel,this)},initRowsFromModel:function(){var t=this.model.rangesValuesToArray(),n=t.length>0?t:["0","30","70","100"],r=this.model.deserializeGaugeColorArray(),i=r.length>0?r:["0x84E900","0xFFE800","0xBF3030"];e(n).each(function(e,t){var r=i[t-1]||i[i.length-1];this.collection.rows.push({value:e,nextValue:n[t+1],color:t!=0?r:void 0,shadedcolor:t!=0?this.shadeColor(r,-40):void 0})},this)},syncModel:function(){this.model.set({"display.visualizations.charting.chart.rangeValues":JSON.stringify(this.collection.rows.pluck("value")),"display.visualizations.charting.gaugeColors":"["+e(this.collection.rows.pluck("color")).filter(function(t){return!e.isUndefined(t)}).join(",")+"]"})},events:{"click .add-color-range":function(e){var t=this.palette[Math.floor(Math.random()*12)];this.collection.rows.push({value:this.options.prepopulateNewRanges?parseInt(this.collection.rows.last().get("value"),10)*2:"",nextValue:"",color:t,shadedcolor:this.shadeColor(t,-40)}),e.preventDefault(),e.stopPropagation()},"keyup .range-value":e.debounce(function(e){var n=t(e.currentTarget),r=n.data().index;this.collection.rows.at(r).set("value",t.trim(n.val()));var i=this.$el.find('[data-prev="'+r+'"]').children().eq(0);i&&i.text((parseInt(n.val(),10)||"")+" "),e.preventDefault()},300),"click .color-square":function(e){var n=t(e.currentTarget),r=n.css("background-color");this.children.colorPicker=new i({model:this.collection.rows.at(n.parent().siblings("input").data().index),shadeColor:this.shadeColor,onHiddenRemove:!0}),this.children.colorPicker.render().appendTo(t("body")),this.children.colorPicker.show(n),e.preventDefault()},"click .remove-range":function(e){var n=t(e.currentTarget).siblings("input").data().index;this.collection.rows.remove(this.collection.rows.at(n)),e.stopPropagation()}},shadeColor:function(e,t){var n=parseInt(e,16),r=(n&16711680)>>16,i=(n&65280)>>8,s=(n&255)>>0;return r+=Math.floor(t/255*r),i+=Math.floor(t/255*i),s+=Math.floor(t/255*s),((r<<16)+(i<<8)+s).toString(16)},render:function(){return this.model.gaugeIsInAutoMode()||this.syncModel(),this.$el.html(this.compiledTemplate({_:e,collection:this.collection.rows})),this},template:'                <div class="color-rows form-horizontal">                    <div class="from-color-group">                        <div class="control-group">                            <label class="lower-range-label control-label"><%- _("from").t() %></label>                            <div class="controls">                                <input class="first-row-lower range-value" value="<%- collection.at(0).get("value") %>" data-index=0 type="text">                            </div>                        </div>                    </div>                    <div class="to-color-group">                        <div class="control-group">                            <label class="control-label upper-range-label to-label"><%- _("to").t() %></label>                            <div class="controls right-input">                                <div class="input-append">                                    <input  class="first-row-upper range-value" value="<%- collection.at(1).get("value") %>" data-index=1 type="text">                                    <div class="add-on color-picker-add-on">                                        <a href="#" class="color-square" style="border-color: #<%- collection.at(1).get("shadedcolor")%>; background-color: #<%- collection.at(1).get("color").substring(2) %>;"></a>                                    </div>                                </div>                            </div>                        </div>                    </div>                    <% collection.each(function(model, i) { %>                        <% if(!(i==0 || i==1)) {%>                            <div class="extra-color-group">                                <div class="control-group">                                    <label class="upper-range-label control-label" data-prev="<%- i-1 %>">                                        <span class "value"><%- (parseInt(collection.at(i-1).get("value"))) || "" %> </span>                                        <span class="label-to"><%- _("to").t() %></span>                                    </label>                                    <div class="controls input-append">                                        <input  class="range-value" value="<%- model.get("value") %>" data-index=<%-i%> type="text">                                        <div class="add-on color-picker-add-on">                                            <a href="#" class="color-square" style="border-color: #<%- model.get("shadedcolor")%>; background-color: #<%- model.get("color").substring(2) %>;"></a>                                        </div>                                        <a class="remove-range btn-link" href="#"><i class="icon-x-circle"></i></a>                                    </div>                                </div>                            </div>                        <% } %>                    <% }); %>                </div>                <a href="#" class="add-color-range btn pull-right"> + <%- _("Add Range").t() %></a>            '})}),define("views/shared/vizcontrols/components/color/Master",["underscore","jquery","module","splunk.util","models/Base","views/Base","views/shared/controls/ControlGroup","views/shared/vizcontrols/custom_controls/GaugeAutoRangesControlGroup","views/shared/vizcontrols/components/color/Ranges"],function(e,t,n,r,i,s,o,u,a){return s.extend({moduleId:n.id,className:" form form-horizontal",controlClass:"controls-halfblock",vizToColorRangeComponents:{line:[],area:[],column:[],bar:[],pie:[],scatter:[],radialGauge:["range"],fillerGauge:["range"],markerGauge:["range"],single:[],events:[],statistics:[]},initialize:function(t){s.prototype.initialize.apply(this,arguments);var n=this.vizToColorRangeComponents[this.model.get("viz_type")];e.indexOf(n,"range")>-1&&(this.autoModeModel=new i,this.children.toggle=new u({model:this.autoModeModel,vizModel:this.model}),this.autoModeModel.on("change:autoMode",this.updateRangesVisibility,this)),this.children.colorRanges=new a({model:this.model})},render:function(){return this.children.toggle&&this.children.toggle.render().appendTo(this.$el),this.children.colorRanges.render().appendTo(this.$el),this.updateRangesVisibility(),this},remove:function(){this.autoModeModel.off(null,null,this)},updateRangesVisibility:function(){this.autoModeModel.get("autoMode")==="1"?this.children.colorRanges.$el.hide():this.children.colorRanges.$el.show()}})}),define("views/shared/vizcontrols/components/Statistics",["underscore","module","views/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticSelectControl"],function(e,t,n,r,i){return n.extend({moduleId:t.id,className:"form form-horizontal",initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.drillDown=new r({label:e("Drilldown").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group",items:[{value:"row",label:e("Row").t()},{value:"cell",label:e("Cell").t()},{value:"none",label:e("None").t()}],model:this.model,modelAttribute:"display.statistics.drilldown"}}),this.children.rowNumbers=new r({label:e("Row Numbers").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.statistics.rowNumbers"}}),this.children.wrapResults=new r({label:e("Wrap Results").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.statistics.wrap"}}),this.children.dataOverlay=new r({label:e("Data Overlay").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",items:[{value:"none",label:e("None").t()},{value:"heatmap",label:e("Heat map").t()},{value:"highlow",label:e("High and low values").t()}],modelAttribute:"display.statistics.overlay",toggleClassName:"btn"}}),this.model.get("dashboard")&&(this.children.count=new r({label:e("Rows Per Page").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",modelAttribute:"display.prefs.statistics.count"}}))},render:function(){return this.$el.html(""),this.children.wrapResults.render().appendTo(this.$el),this.children.rowNumbers.render().appendTo(this.$el),this.children.drillDown.render().appendTo(this.$el),this.children.dataOverlay.render().appendTo(this.$el),this.children.count&&this.children.count.render().appendTo(this.$el),this}})}),define("views/shared/vizcontrols/components/Events",["underscore","module","views/Base","views/shared/controls/ControlGroup"],function(e,t,n,r){return n.extend({moduleId:t.id,className:"form form-horizontal",initialize:function(){n.prototype.initialize.apply(this,arguments),this.showEventType=this.options.showEventType===!1?!1:!0,this.showDrilldown=this.options.showDrilldown===!1?!1:!0,this.showEventType&&(this.children.eventType=new r({label:e("Display").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group",items:[{label:e("Raw").t(),value:"raw"},{label:e("List").t(),value:"list"},{label:e("Table").t(),value:"table"}],model:this.model,modelAttribute:"display.events.type"}})),this.children.rowNumbers=new r({label:e("Row Numbers").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.events.rowNumbers"}}),this.children.wrapResultsList=new r({label:e("Wrap Results").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.events.list.wrap"}}),this.children.wrapResultsTable=new r({label:e("Wrap Results").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("Yes").t()},{value:"0",label:e("No").t()}],model:this.model,modelAttribute:"display.events.table.wrap"}}),this.children.maxlines=new r({label:e("Max Lines").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",items:[{value:"5",label:e("5 lines").t()},{value:"10",label:e("10 lines").t()},{value:"20",label:e("20 lines").t()},{value:"50",label:e("50 lines").t()},{value:"100",label:e("100 lines").t()},{value:"200",label:e("200 lines").t()},{value:"0",label:e("All lines").t()}],modelAttribute:"display.events.maxLines",toggleClassName:"btn",nearestValue:!0}}),this.showDrilldown&&(this.children.drilldownRaw=new r({label:e("Drilldown").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{menuWidth:"narrow",toggleClassName:"btn",items:[{value:"none",label:e("None").t()},{value:"inner",label:e("Inner").t()},{value:"outer",label:e("Outer").t()},{value:"full",label:e("Full").t()}],model:this.model,modelAttribute:"display.events.raw.drilldown"}}),this.children.drilldownList=new r({label:e("Drilldown").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{menuWidth:"narrow",toggleClassName:"btn",items:[{value:"none",label:e("None").t()},{value:"inner",label:e("Inner").t()},{value:"outer",label:e("Outer").t()},{value:"full",label:e("Full").t()}],model:this.model,modelAttribute:"display.events.list.drilldown"}}),this.children.drilldownTable=new r({label:e("Drilldown").t(),controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group",items:[{value:"1",label:e("On").t()},{value:"0",label:e("Off").t()}],model:this.model,modelAttribute:"display.events.table.drilldown"}})),this.model.get("dashboard")&&(this.children.count=new r({label:e("Rows Per Page").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model,menuWidth:"narrow",modelAttribute:"display.prefs.events.count"}})),this.activate()},startListening:function(){this.listenTo(this.model,"change:display.events.type",this.visibility),this.showDrilldown&&this.listenTo(this.model,"change:display.events.list.drilldown change:display.events.raw.drilldown",this.mediateDrilldown),this.listenTo(this.model,"change:display.events.list.wrap change:display.events.table.wrap",this.mediateWrap)},mediateDrilldown:function(){this.model.get("display.events.type")==="list"?this.model.set("display.events.raw.drilldown",this.model.get("display.events.list.drilldown")):this.model.set("display.events.list.drilldown",this.model.get("display.events.raw.drilldown"))},mediateWrap:function(){this.model.get("display.events.type")==="list"?this.model.set("display.events.table.wrap",this.model.get("display.events.list.wrap")):this.model.set("display.events.list.wrap",this.model.get("display.events.table.wrap"))},visibility:function(){switch(this.model.get("display.events.type")){case"list":this.children.wrapResultsList.$el.show(),this.children.wrapResultsTable.$el.hide(),this.children.rowNumbers.$el.show(),this.showDrilldown&&(this.children.drilldownList.$el.show(),this.children.drilldownRaw.$el.hide(),this.children.drilldownTable.$el.hide());break;case"raw":this.children.wrapResultsList.$el.hide(),this.children.wrapResultsTable.$el.hide(),this.children.rowNumbers.$el.hide(),this.showDrilldown&&(this.children.drilldownList.$el.hide(),this.children.drilldownRaw.$el.show(),this.children.drilldownTable.$el.hide());break;case"table":this.children.wrapResultsList.$el.hide(),this.children.wrapResultsTable.$el.show(),this.children.rowNumbers.$el.show(),this.showDrilldown&&(this.children.drilldownList.$el.hide(),this.children.drilldownRaw.$el.hide(),this.children.drilldownTable.$el.show());break;default:}},render:function(){return this.showEventType&&this.children.eventType.render().appendTo(this.$el),this.children.rowNumbers.render().appendTo(this.$el),this.children.wrapResultsList.render().appendTo(this.$el),this.children.wrapResultsTable.render().appendTo(this.$el),this.children.maxlines.render().appendTo(this.$el),this.showDrilldown&&(this.children.drilldownList.render().appendTo(this.$el),this.children.drilldownRaw.render().appendTo(this.$el),this.children.drilldownTable.render().appendTo(this.$el)),this.children.count&&this.children.count.render().appendTo(this.$el),this.visibility(),this}})}),define("views/shared/vizcontrols/custom_controls/MapCenterControlGroup",["underscore","module","views/shared/controls/ControlGroup","views/shared/controls/TextControl"],function(e,t,n,r){var i=/^\(([^,\s]*)\s*,\s*([^,\s]*)\)$/,s=r.extend({setValueFromModel:function(e){var t=this.readLatLon();return this._setValue(this.options.mode===o.LATITUDE?t.lat:t.lon,e),this},getUpdatedModelAttributes:function(){var e=this.readLatLon(),t={};return this.options.mode===o.LATITUDE?e.lat=this._value:e.lon=this._value,t[this.getModelAttribute()]="("+e.lat+","+e.lon+")",t},readLatLon:function(){var e=i.exec(this.model.get(this.getModelAttribute()));return!e||e.length<3?{lat:0,lon:0}:{lat:e[1],lon:e[2]}}}),o=n.extend({moduleId:t.id,initialize:function(){this.options.label=this.options.mode===o.LATITUDE?e("Latitude").t():e("Longitude").t(),this.options.controls=[new s({model:this.model,modelAttribute:"display.visualizations.mapping.map.center",mode:this.options.mode,inputClassName:"input-medium"})],n.prototype.initialize.call(this,this.options)}},{LATITUDE:"latitude",LONGITUDE:"longitude"});return o}),define("views/shared/vizcontrols/custom_controls/MapZoomControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Zoom").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.map.zoom",model:this.model,inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/Map",["underscore","module","views/Base","views/shared/vizcontrols/custom_controls/MapCenterControlGroup","views/shared/vizcontrols/custom_controls/MapZoomControlGroup","util/console"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,className:"form form-horizontal",events:{"click .populate-button":function(e){e.preventDefault();var t=function(e){return Math.round(e*100)/100},n=this.model.report.entry.content,r=n.get("currentMapCenter"),i="("+t(r.lat)+","+t(r.lon)+")";this.model.visualization.set({"display.visualizations.mapping.map.zoom":n.get("currentMapZoom"),"display.visualizations.mapping.map.center":i})}},vizToGeneralComponents:{line:[],area:[],column:[],bar:[],pie:[],scatter:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],mapping:["centerLat","centerLon","zoom"]},initialize:function(){n.prototype.initialize.apply(this,arguments);var t=this.vizToGeneralComponents[this.model.visualization.get("viz_type")];e.contains(t,"centerLat")&&(this.children.centerLat=new r({model:this.model.visualization,mode:r.LATITUDE})),e.contains(t,"centerLon")&&(this.children.centerLon=new r({model:this.model.visualization,mode:r.LONGITUDE})),e.contains(t,"zoom")&&(this.children.zoom=new i({model:this.model.visualization}))},render:function(){this.children.centerLat&&this.children.centerLat.render().appendTo(this.$el),this.children.centerLon&&this.children.centerLon.render().appendTo(this.$el),this.children.zoom&&this.children.zoom.render().appendTo(this.$el);var e=this.model.report.entry.content;return e.has("currentMapZoom")&&e.has("currentMapCenter")?this.$el.append(this.compiledTemplate()):s.warn("report content does not have current map zoom and center, disabling populate button"),this},template:'            <div class="populate-button-container">                <a href="#" class="populate-button"><%- _("Populate with current map settings").t() %></a>            </div>        '})}),define("views/shared/controls/PercentTextControl",["jquery","underscore","module","views/shared/controls/TextControl","util/math_utils"],function(e,t,n,r,i){return r.extend({initialize:function(){this.options=e.extend({append:t('<span class="add-on"><%- _("%").t() %></span>').template({}),inputClassName:"input-mini"},this.options),r.prototype.initialize.call(this,this.options)},setValueFromModel:function(e){var n=this.model.get(this.getModelAttribute()),r=i.strictParseFloat((i.strictParseFloat(n)*100).toPrecision(12));return this._setValue(t.isNaN(r)?n:r,e),this},getUpdatedModelAttributes:function(){var e=r.prototype.getUpdatedModelAttributes.apply(this,arguments),n=e[this.getModelAttribute()],s=i.strictParseFloat(e[this.getModelAttribute()])/100;return e[this.getModelAttribute()]=t.isNaN(s)?n:s,e}})}),define("views/shared/vizcontrols/custom_controls/MapMarkerOpacityControlGroup",["jquery","underscore","module","views/shared/controls/PercentTextControl","views/shared/controls/ControlGroup"],function(e,t,n,r,i){return i.extend({moduleId:n.id,initialize:function(){this.options.label=t("Opacity").t(),this.options.controls=[new r({model:this.model,modelAttribute:"display.visualizations.mapping.markerLayer.markerOpacity"})],i.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MapMarkerMinSizeControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Min Size").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.markerLayer.markerMinSize",model:this.model,inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MapMarkerMaxSizeControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Max Size").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.markerLayer.markerMaxSize",model:this.model,inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MapMarkerMaxClustersControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Max Clusters").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.data.maxClusters",model:this.model,inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/Markers",["underscore","module","views/Base","views/shared/vizcontrols/custom_controls/MapMarkerOpacityControlGroup","views/shared/vizcontrols/custom_controls/MapMarkerMinSizeControlGroup","views/shared/vizcontrols/custom_controls/MapMarkerMaxSizeControlGroup","views/shared/vizcontrols/custom_controls/MapMarkerMaxClustersControlGroup"],function(e,t,n,r,i,s,o){return n.extend({moduleId:t.id,className:"form form-horizontal",vizToGeneralComponents:{line:[],area:[],column:[],bar:[],pie:[],scatter:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],mapping:["opacity","minSize","maxSize","maxClusters"]},initialize:function(){n.prototype.initialize.apply(this,arguments);var t=this.vizToGeneralComponents[this.model.get("viz_type")];e.contains(t,"opacity")&&(this.children.opacity=new r({model:this.model})),e.contains(t,"minSize")&&(this.children.minSize=new i({model:this.model})),e.contains(t,"maxSize")&&(this.children.maxSize=new s({model:this.model})),e.contains(t,"maxClusters")&&(this.children.maxClusters=new o({model:this.model}))},render:function(){return this.children.opacity&&this.children.opacity.render().appendTo(this.$el),this.children.minSize&&this.children.minSize.render().appendTo(this.$el),this.children.maxSize&&this.children.maxSize.render().appendTo(this.$el),this.children.maxClusters&&this.children.maxClusters.render().appendTo(this.$el),this}})}),define("views/shared/DropDownMenu",["jquery","underscore","views/Base","views/shared/delegates/Popdown","util/keyboard","module"],function(e,t,n,r,i,s){return n.extend({moduleId:s.id,DEFAULT_CLASS_NAME:"btn-group pull-right",DEFAULT_ANCHOR_CLASS_NAME:"btn",initialize:function(t){n.prototype.initialize.call(this,t),t=t||{},this.$el.addClass(t.hasOwnProperty("className")?t.className:this.DEFAULT_CLASS_NAME),this.anchorClassName=t.hasOwnProperty("anchorClassName")?t.anchorClassName:this.DEFAULT_ANCHOR_CLASS_NAME,this.options.popdownOptions=e.extend(!0,{el:this.el,attachDialogTo:"body"},this.options.popdownOptions)},setItems:function(e){this.options.items=e,this.debouncedRender()},render:function(){this.children.popdown&&this.children.popdown.remove();var e=t(this.template).template({options:this.options,useNestedArrays:this.isArrayofArrays(this.options.items)});return this.$el.html(e),this.$(".dropdown-toggle").addClass(this.anchorClassName),this.$drowdownMenu=this.$(".dropdown-menu"),this.$drowdownMenu.on("click","ul > li > a:not(.disabled)",t(this.handleItemClick).bind(this)),this.$drowdownMenu.on("keydown",t(function(e){e.which===i.KEYS.ESCAPE&&(this.children.popdown.hide(),e.stopPropagation())}).bind(this)),this.children.popdown=new r(this.options.popdownOptions),this.children.popdown.on("shown",function(){this.$drowdownMenu.find("a[data-value]:not(.disabled)").first().focus()},this),this.children.popdown.on("hidden",function(){this.$(".dropdown-toggle").focus()},this),this},isArrayofArrays:function(e){return t(e).isArray()&&e.length>0&&t(e[0]).isArray()?!0:!1},handleItemClick:function(t){t.preventDefault();var n=e(t.currentTarget),r=n.attr("data-value"),i=parseInt(n.attr("data-item-index"),10);if(this.isArrayofArrays(this.options.items)){var s=parseInt(n.attr("data-items-array-index"),10);this.trigger("itemClicked",r,this.options.items[s][i])}else this.trigger("itemClicked",r,this.options.items[i])},template:'            <a class="dropdown-toggle" href="#">                <% if (options.labelIcon) { %><i class="icon-<%- options.labelIcon %> icon-large"></i><% } %><span class="link-label"><%- options.label %></span><span class="caret"></span>            </a>            <div class="dropdown-menu <%- options.dropdownClassName || \'\' %>">                <div class="arrow"></div>                <% if (useNestedArrays) { %>                    <% _(options.items).each(function(itemsChild, i) { %>                    <ul>                        <% _(itemsChild).each(function(object, j) { %>                            <li>                                <a href="#" data-value="<%- object.value %>" data-items-array-index="<%- i %>" data-item-index="<%- j %>"                                     <% if(object.enabled === false) {%>                                        class="disabled"                                    <% } %>                                >                                    <% if (object.icon) { %>                                         <i class="icon-<%- object.icon %> icon-large"></i>                                    <% } %>                                    <%- object.label %>                                </a>                            </li>                        <% }) %>                    </ul>                    <% }) %>                <% } else { %>                    <ul>                        <% _(options.items).each(function(object, k) { %>                            <li>                                <a href="#" data-value="<%- object.value %>" data-item-index="<%- k %>"                                     <% if(object.enabled === false) {%>                                        class="disabled"                                    <% } %>                                    >                                    <% if (object.icon) { %>                                         <i class="icon-<%- object.icon %> icon-large"></i>                                    <% } %>                                    <%- object.label %>                                </a>                            </li>                        <% }) %>                    </ul>               <% } %>            </div>        '})}),define("views/shared/vizcontrols/custom_controls/MapTileUrlControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Url").t(),this.options.controlType="Textarea",this.options.help=e("The URL to use for requesting tiles, ex: <br /> http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").t(),this.options.controlOptions={modelAttribute:"display.visualizations.mapping.tileLayer.url",model:this.model,className:"control controls-block"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MapTileMinZoomControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Min Zoom").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.tileLayer.minZoom",model:this.model,inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/custom_controls/MapTileMaxZoomControlGroup",["underscore","module","views/shared/controls/ControlGroup"],function(e,t,n){return n.extend({moduleId:t.id,initialize:function(){this.options.label=e("Max Zoom").t(),this.options.controlType="Text",this.options.controlOptions={modelAttribute:"display.visualizations.mapping.tileLayer.maxZoom",model:this.model,inputClassName:"input-medium"},n.prototype.initialize.call(this,this.options)}})}),define("views/shared/vizcontrols/components/Tiles",["underscore","module","views/Base","views/shared/DropDownMenu","views/shared/vizcontrols/custom_controls/MapTileUrlControlGroup","views/shared/vizcontrols/custom_controls/MapTileMinZoomControlGroup","views/shared/vizcontrols/custom_controls/MapTileMaxZoomControlGroup"],function(e,t,n,r,i,s,o){return n.extend({moduleId:t.id,className:"form form-horizontal",vizToGeneralComponents:{line:[],area:[],column:[],bar:[],pie:[],scatter:[],radialGauge:[],fillerGauge:[],markerGauge:[],single:[],mapping:["url","minZoom","maxZoom"]},initialize:function(){n.prototype.initialize.apply(this,arguments);var t=this.vizToGeneralComponents[this.model.get("viz_type")];e.contains(t,"url")&&(this.children.url=new i({model:this.model})),e.contains(t,"minZoom")&&(this.children.minZoom=new s({model:this.model})),e.contains(t,"maxZoom")&&(this.children.maxZoom=new o({model:this.model})),this.children.tilePresetsMenu=new r({label:e("Populate from preset configuration").t(),className:"",dropdownClassName:"dropdown-menu-narrow",anchorClassName:"btn-pill",popdownOptions:{attachDialogTo:"body"},items:[{label:e("Splunk Tiles").t(),value:"splunk",url:"",minZoom:"0",maxZoom:"7"},{label:e("Open Street Map").t(),value:"osm",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",minZoom:"0",maxZoom:"19"}]}),this.listenTo(this.children.tilePresetsMenu,"itemClicked",function(e,t){this.model.set({"display.visualizations.mapping.tileLayer.url":t.url,"display.visualizations.mapping.tileLayer.minZoom":t.minZoom,"display.visualizations.mapping.tileLayer.maxZoom":t.maxZoom})})},render:function(){return this.children.url&&this.children.url.render().appendTo(this.$el),this.children.minZoom&&this.children.minZoom.render().appendTo(this.$el),this.children.maxZoom&&this.children.maxZoom.render().appendTo(this.$el),this.$el.append(this.compiledTemplate()),this.children.tilePresetsMenu.render().appendTo(this.$(".populate-button-container")),this},template:'            <div class="populate-button-container"></div>        '})}),define("views/shared/vizcontrols/components/Master",["underscore","jquery","module","views/Base","views/shared/FlashMessages","views/shared/vizcontrols/components/General","views/shared/vizcontrols/components/XAxis","views/shared/vizcontrols/components/YAxis","views/shared/vizcontrols/components/ChartOverlay","views/shared/vizcontrols/components/Legend","views/shared/vizcontrols/components/color/Master","views/shared/vizcontrols/components/Statistics","views/shared/vizcontrols/components/Events","views/shared/vizcontrols/components/Map","views/shared/vizcontrols/components/Markers","views/shared/vizcontrols/components/Tiles"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){return r.extend({moduleId:n.id,className:"tabbable ",events:{"click a[data-toggle]":function(n){var r=t(n.currentTarget),i=r.data().type;e(this.children).each(function(e){e.$el.hide()},this),this.children[i].$el.show(),this.$el.find(".nav > li").removeClass("active"),r.parent().addClass("active"),n.preventDefault()}},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.children.flashMessages=new i({model:this.model.visualization}),this.vizType=this.model.visualization.get("viz_type"),this.hasTabType("gen")?this.children.general=new s({model:this.model.visualization}):this.hasTabType("statistics")?this.children.general=new c({model:this.model.visualization}):this.hasTabType("events")&&(this.children.general=new h({model:this.model.visualization})),this.hasTabType("x")&&(this.children.xaxis=new o({model:this.model.visualization})),this.hasTabType("y")&&(this.children.yaxis=new u({model:this.model.visualization})),this.hasTabType("overlay")&&(this.children.overlay=new a({model:{visualization:this.model.visualization,report:this.model.report}})),this.hasTabType("leg")&&(this.children.legend=new f({model:this.model.visualization})),this.hasTabType("ranges")&&(this.children.ranges=new l({model:this.model.visualization})),this.hasTabType("map")&&(this.children.map=new p({model:{visualization:this.model.visualization,report:this.model.report}})),this.hasTabType("markers")&&(this.children.markers=new d({model:this.model.visualization})),this.hasTabType("tiles")&&(this.children.tiles=new v({model:this.model.visualization}))},render:function(){return this.$el.html(e(this.template).template({hasTabType:e(this.hasTabType).bind(this)})),this.children.flashMessages.render().prependTo(this.$(".tab-content")),e(this.children).each(function(e){this.$(".tab-content").append(e.render().el),e.$el.hide()},this),this.children.general.$el.show(),this},hasTabType:function(t){return e.contains(this.model.visualization.components[this.vizType],t)},template:'                <ul class="nav nav-tabs-left">                    <% if(hasTabType("gen") || hasTabType("statistics") || hasTabType("events")) { %>                        <li class="active">                            <a href="#" data-toggle="tab" data-type="general"><%- _("General").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("x")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="xaxis"><%- _("X-Axis").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("y")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="yaxis"><%- _("Y-Axis").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("overlay")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="overlay"><%- _("Chart Overlay").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("leg")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="legend"><%- _("Legend").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("ranges")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="ranges"><%- _("Color Ranges").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("map")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="map"><%- _("Map").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("markers")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="markers"><%- _("Markers").t() %></a>                        </li>                    <% } %>                    <% if(hasTabType("tiles")) { %>                        <li>                            <a href="#" data-toggle="tab" data-type="tiles"><%- _("Tiles").t() %></a>                        </li>                    <% } %>                </ul>                <div class="tab-content"></div>            '})}),define("views/shared/vizcontrols/Format",["underscore","jquery","module","views/shared/PopTart","views/shared/vizcontrols/components/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,options:{saveOnApply:!1},initialize:function(e){r.prototype.initialize.apply(this,arguments),this.children.visualizationControls&&this.children.visualizationControls.remove(),this.children.visualizationControls=new i({model:{visualization:this.model.visualization,report:this.model.report}})},events:{"click .viz-editor-apply":function(e){e.preventDefault(),this.applyChanges()},"click .viz-editor-cancel":function(e){this.hide(),e.preventDefault()},"keypress .viz-editor-apply":function(e){e.preventDefault(),this.applyChanges()},"keypress .viz-editor-cancel":function(e){this.hide(),e.preventDefault()},"keypress input:text":function(e){var n=13,r=t(e.target);e.keyCode==n&&(r.blur(),e.preventDefault(),this.applyChanges())}},applyChanges:function(){this.model.visualization.validate(),this.model.visualization.isValid()&&(this.model.report.entry.content.set(t.extend({},this.model.visualization.toJSON())),this.options.saveOnApply&&this.model.report.save(),this.hide())},render:function(){return this.$el.html(r.prototype.template),this.$el.append(this.template),this.children.visualizationControls.render().appendTo(this.$(".popdown-dialog-body")),this.$(".popdown-dialog-body").removeClass("popdown-dialog-padded"),this},template:'                    <div class="popdown-dialog-footer">                        <a class="viz-editor-cancel btn pull-left" tabindex="0">'+e("Cancel").t()+'</a>                        <a class="viz-editor-apply btn btn-primary pull-right" tabindex="0"> '+e("Apply").t()+"</a>                    </div>            "})}),define("models/shared/Visualization",["jquery","underscore","util/math_utils","models/Base","util/general_utils","splunk.util"],function(e,t,n,r,i,s){var o=n.strictParseFloat,u=r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments),this.on("change:display.visualizations.charting.axisY.scale",function(){this.get("display.visualizations.charting.chart")==="line"&&this.get("display.visualizations.charting.axisY.scale")==="log"&&this.set({"display.visualizations.charting.chart.stackMode":"default"})},this),this.on("change:display.visualizations.charting.chart.overlayFields",function(){this.get("display.visualizations.charting.chart.overlayFields")||this.set({"display.visualizations.charting.axisY2.enabled":"0"})})},components:{single:["gen"],line:["gen","x","y","overlay","leg"],area:["gen","x","y","overlay","leg"],column:["gen","x","y","overlay","leg"],bar:["gen","x","y","overlay","leg"],pie:["gen"],scatter:["gen","x","y","leg"],radialGauge:["gen","ranges"],fillerGauge:["gen","ranges"],markerGauge:["gen","ranges"],statistics:["statistics"],events:["events"],mapping:["gen","map","markers","tiles"]},defaults:{"display.visualizations.charting.axisY.scale":"linear","display.visualizations.charting.axisY2.scale":"inherit","display.visualizations.charting.axisX.scale":"linear","display.visualizations.charting.axisX.minimumNumber":"","display.visualizations.charting.axisX.maximumNumber":"","display.visualizations.charting.axisY.minimumNumber":"","display.visualizations.charting.axisY.maximumNumber":"","display.visualizations.charting.axisTitleX.text":"","display.visualizations.charting.axisTitleY.text":"","display.visualizations.charting.axisLabelsX.majorUnit":"","display.visualizations.charting.axisLabelsY.majorUnit":"","display.visualizations.charting.axisLabelsX.majorLabelStyle.overflowMode":"ellipsisNone","display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation":"0","display.visualizations.charting.legend.placement":"right","display.visualizations.charting.legend.labelStyle.overflowMode":"ellipsisMiddle","display.visualizations.charting.chart.stackMode":"default","display.visualizations.charting.layout.splitSeries":"0","display.visualizations.charting.drilldown":"all","display.visualizations.charting.chart.nullValueMode":"gaps","display.visualizations.charting.chart.sliceCollapsingThreshold":.01,"display.visualizations.charting.chart.rangeValues":'["0","30","70","100"]',"display.visualizations.charting.chart.style":"shiny","display.visualizations.charting.gaugeColors":[8710400,16771072,12529712],"display.visualizations.mapping.drilldown":"all","display.visualizations.mapping.map.center":"(0,0)","display.visualizations.mapping.map.zoom":"2","display.visualizations.mapping.markerLayer.markerOpacity":"0.8","display.visualizations.mapping.markerLayer.markerMinSize":"10","display.visualizations.mapping.markerLayer.markerMaxSize":"50","display.visualizations.mapping.data.maxClusters":"100","display.visualizations.mapping.tileLayer.minZoom":"0","display.visualizations.mapping.tileLayer.maxZoom":"7","display.prefs.events.count":"10","display.prefs.statistics.count":"10","display.events.type":"list","display.events.rowNumbers":"0","display.events.maxLines":"5","display.events.raw.drilldown":"full","display.events.list.drilldown":"full","display.events.list.wrap":"1","display.events.table.drilldown":"1","display.events.table.wrap":"1","display.statistics.drilldown":"cell","display.statistics.rowNumbers":"0","display.statistics.wrap":"1","display.statistics.overlay":"none"},validation:{"display.visualizations.charting.chart.stackMode":[{oneOf:["default","stacked","stacked100"],required:!0,msg:t("Stack Mode must be default, stacked, or stacked100").t()},{fn:"validateYScaleAndStacking"}],"display.visualizations.charting.layout.splitSeries":{fn:"validateBoolean",required:!0},"display.visualizations.charting.drilldown":{oneOf:["all","none"],required:!0,msg:t("Chart Drilldown must be all or none").t()},"display.visualizations.charting.chart.nullValueMode":{oneOf:["zero","connect","gaps"],required:!0,msg:t("Null Value Mode must be zero, connect, or gaps").t()},"display.visualizations.charting.legend.placement":{oneOf:["right","left","top","bottom","none"],required:!0,msg:t("Legend Placement must be right, left, top, bottom, or none").t()},"display.visualizations.charting.legend.labelStyle.overflowMode":{oneOf:["ellipsisMiddle","ellipsisStart","ellipsisEnd"],required:!0,msg:t("Legend Truncation must be ellipsisMiddle, ellipsisStart, or ellipsisEnd").t()},"display.visualizations.charting.axisX.minimumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisX.maximumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateXAxisExtremes",required:!1}],"display.visualizations.charting.axisY.minimumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisY.maximumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateYAxisExtremes",required:!1}],"display.visualizations.charting.axisY2.minimumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateYAxis2Extremes",required:!1}],"display.visualizations.charting.axisY2.maximumNumber":[{fn:"validateNumberOrAuto",required:!1},{fn:"validateYAxis2Extremes",required:!1}],"display.visualizations.charting.axisLabelsX.majorUnit":[{fn:"validatePositiveNumberOrAuto",required:!1}],"display.visualizations.charting.axisLabelsY.majorUnit":[{fn:"validatePositiveNumberOrAuto",required:!1}],"display.visualizations.charting.axisLabelsY2.majorUnit":[{fn:"validatePositiveNumberOrAuto",required:!1}],"display.visualizations.charting.axisLabelsX.majorLabelStyle.rotation":{oneOf:["-90","-45","0","45","90"],required:!0,msg:t("Axis Label Rotation must be -90, -45, 0, 45, or 90").t()},"display.visualizations.charting.axisLabelsX.majorLabelStyle.overflowMode":{oneOf:["ellipsisNone","ellipsisMiddle"],required:!0,msg:t("Axis Label overflow mode must be ellipsisNone or ellipsisMiddle").t()},"display.visualizations.charting.axisY.scale":[{oneOf:["linear","log"],required:!0,msg:t("Y-Axis Scale must be linear or log").t()},{fn:"validateYScaleAndStacking"}],"display.visualizations.charting.axisX.scale":{oneOf:["linear","log"],required:!0,msg:t("X-Axis Scale must be linear or log").t()},"display.visualizations.charting.axisY2.scale":{oneOf:["linear","log","inherit"],required:!0,msg:t("X-Axis Scale must be linear, log, or inherit").t()},"display.visualizations.charting.chart.sliceCollapsingThreshold":{pattern:"number",min:0,msg:t("Minimum Size must be a non-negative number.").t(),required:!0},"display.visualizations.charting.chart.rangeValues":{fn:"validateRangeValues",required:!1},"display.visualizations.charting.chart.style":{oneOf:["shiny","minimal"],required:!0,msg:t("Gauge Style must be shiny or minimal").t()},"display.visualizations.mapping.drilldown":{oneOf:["all","none"],required:!0,msg:t("Drilldown must be all or none").t()},"display.visualizations.mapping.map.center":{pattern:/^\s*\(([-+.0-9]+)\s*,\s*([-+.0-9]+)\)\s*$/,required:!0,msg:t("Latitude and Longitude must be valid numbers").t()},"display.visualizations.mapping.map.zoom":{pattern:"digits",required:!0,min:0,msg:t("Zoom must be a non-negative integer").t()},"display.visualizations.mapping.markerLayer.markerOpacity":{pattern:"number",required:!0,min:0,max:1,msg:t("Marker Opacity must be between 0 and 100%").t()},"display.visualizations.mapping.markerLayer.markerMinSize":[{pattern:"digits",required:!0,min:1,msg:t("Minimum Size must be a positive integer").t()},{fn:"validateMapMarkerSize"}],"display.visualizations.mapping.markerLayer.markerMaxSize":[{pattern:"digits",required:!0,min:1,msg:t("Maximum Size must be a positive integer").t()},{fn:"validateMapMarkerSize"}],"display.visualizations.mapping.data.maxClusters":{pattern:"digits",required:!0,min:0,msg:t("Max Clusters must be a non-negative integer").t()},"display.visualizations.mapping.tileLayer.minZoom":[{pattern:"digits",required:!0,min:0,msg:t("Minimum Zoom must be a non-negative integer").t()},{fn:"validateMapTileLayerZoom"}],"display.visualizations.mapping.tileLayer.maxZoom":[{pattern:"digits",required:!0,min:0,msg:t("Maximum Zoom must be a non-negative integer").t()},{fn:"validateMapTileLayerZoom"}],"display.prefs.events.count":{pattern:"digits",min:1,max:100,msg:t("Rows Per Page must be a positive number no larger than 100.").t(),required:!0},"display.events.type":{oneOf:["list","raw","table"],required:!0,msg:t("Event Display Type must be list, raw, or table").t()},"display.events.raw.drilldown":{oneOf:["full","none","inner","outer"],required:!0,msg:t("Event Drilldown must be full, none, inner, or outer").t()},"display.events.list.drilldown":{oneOf:["full","none","inner","outer"],required:!0,msg:t("Event Drilldown must be full, none, inner, or outer").t()},"display.events.table.drilldown":{fn:"validateBoolean",required:!0},"display.events.rowNumbers":{fn:"validateBoolean",required:!0},"display.events.list.wrap":{fn:"validateBoolean",required:!0},"display.events.table.wrap":{fn:"validateBoolean",required:!0},"display.events.maxLines":{oneOf:["0","5","10","20","50","100","200"],required:!0,msg:t("Max Lines must 0, 5, 10, 20, 50, 100, or 200").t()},"display.prefs.statistics.count":{pattern:"digits",min:1,max:100,msg:t("Rows Per Page must be a positive number no larger than 100.").t(),required:!0},"display.statistics.drilldown":{oneOf:["row","cell","none"],required:!0,msg:t("Statistics Drilldown must be row, cell, or none").t()},"display.statistics.overlay":{oneOf:["none","heatmap","highlow"],required:!0,msg:t("Data Overlay must be none, heatmap, or highlow").t()},"display.statistics.rowNumbers":{fn:"validateBoolean",required:!0},"display.statistics.wrap":{fn:"validateBoolean",required:!0}},validateXAxisExtremes:function(e,n,r){var i=n==="display.visualizations.charting.axisX.minimumNumber"?o(e):o(r["display.visualizations.charting.axisX.minimumNumber"]),s=n==="display.visualizations.charting.axisX.maximumNumber"?o(e):o(r["display.visualizations.charting.axisX.maximumNumber"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The X-Axis Min Value must be less than the Max Value.").t()},validateYAxisExtremes:function(e,n,r){var i=n==="display.visualizations.charting.axisY.minimumNumber"?o(e):o(r["display.visualizations.charting.axisY.minimumNumber"]),s=n==="display.visualizations.charting.axisY.maximumNumber"?o(e):o(r["display.visualizations.charting.axisY.maximumNumber"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The Y-Axis Min Value must be less than the Max Value.").t()},validateYAxis2Extremes:function(e,n,r){var i=n==="display.visualizations.charting.axisY2.minimumNumber"?o(e):o(r["display.visualizations.charting.axisY2.minimumNumber"]),s=n==="display.visualizations.charting.axisY2.maximumNumber"?o(e):o(r["display.visualizations.charting.axisY2.maximumNumber"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The Y-Axis Min Value must be less than the Max Value.").t()},validateYScaleAndStacking:function(e,n,r){if(r["display.visualizations.charting.chart"]==="line")return!1;var i=n==="display.visualizations.charting.axisY.scale"?e:r["display.visualizations.charting.axisY.scale"],s=n==="display.visualizations.charting.chart.stackMode"?e:r["display.visualizations.charting.chart.stackMode"];if(i==="log"&&s!=="default")return t("Log scale and stacking cannot be enabled at the same time.").t()},validateRangeValues:function(e){var n;try{n=t(e?JSON.parse(e):[]).map(o)}catch(r){return t('Ranges must be of the form: ["0","30","70","100"]').t()}if(t(n).any(t.isNaN))return t("All color ranges must be valid numbers.").t();var i=u.filterToValidRangeValues(n);if(!t.isEqual(n,i))return t("Color ranges must be entered from lowest to highest.").t()},validateMapMarkerSize:function(e,n,r){var i=n==="display.visualizations.mapping.markerLayer.markerMinSize"?o(e):o(r["display.visualizations.mapping.markerLayer.markerMinSize"]),s=n==="display.visualizations.mapping.markerLayer.markerMaxSize"?o(e):o(r["display.visualizations.mapping.markerLayer.markerMaxSize"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The Min Size must be less than the Max Size.").t()},validateMapTileLayerZoom:function(e,n,r){var i=n==="display.visualizations.mapping.tileLayer.minZoom"?o(e):o(r["display.visualizations.mapping.tileLayer.minZoom"]),s=n==="display.visualizations.mapping.tileLayer.maxZoom"?o(e):o(r["display.visualizations.mapping.tileLayer.maxZoom"]);if(!t.isNaN(i)&&!t.isNaN(s)&&s<=i)return t("The Min Zoom must be less than the Max Zoom.").t()},validateNumberOrAuto:function(e,n,r){var i=o(e);if(e&&t.isNaN(i)&&!e.match(/^(auto)$/))return s.sprintf(t('%s must be a number or "auto".').t(),this.humanizeAttr(n))},validatePositiveNumberOrAuto:function(e,n,r){var i=this.validateNumberOrAuto(e,n,r);if(i)return i;var u=o(e);if(!t.isNaN(u)&&u<=0)return s.sprintf(t('%s must be a positive number or "auto".').t(),this.humanizeAttr(n))},validateBoolean:function(e,n){if(!i.isBooleanEquivalent(e))return s.sprintf(t("%s must be a valid boolean value").t(),this.humanizeAttr(n))},humanizeAttr:function(e){switch(e){case"display.visualizations.charting.axisLabelsX.majorUnit":return t("X-Axis Interval").t();case"display.visualizations.charting.axisLabelsY.majorUnit":case"display.visualizations.charting.axisLabelsY2.majorUnit":return t("Y-Axis Interval").t();case"display.visualizations.charting.axisX.minimumNumber":return t("X-Axis Min Value").t();case"display.visualizations.charting.axisY.minimumNumber":case"display.visualizations.charting.axisY2.minimumNumber":return t("Y-Axis Min Value").t();case"display.visualizations.charting.axisX.maximumNumber":return t("X-Axis Max Value").t();case"display.visualizations.charting.axisY.maximumNumber":case"display.visualizations.charting.axisY2.maximumNumber":return t("Y-Axis Max Value").t();case"display.visualizations.charting.layout.splitSeries":return t("Split Series Mode").t();case"display.events.table.drilldown":return t("Event Drilldown").t();case"display.statistics.wrap":case"display.events.list.wrap":case"display.events.table.wrap":return t("Wrap Results").t();case"display.statistics.rowNumber":case"display.events.rowNumbers":return t("Row Numbers").t();default:return e}},attrToArray:function(e){return u.parseStringifiedArray(this.get(e))},rangesValuesToArray:function(){return this.attrToArray("display.visualizations.charting.chart.rangeValues")},deserializeGaugeColorArray:function(){return u.parseStringifiedColorArray(this.get("display.visualizations.charting.gaugeColors"))},gaugeIsInAutoMode:function(){return!this.get("display.visualizations.charting.chart.rangeValues")&&!this.get("display.visualizations.charting.gaugeColors")}},{CHARTING_ATTRS_FILTER:["^display.visualizations.charting...*"],SINGLE_VALUE_ATTRS_FILTER:["^singlevalue..*"],filterToValidRangeValues:function(e){t(e).isString()&&(e=u.parseStringifiedArray(e)),e=t(e).chain().map(o).filter(function(e){return!t(e).isNaN()}).uniq().value();var n=-Infinity;return e=t(e).filter(function(e){return e<n?!1:(n=e,!0)}),e},parseStringifiedArray:function(e){if(!e)return[];var n=[];try{n=t.values(JSON.parse(e))}catch(r){}return n},parseStringifiedColorArray:function(e){return t(e).isArray()?e:!e||e.charAt(0)!=="["||e.charAt(e.length-1)!=="]"?!1:s.stringToFieldList(e.substring(1,e.length-1))}});return u}),define("views/shared/vizcontrols/Master",["jquery","underscore","backbone","module","views/Base","views/shared/controls/SyntheticSelectControl","views/shared/vizcontrols/Format","models/services/search/IntentionsParser","models/shared/Visualization"],function(e,t,n,r,i,s,o,u,a){return i.extend({moduleId:r.id,vizToAttrs:{line:{"display.visualizations.charting.chart":"line","display.visualizations.type":"charting","display.general.type":"visualizations"},area:{"display.visualizations.charting.chart":"area","display.visualizations.type":"charting","display.general.type":"visualizations"},column:{"display.visualizations.charting.chart":"column","display.visualizations.type":"charting","display.general.type":"visualizations"},bar:{"display.visualizations.charting.chart":"bar","display.visualizations.type":"charting","display.general.type":"visualizations"},pie:{"display.visualizations.charting.chart":"pie","display.visualizations.type":"charting","display.general.type":"visualizations"},scatter:{"display.visualizations.charting.chart":"scatter","display.visualizations.type":"charting","display.general.type":"visualizations"},radialGauge:{"display.visualizations.charting.chart":"radialGauge","display.visualizations.type":"charting","display.general.type":"visualizations"},fillerGauge:{"display.visualizations.charting.chart":"fillerGauge","display.visualizations.type":"charting","display.general.type":"visualizations"},markerGauge:{"display.visualizations.charting.chart":"markerGauge","display.visualizations.type":"charting","display.general.type":"visualizations"},single:{"display.visualizations.type":"singlevalue","display.general.type":"visualizations"},events:{"display.general.type":"events"},statistics:{"display.general.type":"statistics"},mapping:{"display.visualizations.type":"mapping","display.general.type":"visualizations"}},visualizationGroupings:{events:{label:"g1",items:[{value:"events",label:t("Events").t(),icon:"list"}]},statistics:{label:"g2",items:[{value:"statistics",label:t("Statistics Table").t(),icon:"table"}]},visualizations:{label:"g3",items:[{value:"line",label:t("Line").t(),icon:"chart-line"},{value:"area",label:t("Area").t(),icon:"chart-area"},{value:"column",label:t("Column").t(),icon:"chart-column"},{value:"bar",label:t("Bar").t(),icon:"chart-bar"},{value:"pie",label:t("Pie").t(),icon:"chart-pie"},{value:"scatter",label:t("Scatter").t(),icon:"chart-scatter"},{value:"single",label:t("Single Value").t(),icon:"single-value"},{value:"radialGauge",label:t("Radial Gauge").t(),icon:"gauge-radial"},{value:"fillerGauge",label:t("Filler Gauge").t(),icon:"gauge-filler"},{value:"markerGauge",label:t("Marker Gauge").t(),icon:"gauge-marker"},{value:"mapping",label:t("Map").t(),icon:"location"}]}},reportTree:{match:{"display.general.type":{visualizations:{match:{"display.visualizations.type":{singlevalue:{view:"single"},charting:{match:{"display.visualizations.charting.chart":{line:{view:"line"},area:{view:"area"},column:{view:"column"},bar:{view:"bar"},pie:{view:"pie"},scatter:{view:"scatter"},radialGauge:{view:"radialGauge"},fillerGauge:{view:"fillerGauge"},markerGauge:{view:"markerGauge"}}}},mapping:{view:"mapping"}}}},statistics:{view:"statistics"},events:{view:"events"}}}},commandToChartType:{timechart:["line","area","column","statistics"],top:["column","bar","pie","statistics"],rare:["column","bar","pie","statistics"],predict:["line","statistics"],geostats:["mapping"]},allowedVizTypes:["events","statistics","visualizations"],events:{"click .format":function(t){t.preventDefault();var n=e(t.currentTarget);this.setVisualizationFromReport(),this.children.format=new o({model:{report:this.model.report,visualization:this.model.visualization},onHiddenRemove:!0,saveOnApply:this.options.saveOnApply,ignoreClasses:["color-picker-container","select2-drop","select2-drop-mask","dropdown-menu"]}),this.children.format.render().activate().appendTo(e("body")),this.children.format.show(n),n.addClass("active"),this.listenTo(this.children.format,"hidden",function(){n.removeClass("active")})}},initialize:function(){i.prototype.initialize.apply(this,arguments);var n={bindToChangeOfSearch:!0,saveOnApply:!1};this.options=e.extend(!0,n,this.options),this.recommendations=[];if(!t.isArray(this.options.vizTypes)||this.options.vizTypes.length===0)throw new Error("Vizcontrols Master must be instantiated with at least one viz type");t(this.options.vizTypes).each(function(e){if(!t(this.allowedVizTypes).contains(e))throw new Error(e+" is not an allowed viz type")},this),this.model.intentionsParser=new u,this.model.visualization=new a,this.activate()},startListening:function(){this.listenTo(this.model.intentionsParser,"change",this.handleIntentionsParserUpdate),this.listenTo(this.model.report.entry.content,"change:display.general.type",function(e,n,r){t.indexOf(this.options.vizTypes,n)>-1&&this.updateVizTypeChildView({activate:!0})}),this.listenTo(this.model.visualization,"change:viz_type",function(){var e=this.model.visualization.get("viz_type");this.model.report.entry.content.set("viz_type",e),this.model.report.entry.content.set(this.vizToAttrs[e]),this.model.visualization.set(this.vizToAttrs[e]),this.options.saveOnApply&&this.model.report.save()}),this.listenTo(this.model.report.entry.content,"change:search change:id",this.updateVizTypeVisibility),this.options.bindToChangeOfSearch&&this.listenTo(this.model.report.entry.content,"change:search",this.intentionsFetch)},activate:function(e){return this.active?i.prototype.activate.apply(this,arguments):(this.model.visualization.set({dashboard:this.options.dashboard}),this.updateVizTypeChildView({activate:!1}),this.intentionsFetch(),i.prototype.activate.apply(this,arguments))},deactivate:function(e){return this.active?(i.prototype.deactivate.apply(this,arguments),this.model.intentionsParser.fetchAbort(),this.model.intentionsParser.clear({setDefaults:!0}),this.model.visualization.clear({setDefaults:!0}),this):i.prototype.deactivate.apply(this,arguments)},intentionsFetch:function(){this.model.intentionsParser.fetch({data:{q:this.model.report.entry.content.get("search"),app:this.model.application.get("app"),owner:this.model.application.get("owner"),parse_only:!0}})},handleIntentionsParserUpdate:function(){var e=this.getRecommendations();t.isEqual(e,this.recommendations)||(this.recommendations=e,this.updateVizTypeChildView({activate:!0}))},updateVizTypeVisibility:function(){if(!this.children.visualizationType||!this.model.visualization.get("dashboard"))return;this.model.report.isPivotReport()&&!this.model.report.isNew()?(this.children.visualizationType.disable(),this.children.visualizationType.tooltip({animation:!1,title:t("Edit visualization with the pivot tool.").t(),container:"body"})):(this.children.visualizationType.enable(),this.children.visualizationType.tooltip("disable"))},getRecommendations:function(){var e=this.model.intentionsParser.get("reportsSearch");if(!e)return["events"];var n=e.replace(/\s{2,}/g,":::").split(":::")[0];if(this.model.intentionsParser.has("commands")){var r=t(this.model.intentionsParser.get("commands")).pluck("command");t(r).contains("predict")?n="predict":t(r).contains("geostats")&&(n="geostats")}return this.commandToChartType[n]||[]},setVisualizationFromReport:function(){this.model.report.entry.content.unset("viz_type");var n=e.extend({},this.model.report.entry.content.toJSON()),r=a.filterToValidRangeValues(n["display.visualizations.charting.chart.rangeValues"]);n["display.visualizations.charting.chart.rangeValues"]=r.length>0?JSON.stringify(r):"";var i=a.parseStringifiedColorArray(n["display.visualizations.charting.gaugeColors"]);n["display.visualizations.charting.gaugeColors"]=i&&i.length>0?i:"",t(n).each(function(e,t){this.model.visualization.preValidate(t,e)&&delete n[t]},this),this.model.visualization.set(n);var s=this.setVizType(this.reportTree),o;o=s&&s.view?s.view:"column",this.model.visualization.set("viz_type",o)},updateVizTypeChildView:function(n){this.children.visualizationType&&this.children.visualizationType.remove(),this.setVisualizationFromReport();var r=[];t(this.options.vizTypes).each(function(n){var i=e.extend(!0,{},this.visualizationGroupings[n]);t(i.items).each(function(e){t(this.recommendations).contains(e.value)&&(e.description=t("Recommended").t())},this),r.push(i)},this);if(r.length===0)throw new Error("Vizcontrols Master updateVizTypeChildView(), no compatible groups");this.children.visualizationType=new s({model:this.model.visualization,groupedItems:r,className:"dropdown pull-left",toggleClassName:"btn-pill",modelAttribute:"viz_type",menuClassName:"viz-dropdown",popdownOptions:{attachDialogTo:"body"}}),this.children.visualizationType.render().prependTo(this.el),n&&n.activate&&this.children.visualizationType.activate(),this.updateVizTypeVisibility()},setVizType:function(e){if(e&&e.view)return e;if(e&&e.match){var n;t(e.match).each(function(e,t){n=e[this.model.report.entry.content.get(t)]},this);if(n)return this.setVizType(n)}},render:function(){return this.children.visualizationType&&this.children.visualizationType.detach(),this.$el.empty(),this.children.visualizationType&&this.children.visualizationType.prependTo(this.el),this.$el.append(this.compiledTemplate()),this},template:'                <div class="btn-group pull-left">                    <a class="btn-pill popdown-toggle format" href="#">                        <i class="icon-paintbrush"/><span class="link-label"><%- _("Format").t() %></span><span class="caret"></span>                    </a>                </div>            '})}),define("views/shared/reportcontrols/details/History",["module","views/Base"],function(e,t){return t.extend({moduleId:e.id,tagName:"span",initialize:function(){t.prototype.initialize.apply(this,arguments),this.model.entry.on("change:updated",this.render,this)},render:function(){return this.$el.html(this.compiledTemplate({model:this.model})),this},template:'                Created June 18, 2010. Modified <%- model.entry.get("updated") %>.            '})}),define("views/shared/reportcontrols/details/Creator",["underscore","module","views/Base","uri/route","splunk.util"],function(e,t,n,r,i){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.report.entry.content.on("change:display.page.pivot.dataModel",this.render,this)},render:function(){var t,n,s=this.model.application.get("root"),o=this.model.application.get("locale"),u=this.model.application.get("app");return this.model.report.openInView()==="pivot"?(t=r.pivot(s,o,u,{data:{s:this.model.report.id}}),n='<a href="'+t+'" >'+e("Pivot").t()+"</a>"):(t=r.search(s,o,u,{data:{s:this.model.report.id}}),n='<a href="'+t+'" >'+e("Search").t()+"</a>"),this.$el.html(this.compiledTemplate({_:e,splunkUtil:i,createdByAnchor:n})),this},template:'                <%= splunkUtil.sprintf(_("Created by %s.").t(), createdByAnchor) %>            '})}),define("views/shared/documentcontrols/details/App",["module","views/Base"],function(e,t){return t.extend({moduleId:e.id,tagName:"span",initialize:function(){t.prototype.initialize.apply(this,arguments),this.model.entry.acl.on("change:app",this.render,this)},render:function(){return this.$el.html(this.compiledTemplate({model:this.model})),this},template:'                <%- model.entry.acl.get("app") %>            '})}),define("models/shared/Cron",["jquery","underscore","models/Base","splunk.util"],function(e,t,n,r){var i=n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments)},defaults:{minute:"0",hour:"6",dayOfMonth:"*",month:"*",dayOfWeek:"1",cronType:"weekly",cron_schedule:"0 6 * * 1"},validation:{cron_schedule:function(n,i,s){var o=s["ui.type"]||"scheduled";if(o==="scheduled"&&s.cronType==="custom"){if(t.isUndefined(n)||e.trim(n).length===0)return t("Custom cron is required").t();if(!r.validateCronString(n))return t("Invalid cron").t()}}},setCronType:function(e){var t=this.get("minute"),n=this.get("hour"),r=this.get("dayOfMonth"),s=this.get("month"),o=this.get("dayOfWeek");if(s!=="*"){this.set("cronType",i.CRON_TYPES.CUSTOM,e);return}if(/^[0-6]$/.test(o)){if(t==="0"&&/^([0-9]|1[0-9]|2[0-3])$/.test(n)&&r==="*"){this.set("cronType",i.CRON_TYPES.WEEKLY,e);return}}else if(o==="*")if(/^([0-9]|[1-2][0-9]|3[0-1])$/.test(r)){if(/^([0-9]|1[0-9]|2[0-3])$/.test(n)&&t==="0"){this.set("cronType",i.CRON_TYPES.MONTHLY,e);return}}else if(r==="*"){if(/^([0-9]|1[0-9]|2[0-3])$/.test(n)&&t==="0"){this.set("cronType",i.CRON_TYPES.DAILY,e);return}if(n==="*"&&/^(0|15|30|45)$/.test(t)){this.set("cronType",i.CRON_TYPES.HOURLY,e);return}}this.set("cronType",i.CRON_TYPES.CUSTOM,e)},setDefaults:function(){switch(this.get("cronType")){case i.CRON_TYPES.HOURLY:this.set("minute","0");break;case i.CRON_TYPES.DAILY:this.set("hour","0");break;case i.CRON_TYPES.WEEKLY:this.set({dayOfWeek:"1",hour:"0"});break;case i.CRON_TYPES.MONTHLY:this.set({dayOfMonth:"1",hour:"0"})}},getCronString:function(){var e=this.get("minute"),t=this.get("hour"),n=this.get("dayOfMonth"),r=this.get("month"),s=this.get("dayOfWeek"),o=this.get("cron_schedule"),u=this.get("cronType");switch(u){case i.CRON_TYPES.HOURLY:return e+" * * * *";case i.CRON_TYPES.DAILY:return"0 "+t+" * * *";case i.CRON_TYPES.WEEKLY:return"0 "+t+" * * "+s;case i.CRON_TYPES.MONTHLY:return"0 "+t+" "+n+" * *";case i.CRON_TYPES.CUSTOM:return o}},getDayOfWeekName:function(){return i.getDayOfWeekNameFromNum(parseInt(this.get("dayOfWeek"),10))},getScheduleString:function(){switch(this.get("cronType")){case"hourly":return r.sprintf(t("Hourly, at %s minutes past the hour.").t(),this.get("minute"));case"daily":return r.sprintf(t("Daily, at %s:00.").t(),this.get("hour"));case"weekly":return r.sprintf(t("Weekly, %(dayOfWeek)s at %(hour)s:00.").t(),{dayOfWeek:this.getDayOfWeekName(),hour:this.get("hour")});case"monthly":return r.sprintf(t("Monthly, on day %(dayOfMonth)s at %(hour)s:00.").t(),{dayOfMonth:this.get("dayOfMonth"),hour:this.get("hour")});case"custom":return t("Cron Schedule.").t()}}},{createFromCronString:function(e){var n=e.trim().split(/\s+/);if(!n||n.length!==5)throw r.sprintf(t("Invalid cron string: %s").t(),e);var s=new i({minute:n[0],hour:n[1],dayOfMonth:n[2],month:n[3],dayOfWeek:n[4],cron_schedule:n.join(" ")});return s.setCronType(),s},getDayOfWeekNameFromNum:function(e){switch(e){case 0:return t("Sunday").t();case 1:return t("Monday").t();case 2:return t("Tuesday").t();case 3:return t("Wednesday").t();case 4:return t("Thursday").t();case 5:return t("Friday").t();case 6:return t("Saturday").t();case 7:return t("Sunday").t()}},CRON_TYPES:{HOURLY:"hourly",DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly",CUSTOM:"custom"}});return i}),define("views/shared/reportcontrols/details/Schedule",["underscore","module","views/Base","models/shared/Cron","util/time","splunk.util"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=e.debounce(this.render,0);this.model.entry.content.on("change:is_scheduled change:cron_schedule change:action.email change:action.script",t,this)},render:function(){var t=e("Not Applicable for Real-time Reports.").t();this.model.isRealTime()||(this.model.entry.content.get("is_scheduled")?(this.cronModel=r.createFromCronString(this.model.entry.content.get("cron_schedule")),t=this.cronModel.getScheduleString(),this.model.entry.content.get("action.email")||this.model.entry.content.get("action.script")?t+=s.sprintf(e(" Actions: %s.").t(),this.model.getStringOfActions()):t+=e(" No actions.").t()):t=e("Not scheduled.").t()),this.$el.html(t)}})}),define("views/shared/delegates/ModalTimerangePicker",["jquery","underscore","views/shared/delegates/Base","views/shared/delegates/PopdownDialog","views/shared/Modal"],function(e,t,n,r,i){return n.extend({initialize:function(){var e={SLIDE_ANIMATION_DURATION:500};t.defaults(this.options,e),this.$visArea=this.options.$visArea,this.$slideArea=this.options.$slideArea,this.$contentWrapper=this.options.$contentWrapper,this.$timeRangePickerWrapper=this.options.$timeRangePickerWrapper,this.$modalParent=this.options.$modalParent,this.$timeRangePicker=this.options.$timeRangePicker,this.title=this.$(i.HEADER_TITLE_SELECTOR).html(),this.events={},this.events["click "+this.options.backButtonSelector]="closeTimeRangePicker",this.events["click "+this.options.activateSelector]="showTimeRangePicker",this.delegateEvents(this.events),this.$timeRangePicker.hide()},showTimeRangePicker:function(e){var n=this.$contentWrapper,r=this.$timeRangePickerWrapper,s=n.width();this.onBeforePaneAnimation(n,r);var o=r.width(),u=r.height();this.$modalParent.animate({width:o,marginLeft:-(2*s/3)},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$visArea.animate({height:u},{duration:this.options.SLIDE_ANIMATION_DURATION,complete:function(){this.onAfterPaneAnimation(n,r)}.bind(this)},this),this.$slideArea.animate({marginLeft:-s},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$el.animate({width:o},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$(i.HEADER_TITLE_SELECTOR).html(t("Select Time Range").t()),this.$(".btn.back").show(),this.$(".btn-primary").hide(),this.$(".btn.cancel").hide(),e&&e.preventDefault()},closeTimeRangePicker:function(e){var t=this.$timeRangePickerWrapper,n=this.$contentWrapper,r=n.width();this.onBeforePaneAnimation(t,n),this.$modalParent.animate({width:r,marginLeft:-(r/2)},{duration:this.options.SLIDE_ANIMATION_DURATION,complete:function(){this.$modalParent.css({width:""}),this.$modalParent.css({marginLeft:""})}.bind(this)}),this.$visArea.animate({height:n.height()},{duration:this.options.SLIDE_ANIMATION_DURATION,complete:function(){this.onAfterPaneAnimation(t,n)}.bind(this)},this),this.$slideArea.animate({marginLeft:0},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$el.animate({width:r},{duration:this.options.SLIDE_ANIMATION_DURATION}),this.$(i.HEADER_TITLE_SELECTOR).html(this.title),this.$(".btn.back").hide(),this.$(".btn-primary").show(),this.$(".btn.cancel").show(),e&&e.preventDefault()},onBeforePaneAnimation:function(e,t){this.$visArea.css("overflow","hidden"),this.$visArea.css({height:e.height()+"px"}),t===this.$timeRangePickerWrapper&&this.$timeRangePicker.show(),t.css({height:"",visibility:""})},onAfterPaneAnimation:function(e,t){e===this.$timeRangePickerWrapper&&this.$timeRangePicker.hide(),this.$visArea.css("overflow",""),this.$visArea.css({height:""}),e.css({height:"2px",visibility:"hidden"})}})}),define("views/shared/ScheduleSentence",["jquery","module","underscore","views/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticSelectControl","uri/route","splunk.util"],function(e,t,n,r,i,s,o,u){return r.extend({moduleId:t.id,initialize:function(){r.prototype.initialize.apply(this,arguments);var t={lineOneLabel:"",lineTwoLabel:""};n.defaults(this.options,t);var a=function(e){var t=e.toString();return{label:t,value:t}},f=n.map(n.range(0,46,15),a),l=n.map(n.range(24),function(e){return{label:e+":00",value:e.toString()}}),c=n.map(n.range(1,32),a);this.children.timeRange=new i({className:"control-group",controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{modelAttribute:"cronType",model:this.model.cron,items:[{label:n("Run every hour").t(),value:"hourly"},{label:n("Run every day").t(),value:"daily"},{label:n("Run every week").t(),value:"weekly"},{label:n("Run every month").t(),value:"monthly"},{label:n("Run on Cron Schedule").t(),value:"custom"}],save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0,popdownOptions:e.extend(!0,{},this.options.popdownOptions)},label:this.options.lineOneLabel}),this.children.hourly=new s({additionalClassNames:"schedule_hourly",modelAttribute:"minute",model:this.model.cron,items:f,save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0,popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.weekly=new s({additionalClassNames:"schedule_weekly",modelAttribute:"dayOfWeek",model:this.model.cron,items:[{label:n("Monday").t(),value:"1"},{label:n("Tuesday").t(),value:"2"},{label:n("Wednesday").t(),value:"3"},{label:n("Thursday").t(),value:"4"},{label:n("Friday").t(),value:"5"},{label:n("Saturday").t(),value:"6"},{label:n("Sunday").t(),value:"0"}],save:!1,toggleClassName:"btn",labelPosition:"outside",popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.monthly=new s({menuClassName:"dropdown-menu-short",additionalClassNames:"schedule_monthly",modelAttribute:"dayOfMonth",model:this.model.cron,items:c,save:!1,toggleClassName:"btn",labelPosition:"outside",popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.daily=new s({menuClassName:"dropdown-menu-short",additionalClassNames:"schedule_daily",modelAttribute:"hour",model:this.model.cron,items:l,save:!1,toggleClassName:"btn",labelPosition:"outside",popdownOptions:e.extend(!0,{},this.options.popdownOptions)}),this.children.scheduleOptions=new i({controls:[this.children.hourly,this.children.weekly,this.children.monthly,this.children.daily],label:this.options.lineTwoLabel});var h=o.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.scheduled");this.children.cronSchedule=new i({controlType:"Text",controlClass:"controls-block",controlOptions:{modelAttribute:"cron_schedule",model:this.model.cron},label:n("Cron Expression").t(),help:u.sprintf(n("e.g. 00 18 *** (every day at 6PM). %s").t(),'<a href="'+h+'" class="help" target="_blank" title="'+n("Splunk help").t()+'">'+n("Learn More").t()+"</a>")}),this.activate()},timeRangeToggle:function(){var e=this.children.scheduleOptions.$el.find(".pre_label"),t=this.children.scheduleOptions.$el.find(".hour_post_label"),n=this.children.scheduleOptions.$el.find(".weekly_pre_label"),r=this.children.scheduleOptions.$el.find(".monthly_pre_label"),i=this.children.scheduleOptions.$el.find(".daily_pre_label"),s=this.$el.find(".custom_time");this.children.hourly.$el.hide(),this.children.daily.$el.hide(),this.children.weekly.$el.hide(),this.children.monthly.$el.hide(),e.hide(),t.hide(),n.hide(),r.hide(),i.hide(),s.css("display","none");switch(this.model.cron.get("cronType")){case"hourly":this.children.scheduleOptions.$el.show(),this.children.hourly.$el.css("display",""),e.css("display",""),t.css("display","");break;case"daily":this.children.scheduleOptions.$el.show(),this.children.daily.$el.css("display",""),e.css("display","");break;case"weekly":this.children.scheduleOptions.$el.show(),this.children.weekly.$el.css("display",""),this.children.daily.$el.css("display",""),n.css("display",""),i.css("display","");break;case"monthly":this.children.scheduleOptions.$el.show(),this.children.monthly.$el.css("display",""),this.children.daily.$el.css("display",""),r.css("display",""),i.css("display","");break;case"custom":s.css("display",""),this.children.scheduleOptions.$el.hide()}},startListening:function(){this.listenTo(this.model.cron,"change:cronType",function(){this.timeRangeToggle(),this.model.cron.setDefaults()})},render:function(){return this.$el.append(this.children.timeRange.render().el),this.$el.append(this.children.scheduleOptions.render().el),this.children.scheduleOptions.$el.find(".schedule_hourly").before('<span class="pre_label">'+n("At ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_hourly").after('<span class="hour_post_label">'+n(" minutes past the hour").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_weekly").before('<span class="weekly_pre_label">'+n("On ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_weekly .btn").width("75px"),this.children.scheduleOptions.$el.find(".schedule_monthly").before('<span class="monthly_pre_label">'+n("On day ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_monthly .btn").width("55px"),this.children.scheduleOptions.$el.find(".schedule_daily").before('<span class="daily_pre_label">'+n(" at ").t()+"</span>"),this.children.scheduleOptions.$el.find(".schedule_daily .btn").width("50px"),this.$el.append('<div class="custom_time"></div>'),this.$el.find(".custom_time").append(this.children.cronSchedule.render().el),this.timeRangeToggle(),this}})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/step1/Schedule",["underscore","module","views/Base","views/shared/Modal","views/shared/ScheduleSentence","views/shared/controls/ControlGroup"],function(e,t,n,r,i,s){return n.extend({moduleId:t.id,className:"form form-horizontal",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=this.model.inmem.entry.content.get("disabled")?e("Enable and Schedule Report").t():e("Schedule Report").t();this.children.name=new s({controlType:"Label",controlOptions:{modelAttribute:"name",model:this.model.inmem.entry},label:e("Report").t()}),this.children.scheduleCheck=new s({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"scheduled_and_enabled",model:this.model.inmem},label:t}),this.children.scheduleSentence=new i({model:{cron:this.model.cron,application:this.model.application},lineOneLabel:e("Schedule").t(),popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}),this.model.inmem.on("change:scheduled_and_enabled",this.isScheduledToggle,this),this.model.timeRange.on("applied",function(){this.model.inmem.entry.content.set({"dispatch.earliest_time":this.model.timeRange.get("earliest"),"dispatch.latest_time":this.model.timeRange.get("latest")}),this.setLabel()},this),this.model.timeRange.on("change:earliest_epoch change:latest_epoch change:earliest change:latest",e.debounce(this.setLabel,0),this)},isScheduledToggle:function(){this.model.inmem.get("scheduled_and_enabled")?(this.$(".modal-btn-primary").html(e("Next").t()),this.children.scheduleSentence.$el.show(),this.$("div.timerange").show()):(this.children.scheduleSentence.$el.hide(),this.$("div.timerange").hide(),this.$(".modal-btn-primary").html(e("Save").t())),this.model.inmem.trigger("togglePrimaryButton")},setLabel:function(){var e=this.model.timeRange.generateLabel(this.collection);this.$el.find("span.time-label").text(e)},render:function(){return this.children.name.render().appendTo(this.$el),this.model.inmem.entry.content.get("disabled")&&this.$el.append("<div>"+e("This report is currently disabled.").t()+"</div>"),this.children.scheduleCheck.render().appendTo(this.$el),this.children.scheduleSentence.render().appendTo(this.$el),this.$el.append('<div class="timerange" style="display: block;"><label class="control-label">'+e("Time Range").t()+"</label></div>"),this.$("div.timerange").append('<div class="controls"><a href="#" class="btn timerange-control"><span class="time-label"></span><span class="icon-triangle-right-small"></span></a></div>'),this.setLabel(),this.isScheduledToggle(),this}})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/step1/Master",["underscore","module","views/Base","views/shared/Modal","views/shared/delegates/ModalTimerangePicker","views/shared/reportcontrols/dialogs/schedule_dialog/step1/Schedule","views/shared/timerangepicker/dialog/Master","views/shared/FlashMessages"],function(e,t,n,r,i,s,o,u){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.flashMessage=new u({model:this.model.cron}),this.children.scheduleView=new s({model:{application:this.model.application,inmem:this.model.inmem,cron:this.model.cron,timeRange:this.model.timeRange,user:this.model.user,appLocal:this.model.appLocal},collection:this.collection}),this.children.timeRangePickerView=new o({model:{timeRange:this.model.timeRange,user:this.model.user,appLocal:this.model.appLocal,application:this.model.application},collection:this.collection,showPresetsRealTime:!1,showCustomRealTime:!1,showCustomDate:!1,showCustomDateTime:!1,showPresetsAllTime:!0,enableCustomAdvancedRealTime:!1,appendSelectDropdownsTo:".modal:visible"}),this.model.timeRange.on("applied",function(){this.timeRangeDelegate.closeTimeRangePicker()},this),this.model.inmem.on("togglePrimaryButton",this.togglePrimaryButton,this)},events:{"click .modal-btn-primary":function(e){this.model.inmem.get("scheduled_and_enabled")?this.model.inmem.trigger("next"):(this.model.inmem.entry.content.set("is_scheduled",0),this.model.inmem.save({},{success:function(e,t){this.model.inmem.trigger("saveSuccessNotScheduled")}.bind(this)})),e.preventDefault()}},togglePrimaryButton:function(){this.model.inmem.get("scheduled_and_enabled")?this.$(".modal-btn-primary").html(e("Next").t()):this.$(".modal-btn-primary").html(e("Save").t())},render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Schedule").t()),this.$(r.BODY_SELECTOR).remove(),this.$(r.FOOTER_SELECTOR).before('<div class="vis-area"><div class="slide-area"><div class="content-wrapper schedule-wrapper"><div class="'+r.BODY_CLASS+'" >'+"</div>"+"</div>"+'<div class="timerange-picker-wrapper">'+"</div>"+"</div>"+"</div>"),this.$visArea=this.$(".vis-area").eq(0),this.$slideArea=this.$(".slide-area").eq(0),this.$scheduleWrapper=this.$(".schedule-wrapper").eq(0),this.$timeRangePickerWrapper=this.$(".timerange-picker-wrapper").eq(0),this.$modalParent=$(".schedule-modal").eq(0),this.children.flashMessage.render().prependTo(this.$(r.BODY_SELECTOR)),this.children.scheduleView.render().appendTo(this.$(r.BODY_SELECTOR)),this.children.timeRangePickerView.render().appendTo(this.$timeRangePickerWrapper),this.timeRangeDelegate=new i({el:this.el,$visArea:this.$visArea,$slideArea:this.$slideArea,$contentWrapper:this.$scheduleWrapper,$timeRangePickerWrapper:this.$timeRangePickerWrapper,$modalParent:this.$modalParent,$timeRangePicker:this.children.timeRangePickerView.$el,activateSelector:"a.timerange-control",backButtonSelector:"a.btn.back"}),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Save").t()+"</a>"),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn back modal-btn-back pull-left">'+e("Back").t()+"</a>"),this.$(".btn.back").hide(),this.togglePrimaryButton(),this}})}),define("views/shared/EmailOptions",["underscore","backbone","module","views/Base","views/shared/controls/ControlGroup","views/shared/controls/SyntheticSelectControl","splunk.util","uri/route"],function(e,t,n,r,i,s,o,u){return r.extend({moduleId:n.id,className:"enable-actions-view",initialize:function(){r.prototype.initialize.apply(this,arguments);var t={suffix:"report",toLabel:e("To").t(),inculedSubjectDefaultPlaceholder:!1};e.defaults(this.options,t),this.children.toEmailAddresses=new i({className:"control-group",controlType:"Textarea",controlClass:"controls-block",controlOptions:{modelAttribute:"action.email.to",model:this.model.state},label:this.options.toLabel,help:o.sprintf(e("Comma separated list of email addresses. %s").t(),' <a href="#" class="show-cc-bcc">'+e("Show CC and BCC").t()+"</a>")}),this.children.ccEmailAddresses=new i({className:"control-group",controlType:"Textarea",controlClass:"controls-block",controlOptions:{modelAttribute:"action.email.cc",model:this.model.state,placeholder:e("optional").t()},label:e("CC").t()}),this.children.bccEmailAddresses=new i({className:"control-group",controlType:"Textarea",controlClass:"controls-block",controlOptions:{modelAttribute:"action.email.bcc",model:this.model.state,placeholder:e("optional").t()},label:e("BCC").t()}),this.children.emailPriority=new i({className:"control-group",controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{modelAttribute:"action.email.priority",model:this.model.state,items:[{label:e("Lowest").t(),value:"5"},{label:e("Low").t(),value:"4"},{label:e("Normal").t(),value:"3"},{label:e("High").t(),value:"2"},{label:e("Highest").t(),value:"1"}],toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},label:e("Priority").t()});var n=u.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.email.tokens"),s="action.email.subject";o.normalizeBoolean(this.model.state.get("action.email.useNSSubject"))&&(s+="."+this.options.suffix),this.children.emailSubject=new i({className:"control-group",controlType:"Text",controlClass:"controls-block",controlOptions:{modelAttribute:s,model:this.model.state,placeholder:this.options.inculedSubjectDefaultPlaceholder?e("Default").t():""},label:e("Subject").t(),help:o.sprintf(e("The email subject and message can include tokens that insert text based on the results of the search. %s").t(),' <a href="'+n+'" target="_blank" title="'+e("Splunk help").t()+'">'+e("Learn More").t()+' <i class="icon-external"></i></a>')}),this.children.emailMessage=new i({className:"control-group",controlType:"Textarea",controlClass:"controls-block",controlOptions:{modelAttribute:"action.email.message."+this.options.suffix,model:this.model.state,placeholder:e("Default").t(),textareaClassName:"messagearea"},label:e("Message").t()})},events:{"click a.show-cc-bcc":function(e){var t=!0;this.showAdditionalEmailAddresses(t),e.preventDefault()}},showAdditionalEmailAddresses:function(e){e||this.model.state.get("action.email.cc")||this.model.state.get("action.email.bcc")?(this.children.ccEmailAddresses.$el.show(),this.children.bccEmailAddresses.$el.show(),this.children.toEmailAddresses.$("a.show-cc-bcc").css("display","none")):this.children.toEmailAddresses.$("a.show-cc-bcc").css("display","block")},render:function(){return this.children.toEmailAddresses.render().appendTo(this.$el),this.children.ccEmailAddresses.render().appendTo(this.$el).$el.hide(),this.children.bccEmailAddresses.render().appendTo(this.$el).$el.hide(),this.children.emailPriority.render().appendTo(this.$el),this.children.emailSubject.render().appendTo(this.$el),this.children.emailMessage.render().appendTo(this.$el),this.showAdditionalEmailAddresses(),this}})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/Step2",["underscore","module","views/Base","views/shared/Modal","views/shared/EmailOptions","views/shared/controls/ControlGroup","views/shared/controls/SyntheticCheckboxControl","views/shared/controls/SyntheticSelectControl","views/shared/FlashMessages","splunk.util","uri/route","util/console","util/pdf_utils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.deferredPdfAvailable=h.isPdfServiceAvailable(),this.children.flashMessage=new a({model:this.model.inmem});var t="http://docs.splunk.com/";this.model.appLocal&&this.model.application?t=l.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.email"):c.warn("The schedule dialog step 2 view needs the AppLocal and Application model passed to it"),this.children.sendEmailBox=new s({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"action.email",model:this.model.inmem.entry.content},label:e("Send Email").t(),help:f.sprintf(e("Email must be configured in System&nbsp;Settings > Alert&nbsp;Email&nbsp;Settings. %s").t(),' <a href="'+t+'" target="_blank">'+e("Learn More").t()+' <i class="icon-external"></i></a>')}),this.children.emailOptions=new i({model:{state:this.model.inmem.entry.content,application:this.model.application},suffix:"report",inculedSubjectDefaultPlaceholder:!0}),this.children.includeResultsLink=new o({modelAttribute:"action.email.include.results_link",model:this.model.inmem.entry.content,label:e("Link to Results").t()}),this.children.includeInline=new o({additionalClassNames:"include-inline",modelAttribute:"action.email.inline",model:this.model.inmem.entry.content,label:e("Inline").t()}),this.children.includeInlineFormat=new u({additionalClassNames:"include-inline-format",modelAttribute:"action.email.format",menuWidth:"narrow",model:this.model.inmem.entry.content,items:[{label:e("Table").t(),value:"table"},{label:e("Raw").t(),value:"raw"},{label:e("CSV").t(),value:"csv"}],labelPosition:"outside",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}),this.children.includeCSV=new o({modelAttribute:"action.email.sendcsv",model:this.model.inmem.entry.content,label:e("Attach CSV").t()}),this.children.includePDF=new o({modelAttribute:"action.email.sendpdf",model:this.model.inmem.entry.content,label:e("Attach PDF").t()}),this.children.includeSearchString=new o({modelAttribute:"action.email.include.search",model:this.model.inmem.entry.content,label:e("Search String").t()}),this.children.includeViewLink=new o({modelAttribute:"action.email.include.view_link",model:this.model.inmem.entry.content,label:e("Link to Report").t()});var r=[this.children.includeViewLink,this.children.includeResultsLink,this.children.includeSearchString,this.children.includeInline,this.children.includeInlineFormat,this.children.includeCSV];$.when(this.deferredPdfAvailable).then(function(t){t&&r.push(this.children.includePDF),this.children.emailInclude=new s({controlClass:"email-include",controls:r,label:e("Include").t()})}.bind(this)),this.children.runScriptBox=new s({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"action.script",model:this.model.inmem.entry.content},label:e("Run a Script").t()}),this.children.scriptFilename=new s({controlType:"Text",controlOptions:{modelAttribute:"action.script.filename",model:this.model.inmem.entry.content},label:e("Filename").t(),help:e("Located in $SPLUNK_HOME/bin/scripts").t()}),this.model.inmem.entry.content.on("change:action.email",this.toggleEmail,this),this.model.inmem.entry.content.on("change:action.script",this.toggleScript,this),this.model.inmem.entry.content.on("change:action.email.format",function(){this.model.inmem.entry.content.set("action.email.inline",1)},this)},events:{"click .btn-primary":function(e){var t=[];this.model.inmem.entry.content.get("action.email")&&t.push("email"),this.model.inmem.entry.content.get("action.script")&&t.push("script"),this.model.inmem.entry.content.set("actions",t.join(", ")),this.model.inmem.trigger("saveSchedule"),e.preventDefault()},"click .back":function(e){this.model.inmem.entry.content.trigger("back"),e.preventDefault()}},toggleEmail:function(){this.model.inmem.entry.content.get("action.email")?(this.children.emailOptions.$el.show(),this.children.emailInclude.$el.show()):(this.children.emailOptions.$el.hide(),this.children.emailInclude.$el.hide())},toggleScript:function(){this.model.inmem.entry.content.get("action.script")?this.children.scriptFilename.$el.show():this.children.scriptFilename.$el.hide()},render:function(){$.when(this.deferredPdfAvailable).then(function(){this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Schedule").t()),this.children.flashMessage.render().prependTo(this.$(r.BODY_SELECTOR)),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL_COMPLEX);if(this.model.user.isFree()){var t=l.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.license.features");this.children.sendEmailBox.disable(),this.children.runScriptBox.disable(),this.$(r.BODY_FORM_SELECTOR).append(this.compiledTemplate({_:e,splunkUtil:f,link:' <a href="'+t+'" target="_blank">'+e("Learn More").t()+' <i class="icon-external"></i></a>'}))}return this.$(r.BODY_FORM_SELECTOR).append('<p class="control-heading">'+e("Enable Actions").t()+"</p>"),this.children.sendEmailBox.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.children.emailOptions.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.children.emailInclude.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.children.runScriptBox.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.children.scriptFilename.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn back pull-left">'+e("Back").t()+"</a>"),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this.toggleEmail(),this.toggleScript(),this}.bind(this))},template:'                <div class="alert alert-info">                    <i class="icon-alert"></i>                    <%= splunkUtil.sprintf(_("Scheduling Actions is an Enterprise-level feature. It is not available with Splunk Free. %s").t(), link) %>                </div>            '})}),define("views/shared/reportcontrols/dialogs/schedule_dialog/Master",["underscore","backbone","models/shared/Cron","models/shared/TimeRange","collections/services/data/ui/Times","views/shared/Modal","module","views/shared/reportcontrols/dialogs/schedule_dialog/step1/Master","views/shared/reportcontrols/dialogs/schedule_dialog/Step2","splunk.util"],function(e,t,n,r,i,s,o,u,a,f){return s.extend({moduleId:o.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model={application:this.model.application,report:this.model.report,user:this.model.user,appLocal:this.model.appLocal,timeRange:new r({enableRealTime:!1}),inmem:this.model.report.clone(),cron:n.createFromCronString(this.model.report.entry.content.get("cron_schedule")||"0 6 * * 1")},this.collection=new i,this.collectionDeferred=this.collection.fetch({data:{app:this.model.application.get("app"),owner:this.model.application.get("owner")}}),this.model.inmem.set({scheduled_and_enabled:!this.model.inmem.entry.content.get("disabled")&&this.model.inmem.entry.content.get("is_scheduled")}),this.children.step1=new u({model:{state:this.model.inmem.entry.content,application:this.model.application,inmem:this.model.inmem,cron:this.model.cron,timeRange:this.model.timeRange,user:this.model.user,appLocal:this.model.appLocal},collection:this.collection}),this.children.step2=new a({model:{inmem:this.model.inmem,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal}}),this.model.inmem.on("next",function(){this.model.cron.validate()},this),this.model.inmem.entry.content.on("back",function(){this.children.step2.$el.hide(),this.$el.removeClass(s.CLASS_MODAL_WIDE),this.children.step1.$el.show()},this),this.model.cron.on("validated",function(e,t,n){e&&(this.children.step1.$el.hide(),this.$el.addClass(s.CLASS_MODAL_WIDE),this.children.step2.$el.show())},this),this.model.inmem.on("saveSuccessNotScheduled",function(){this.model.report.entry.content.set("is_scheduled",0),this.hide()},this),this.model.inmem.on("saveSchedule",function(){this.trasposeFromUI(),this.model.inmem.entry.content.set("cron_schedule",this.model.cron.getCronString()),this.model.inmem.save({},{success:function(e,t){this.model.report.fetch(),this.hide()}.bind(this)})},this)},trasposeFromUI:function(){var e=f.normalizeBoolean(this.model.inmem.entry.content.get("action.email.sendpdf"))||f.normalizeBoolean(this.model.inmem.entry.content.get("action.email.sendcsv"))||f.normalizeBoolean(this.model.inmem.entry.content.get("action.email.inline"));this.model.inmem.entry.content.set("action.email.sendresults",+e),this.model.inmem.get("scheduled_and_enabled")&&this.model.inmem.entry.content.set({is_scheduled:1,disabled:0})},render:function(){this.$el.addClass("schedule-modal");var e=this.model.timeRange.save({earliest:this.model.inmem.entry.content.get("dispatch.earliest_time"),latest:this.model.inmem.entry.content.get("dispatch.latest_time")});$.when(e,this.collectionDeferred).then(function(){this.children.step1.render().appendTo(this.$el),this.children.step2.render().appendTo(this.$el),this.children.step2.$el.hide()}.bind(this))}})}),define("views/shared/reportcontrols/details/EditSchedule",["underscore","backbone","module","views/Base","views/shared/reportcontrols/dialogs/schedule_dialog/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-schedule":function(e){this.children.scheduleDialog=new i({model:{report:this.model.report,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal},onHiddenRemove:!0}),this.children.scheduleDialog.render().appendTo($("body")),this.children.scheduleDialog.show(),e.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-schedule" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/reportcontrols/details/Acceleration",["underscore","module","views/Base","splunk.util"],function(e,t,n,r){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=e.debounce(this.render,0);this.model.entry.content.on("change:auto_summarize change:auto_summarize.dispatch.earliest_time",t,this)},render:function(){return this.$el.html(this.compiledTemplate({model:this.model,_:e,splunkUtil:r})),this},convertSummarizeTime:function(t){switch(t){case"-1d@h":return e("1 Day").t();case"-7d@d":return e("1 Week").t();case"-1mon@d":return e("1 Month").t();case"-3mon@d":return e("3 Months").t();case"-1y@d":return e("1 Year").t();case"0":return e("All Time").t();default:return e("Custom").t()}},template:'                <% if (model.entry.content.get("auto_summarize")) { %>                    <%- splunkUtil.sprintf(_("Enabled. Summary Range: %s.").t(), this.convertSummarizeTime(model.entry.content.get("auto_summarize.dispatch.earliest_time"))) %>                <% } else { %>                    <%- _("Disabled.").t() %>                <% } %>            '})}),define("views/shared/reportcontrols/dialogs/AccelerationDialog",["underscore","backbone","module","models/services/search/IntentionsParser","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages","splunk.util"],function(e,t,n,r,i,s,o,u){return i.extend({moduleId:n.id,initialize:function(t){i.prototype.initialize.apply(this,arguments),this.model={searchJob:this.model.searchJob,report:this.model.report,inmem:this.model.report.clone(),application:this.model.application},this.model.searchJob||(this.model.intentionsParser=new r,this.intentionsParserDeferred=this.model.intentionsParser.fetch({data:{q:this.model.report.entry.content.get("search"),timeline:!1,app:this.model.application.get("app"),owner:this.model.application.get("owner")}})),this.children.flashMessage=new o({model:this.model.inmem}),this.children.name=new s({controlType:"Label",controlOptions:{modelAttribute:"name",model:this.model.inmem.entry},label:e("Report").t()}),this.children.acceleration=new s({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"auto_summarize",model:this.model.inmem.entry.content},label:u.sprintf(e("Accelerate %s").t(),this.model.report.isAlert()?e("Alert").t():e("Report").t()),help:e("Acceleration may increase storage and processing costs.").t()}),this.children.summary_range=new s({controlType:"SyntheticSelect",controlOptions:{modelAttribute:"auto_summarize.dispatch.earliest_time",model:this.model.inmem.entry.content,items:[{label:e("1 Day").t(),value:"-1d@h"},{label:e("7 Days").t(),value:"-7d@d"},{label:e("1 Month").t(),value:"-1mon@d"},{label:e("3 Months").t(),value:"-3mon@d"},{label:e("1 Year").t(),value:"-1y@d"},{label:e("All Time").t(),value:"0"}],save:!1,toggleClassName:"btn",labelPosition:"outside",elastic:!0,popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},label:e("Summary Range").t(),tooltip:e("Sets the range of time (relative to now) for which data is accelerated. Example: 1 Month accelerates the last 30 days of data in your reports.").t()}),this.model.inmem.entry.content.on("change:auto_summarize",function(){this.model.inmem.entry.content.get("auto_summarize")?(this.children.summary_range.$el.show(),this.model.inmem.entry.content.get("auto_summarize.dispatch.earliest_time")===""&&this.model.inmem.entry.content.set("auto_summarize.dispatch.earliest_time","-1d@h")):this.children.summary_range.$el.hide()},this),this.on("hidden",function(){this.model.inmem.get("updated")>this.model.report.get("updated")&&this.model.report.entry.content.set({auto_summarize:this.model.inmem.entry.content.get("auto_summarize"),"auto_summarize.dispatch.earliest_time":this.model.inmem.entry.content.get("auto_summarize.dispatch.earliest_time")})},this)},events:$.extend({},i.prototype.events,{"click .save.modal-btn-primary":function(e){this.model.inmem.save({},{success:function(e,t){this.model.report.fetch(),this.remove()}.bind(this)}),e.preventDefault()}}),render:function(){return this.$el.html(i.TEMPLATE),this.$(i.HEADER_TITLE_SELECTOR).html(e("Edit Acceleration").t()),this.children.flashMessage.render().prependTo(this.$(i.BODY_SELECTOR)),this.$(i.BODY_SELECTOR).append(i.FORM_HORIZONTAL),$.when(this.intentionsParserDeferred).then(function(){var t=this.model.searchJob&&this.model.searchJob.canSummarize()||this.model.intentionsParser&&this.model.intentionsParser.get("canSummarize");t?(this.model.inmem.setAccelerationWarning(t),this.children.name.render().appendTo(this.$(i.BODY_FORM_SELECTOR)),this.children.acceleration.render().appendTo(this.$(i.BODY_FORM_SELECTOR)),this.children.summary_range.render().appendTo(this.$(i.BODY_FORM_SELECTOR)),this.model.inmem.entry.content.get("auto_summarize")?this.children.summary_range.$el.show():this.children.summary_range.$el.hide(),this.$(i.FOOTER_SELECTOR).append(i.BUTTON_CANCEL),this.$(i.FOOTER_SELECTOR).append('<a href="#" class="save btn btn-primary modal-btn-primary pull-right">'+e("Save").t()+"</a>")):(this.$(i.BODY_FORM_SELECTOR).append("<div>"+e("This report cannot be accelerated.").t()+"</div>"),this.$(i.FOOTER_SELECTOR).append(i.BUTTON_DONE))}.bind(this)),this}})}),define("views/shared/reportcontrols/details/EditAcceleration",["underscore","backbone","module","views/Base","views/shared/reportcontrols/dialogs/AccelerationDialog"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-acceleration":function(e){this.children.accelerationDialog=new i({model:{report:this.model.report,searchJob:this.model.searchJob,application:this.model.application},onHiddenRemove:!0}),this.children.accelerationDialog.render().appendTo($("body")),this.children.accelerationDialog.show(),e.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-acceleration" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/documentcontrols/details/Permissions",["underscore","module","views/Base","util/splunkd_utils","splunk.util"],function(e,t,n,r,i){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments);var t=e.debounce(this.render,0);this.model.entry.acl.on("change:sharing change:owner",t,this)},render:function(){var e=this.model.entry.acl.get("sharing"),t=this.model.entry.acl.get("owner"),n=r.getPermissionLabel(e,t);return this.$el.html(this.compiledTemplate({permissionString:n})),this},template:"               <%- permissionString %>            "})}),define("views/shared/documentcontrols/dialogs/permissions_dialog/ACL",["underscore","jquery","backbone","module","views/Base","views/shared/controls/SyntheticCheckboxControl"],function(e,t,n,r,i,s){return i.extend({moduleId:r.id,className:"push-margins",initialize:function(){i.prototype.initialize.apply(this,arguments),this.children.read=new i,this.children.write=new i,this.model.perms.on("change:Everyone.read",function(){this.toggleEveryone("read")},this),this.model.perms.on("change:Everyone.write",function(){this.toggleEveryone("write")},this)},appendRow:function(t){var n=t!=="Everyone"?"role":"";this.$("tbody").append('<tr class="'+t+'">                    <td class="role-name">'+e.escape(this.model.perms.get(t+".name"))+'</td>                    <td class="perms-read '+t+'-checkbox"></td>                    <td class="perms-write '+t+'-checkbox"></td>                </tr>'),this.children.readCheckbox=new s({modelAttribute:t+".read",model:this.model.perms,checkboxClassName:n+" read btn"}),this.children.writeCheckbox=new s({modelAttribute:t+".write",model:this.model.perms,checkboxClassName:n+" write btn"}),this.children.readCheckbox.render().appendTo(this.$("td.perms-read."+t+"-checkbox")),this.children.writeCheckbox.render().appendTo(this.$("td.perms-write."+t+"-checkbox")),this.children.read.children[t]=this.children.readCheckbox,this.children.write.children[t]=this.children.writeCheckbox},toggleEveryone:function(t){var n=this.model.perms.get("Everyone."+t),r=this.children[t];e.each(r.children,function(e,t){t!=="Everyone"&&(n?e.disable():e.enable())})},render:function(){return this.$el.html(this.compiledTemplate({_:e})),e(this.model.perms.toJSON()).each(function(e,t){var n=t.split("."),r=n[0],i=n[1];i==="name"&&this.appendRow(r)}.bind(this)),this.toggleEveryone("read"),this.toggleEveryone("write"),this},template:'            <table class="table table-striped table-condensed table-scroll table-border-row">                <thead>                    <tr>                        <td></td>                        <th class="perms-read"><%- _("Read").t() %></th>                        <th class="perms-write"><%- _("Write").t() %></th>                    </tr>                </thead>                <tbody>                </tbody>            </table>        '})}),define("views/shared/documentcontrols/dialogs/permissions_dialog/Master",["jquery","underscore","backbone","module","models/Base","models/ACLReadOnly","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/documentcontrols/dialogs/permissions_dialog/ACL","views/shared/FlashMessages","util/splunkd_utils"],function(e,t,n,r,i,s,o,u,a,f,l){return o.extend({moduleId:r.id,initialize:function(n){o.prototype.initialize.apply(this,arguments),this.model.perms=new i,this.model.inmem=new s(e.extend(!0,{},this.model.document.entry.acl.toJSON()));var r={nameLabel:t("Name").t(),nameKey:"name"};t.defaults(this.options,r),this.translateToPermsModel(),this.children.flashMessage=new f({model:{inmem:this.model.inmem,report:this.model.document,reportAcl:this.model.document.acl}}),this.children.name=new u({controlType:"Label",controlOptions:{modelAttribute:this.options.nameKey,model:this.model.nameModel},label:this.options.nameLabel}),this.children.owner=new u({controlType:"Label",controlOptions:{modelAttribute:"owner",model:this.model.inmem},label:t("Owner").t()}),this.children.app=new u({controlType:"Label",controlOptions:{modelAttribute:"app",model:this.model.inmem},label:t("App").t()}),this.children.display_for=new u({controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{modelAttribute:"sharing",model:this.model.inmem,items:[{label:t("Owner").t(),value:l.USER,className:"user"},{label:t("App").t(),value:l.APP,className:"app"},{label:t("All Apps").t(),value:l.GLOBAL,className:"global"}],save:!1},label:t("Display For").t()}),this.children.acl=new a({model:{perms:this.model.perms},collection:this.collection}),this.model.inmem.on("change:sharing",function(){this.model.inmem.get("sharing")===l.USER?this.children.acl.$el.hide():this.children.acl.$el.show()},this)},events:e.extend({},o.prototype.events,{"click .btn-primary":function(e){this.translateFromPermsModel();var t=this.model.inmem.toDataPayload();this.model.document.acl.save({},{data:t,success:function(e,n){this.hide(),this.model.document.fetch({url:l.fullpath(this.model.document.url+"/"+encodeURIComponent(this.model.document.entry.get("name")),{sharing:t.sharing,app:this.model.inmem.get("app"),owner:t.owner}),success:function(){this.model.document.trigger("updateCollection")}.bind(this)})}.bind(this)}),e.preventDefault()}}),translateToPermsModel:function(){var e=this.model.inmem.permsToObj();this.model.perms.set("Everyone.name",t("Everyone").t()),this.model.perms.set("Everyone.read",t.indexOf(e.read,"*")!=-1),this.model.perms.set("Everyone.write",t.indexOf(e.write,"*")!=-1),this.collection.each(function(n,r){var i=n.entry.get("name"),s=r+1;this.model.perms.set("role_"+s+".name",i),this.model.perms.set("role_"+s+".read",t.indexOf(e.read,i)!=-1),this.model.perms.set("role_"+s+".write",t.indexOf(e.write,i)!=-1)},this)},translateFromPermsModel:function(){var e={read:[],write:[]};t(this.model.perms.toJSON()).each(function(t,n){var r=n.split("."),i=r[0],s=r[1];(s==="read"||s==="write")&&t&&(i==="Everyone"?e[s].push("*"):e[s].push(this.model.perms.get(i+".name")))}.bind(this)),this.model.inmem.set("perms",e)},setView:function(){this.model.inmem.get("can_share_user")||this.children.display_for.$(".user").attr("disabled",!0),this.model.inmem.get("can_share_app")||this.children.display_for.$(".app").attr("disabled",!0),this.model.inmem.get("can_share_global")||this.children.display_for.$(".global").attr("disabled",!0),this.model.inmem.get("modifiable")||this.children.display_for.$(".btn").attr("disabled",!0),this.model.inmem.get("sharing")==="user"?this.children.acl.$el.hide():this.children.acl.$el.show()},render:function(){return this.$el.html(o.TEMPLATE),this.$(o.HEADER_TITLE_SELECTOR).html(t("Edit Permissions").t()),this.$(o.BODY_SELECTOR).addClass("modal-body-scrolling"),this.children.flashMessage.render().prependTo(this.$(o.BODY_SELECTOR)),this.$(o.BODY_SELECTOR).append(o.FORM_HORIZONTAL),this.children.name.render().appendTo(this.$(o.BODY_FORM_SELECTOR)),this.children.owner.render().appendTo(this.$(o.BODY_FORM_SELECTOR)),this.children.app.render().appendTo(this.$(o.BODY_FORM_SELECTOR)),this.children.display_for.render().appendTo(this.$(o.BODY_FORM_SELECTOR)),this.model.user.isFree()||this.children.acl.render().appendTo(this.$(o.BODY_FORM_SELECTOR)),this.$(o.FOOTER_SELECTOR).append(o.BUTTON_CANCEL),this.$(o.FOOTER_SELECTOR).append(o.BUTTON_SAVE),this.setView(),this}})}),define("views/shared/reportcontrols/details/EditPermissions",["underscore","backbone","module","views/Base","views/shared/documentcontrols/dialogs/permissions_dialog/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-permissions":function(t){this.children.permissionsDialog=new i({model:{document:this.model.report,nameModel:this.model.report.entry,user:this.model.user},collection:this.collection,onHiddenRemove:!0,nameLabel:e("Report").t()}),this.children.permissionsDialog.render().appendTo($("body")),this.children.permissionsDialog.show(),t.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-permissions" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/reportcontrols/details/Embed",["underscore","module","views/Base","util/general_utils"],function(e,t,n,r){return n.extend({moduleId:t.id,tagName:"span",initialize:function(){n.prototype.initialize.apply(this,arguments)},render:function(){var t=r.normalizeBoolean(this.model.entry.content.get("embed.enabled"));return this.$el.html(this.compiledTemplate({_:e,embed:t})),this},template:'                <% if (embed) { %>                    <%- _("Enabled.").t() %>                <% } else { %>                    <%- _("Disabled.").t() %>                <% } %>            '})}),define("views/shared/reportcontrols/dialogs/embed_dialog/NotScheduled",["underscore","module","views/Base","views/shared/Modal","views/shared/reportcontrols/dialogs/schedule_dialog/Master"],function(e,t,n,r,i){return n.extend({moduleId:t.id,events:{"click a.scheduleReport":function(e){this.trigger("hide");var t=new i({model:{report:this.model.report,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal},onHiddenRemove:!0});t.render().appendTo($("body")),t.show(),e.preventDefault()}},render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Report Must Be Scheduled").t()),this.$(r.BODY_SELECTOR).append("<p>"+e("You cannot enable embedding for this report until it is scheduled. Embedded reports always display the results of their last scheduled run.").t()+"</p>"),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary pull-right scheduleReport">'+e("Schedule Report").t()+"</a>"),this}})}),define("views/shared/reportcontrols/dialogs/embed_dialog/Confirmation",["underscore","module","views/Base","views/shared/Modal"],function(e,t,n,r){return n.extend({moduleId:t.id,events:{"click a.enableEmbedding":function(e){this.model.embed.save()}},render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Enable Report Embedding").t()),this.$(r.BODY_SELECTOR).append("<p>"+e("Are you sure you want to enable embedding for this report? An embedded report can be viewed by anyone with access to the web page(s) in which it is inserted.").t()+"</p>"),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary pull-right enableEmbedding">'+e("Enable Embedding").t()+"</a>"),this}})}),define("models/services/saved/searches/History",["models/SplunkDBase"],function(e){return e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments)},sync:function(e,t,n){throw new Error("invalid method: "+e)}})}),define("collections/services/saved/searches/Histories",["models/services/saved/searches/History","collections/SplunkDsBase"],function(e,t){return t.extend({initialize:function(){t.prototype.initialize.apply(this,arguments)},model:e})}),define("views/shared/FlashMessagesLegacy",["underscore","views/Base","module"],function(e,t,n){return t.extend({moduleId:n.id,className:"alerts",initialize:function(){t.prototype.initialize.apply(this,arguments),this.activate()},startListening:function(){this.listenTo(this.collection,"add push reset",this.render)},render:function(){var t=e.template(this.template,{flashMessages:this.collection});return this.$el.html(t),this.collection.length===0?this.$el.hide():this.$el.show(),this},template:'            <% flashMessages.each(function(flashMessage){ %>                 <div class="alert alert-<%- flashMessage.get("type") %>">                    <i class="icon-alert"></i>                    <%- flashMessage.get("html") %>                </div>            <% }); %>         '},{update:function(t,n,r){var i=[],s=0;e(n.children).each(function(e){e.error(!1)}),e(t).each(function(e){n.children[e.name].error(!0),i.push({key:n.cid+s++,type:"error",html:e.msg})},n),r.reset(i)}})}),define("views/shared/reportcontrols/dialogs/embed_dialog/Embed",["underscore","module","uri/route","models/Base","views/Base","views/shared/Modal","views/shared/controls/TextareaControl","collections/services/saved/searches/Histories","views/shared/FlashMessagesLegacy","collections/shared/FlashMessages"],function(e,t,n,r,i,s,o,u,a,f){return i.extend({moduleId:t.id,initialize:function(){i.prototype.initialize.apply(this,arguments),this.model.state=new r,this.collection={histories:new u,messages:new f},this.children.flashMessages=new a({collection:this.collection.messages}),this.collection.histories.url=this.model.report.entry.links.get("history"),this.children.snippet=new o({spellcheck:!1,modelAttribute:"text",model:this.model.state}),this.model.report.entry.content.on("change:embed.token",this.setText,this),this.collection.histories.on("sync",this.maybeWarn,this),this.setText()},setText:function(){var t=n.embed(this.model.application.get("root"),this.model.application.get("locale"),this.model.report.entry.content.get("embed.token"),this.model.report.get("id")),r=this.model.report.entry.content.get("display.general.type"),i=this.model.report.entry.content.get("display.visualizations.type"),s=300,o=36,u,a;r==="visualizations"&&i==="charting"?s=parseInt(this.model.report.entry.content.get("display.visualizations.chartHeight"),10):r==="events"||r==="statistics"?s=600:r==="visualizations"&&i==="mapping"?s=parseInt(this.model.report.entry.content.get("display.visualizations.mapHeight"),0):r==="visualizations"&&i==="singlevalue"&&(s=60),u=s+o,a=e.template('<iframe height="<%- height %>" width="480" frameborder="0" src="<%= src %>"></iframe>',{src:t,height:u}),this.model.state.set("text",a)},show:function(){this.$el.show(),this.$("textarea").focus(),this.collection.histories.fetch({data:{count:1}})},maybeWarn:function(){this.collection.histories.length?this.collection.messages.reset([]):this.collection.messages.reset([{type:"warning",html:e("Embedded Report will not have data until the scheduled search runs.").t()}])},events:{"focus textarea":function(e){setTimeout(function(){this.$("textarea").select()}.bind(this),0)},"click a.disableEmbedding":function(t){t.preventDefault(),window.confirm(e("Are you sure you no longer want to share this report outside of Splunk?").t())&&this.model.report.unembed.save()}},render:function(){return this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(e("Embed").t()),this.$(s.BODY_SELECTOR).append(this.children.flashMessages.render().el),this.$(s.BODY_SELECTOR).append("<p>"+e("Copy and paste this code into your HTML-based web page.").t()+"</p>"),this.children.snippet.render().appendTo(this.$(s.BODY_SELECTOR)),this.$(s.BODY_SELECTOR).append("<p>"+e("Disable embedding if you no longer want to share this report outside of Splunk.").t()+"</p>"),this.$(s.FOOTER_SELECTOR).append('<a href="#" class="btn pull-left disableEmbedding">'+e("Disable Embedding").t()+"</a>"),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_DONE),this}})}),define("views/shared/reportcontrols/dialogs/embed_dialog/Master",["underscore","module","views/shared/Modal","views/shared/reportcontrols/dialogs/embed_dialog/NotScheduled","views/shared/reportcontrols/dialogs/embed_dialog/Confirmation","views/shared/reportcontrols/dialogs/embed_dialog/Embed","util/general_utils"],function(e,t,n,r,i,s,o){return n.extend({moduleId:t.id,initialize:function(e){n.prototype.initialize.apply(this,arguments),this.children.notScheduled=new r({model:{report:this.model.report,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal}}),this.children.notScheduled.on("hide",this.hide,this),this.children.confirmation=new i({model:this.model.report}),this.children.embed=new s({model:{report:this.model.report,application:this.model.application}}),this.children.embed.on("hide",this.hide,this),this.model.report.entry.content.on("change:embed.enabled",function(){if(o.normalizeBoolean(this.model.report.entry.content.get("embed.enabled"))){this.children.notScheduled.$el.hide(),this.children.confirmation.$el.hide(),this.children.embed.show();return}this.hide()},this)},visibility:function(){this.model.report.entry.content.get("is_scheduled")?o.normalizeBoolean(this.model.report.entry.content.get("embed.enabled"))?(this.children.notScheduled.$el.hide(),this.children.confirmation.$el.hide(),this.children.embed.show()):(this.children.notScheduled.$el.hide(),this.children.confirmation.$el.show(),this.children.embed.$el.hide()):(this.children.notScheduled.$el.show(),this.children.confirmation.$el.hide(),this.children.embed.$el.hide())},render:function(){this.$el.append(this.children.notScheduled.render().el),this.$el.append(this.children.confirmation.render().el),this.$el.append(this.children.embed.render().el),this.visibility()}})}),define("views/shared/reportcontrols/details/EditEmbed",["underscore","backbone","module","views/Base","views/shared/reportcontrols/dialogs/embed_dialog/Master"],function(e,t,n,r,i){return r.extend({moduleId:n.id,tagName:"span",initialize:function(){r.prototype.initialize.apply(this,arguments)},events:{"click a.edit-embed":function(e){this.children.embedDialog=new i({model:this.model,onHiddenRemove:!0}),this.children.embedDialog.render().appendTo($("body")),this.children.embedDialog.show(),e.preventDefault()}},render:function(){return this.$el.html(this.compiledTemplate({_:e})),this},template:'                <a class="edit-embed" href="#"><%- _("Edit").t() %></a>            '})}),define("views/shared/reportcontrols/details/Master",["underscore","jquery","views/Base","module","views/shared/reportcontrols/details/History","views/shared/reportcontrols/details/Creator","views/shared/documentcontrols/details/App","views/shared/reportcontrols/details/Schedule","views/shared/reportcontrols/details/EditSchedule","views/shared/reportcontrols/details/Acceleration","views/shared/reportcontrols/details/EditAcceleration","views/shared/documentcontrols/details/Permissions","views/shared/reportcontrols/details/EditPermissions","views/shared/reportcontrols/details/Embed","views/shared/reportcontrols/details/EditEmbed","util/general_utils","bootstrap.modal"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){return n.extend({moduleId:r.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.children.creatorView=new s({model:{report:this.model.report,application:this.model.application}}),this.children.appView=new o({model:this.model.report}),this.children.scheduleView=new u({model:this.model.report}),this.children.editScheduleView=new a({model:{report:this.model.report,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal}}),this.children.accelerationView=new f({model:this.model.report}),this.children.editAccelerationView=new l({model:{report:this.model.report,searchJob:this.model.searchJob,application:this.model.application}}),this.children.permissionsView=new c({model:this.model.report}),this.children.editPermissionsView=new h({model:{report:this.model.report,user:this.model.user},collection:this.collection}),this.children.embedView=new p({model:this.model.report}),this.children.editEmbedView=new d({model:this.model}),this.model.searchJob&&this.model.searchJob.on("prepared",function(){this.$("a.edit-acceleration").css("display","")},this),this.model.report.entry.content.on("change:embed.enabled",this.render,this)},render:function(){var t=this.model.report.entry.acl.get("can_write")&&(!this.model.report.entry.content.get("is_scheduled")||!!this.model.user.canScheduleSearch()),n=this.model.report.canEmbed(this.model.user.canScheduleSearch(),this.model.user.canEmbed()),r=v.normalizeBoolean(this.model.report.entry.content.get("embed.enabled"));return this.el.innerHTML=this.compiledTemplate({_:e}),this.children.creatorView.render().appendTo(this.$("dd.creator")),this.children.appView.render().appendTo(this.$("dd.app")),this.children.scheduleView.render().appendTo(this.$("dd.schedule")),this.children.accelerationView.render().appendTo(this.$("dd.acceleration")),this.children.permissionsView.render().appendTo(this.$("dd.permissions")),this.children.embedView.render().appendTo(this.$("dd.embed")),t&&!r&&(this.model.user.canScheduleSearch()&&!this.model.report.isRealTime()&&this.children.editScheduleView.render().appendTo(this.$("dd.schedule")),this.model.user.canAccelerateReport()&&this.children.editAccelerationView.render().appendTo(this.$("dd.acceleration")),this.model.report.entry.acl.get("can_change_perms")&&this.children.editPermissionsView.render().appendTo(this.$("dd.permissions"))),n&&this.children.editEmbedView.render().appendTo(this.$("dd.embed")),this.model.searchJob&&this.model.searchJob.isPreparing()&&this.$("a.edit-acceleration").css("display","none"),this.model.report.isPivotReport()&&(this.$("dt.acceleration").remove(),this.$("dd.acceleration").remove()),this},template:'            <dl class="list-dotted">                <!--TODO when these attributes exist-->                <!--<dt class="history"><%- _("History").t() %></dt>                    <dd class="history"></dd>-->                <dt class="creator"><%- _("Creator").t() %></dt>                    <dd class="creator"></dd>                <dt class="app"><%- _("App").t() %></dt>                    <dd class="app"></dd>                <dt class="schedule"><%- _("Schedule").t() %></dt>                    <dd class="schedule"></dd>                <dt class="acceleration"><%- _("Acceleration").t() %></dt>                    <dd class="acceleration"></dd>                <dt class="permissions"><%- _("Permissions").t() %></dt>                    <dd class="permissions"></dd>                <dt class="embed"><%- _("Embedding").t() %></dt>                    <dd class="embed"></dd>            </dl>        '})}),define("views/dashboards/panelcontrols/titledialog/Modal",["underscore","jquery","backbone","module","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/FlashMessages"],function(e,t,n,r,i,s,o){return s.extend({moduleId:r.id,initialize:function(){s.prototype.initialize.apply(this,arguments);var t="display.general.title";this.model.workingReport=new n.Model,this.model.workingReport.set(t,this.model.report.entry.content.get(t,{tokens:!0})),this.children.flashMessages=new o({model:this.model.dashboard}),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.children.panelTitleControlGroup=new i({label:e("Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:t,placeholder:e("optional").t()}}),this.listenTo(this.model.report,"successfulSave",this.hide,this)},events:t.extend({},s.prototype.events,{"click .modal-btn-primary":"onSave"}),onSave:function(e){var t=this.model.workingReport.get("display.general.title");e.preventDefault(),this.model.report.trigger("saveTitle",t)},render:function(){this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(e("Edit Title").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(this.children.panelTitleControlGroup.render().el),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE)}})}),define("splunkjs/mvc/simpleform/formutils",["require","exports","module","underscore","jquery","splunkjs/mvc","splunkjs/mvc/simplexml/controller"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("splunkjs/mvc"),o=e("splunkjs/mvc/simplexml/controller"),u={},a={submitForm:r.debounce(function(e){if(!a.isFormReady()){a.onFormReady().then(r.bind(a.submitForm,a,e));return}e||(e={});var t=s.Components.getInstance("default",{create:!0}),n=s.Components.getInstance("submitted");n&&n.set(t.toJSON());var i=s.Components.getInstance("url");i&&i.saveOnlyWithPrefix("form\\.",t.toJSON(),{replaceState:e.replaceState})}),handleValueChange:function(e){var t=e.vizSettings,n=t.get("type"),i=s.Components.getInstance("default",{create:!0}),o=a.getInputTypeSettings(n),u=t.get("token");if(n==="time"){if(!t.get("value")){var f=t.get("default"),l=t.get("preset");f?e.val(f):l?e.visualization._onTimePresetUpdate():t.set("value",{earliest_time:"",latest_time:""});return}if(u){var c=e.val(),h={};h[u+".earliest"]=c.earliest_time||"",h[u+".latest"]=c.latest_time||"",i.set(h)}}else{if(!e.hasValue()){e.defaultUpdate=!0,e.val(t.get("default"));return}var p=e.val();if(p===undefined){i.set(u,p),e.defaultUpdate=!1,a._handleAutoSubmit(e);return}if(o.multiValue){if(p===null||p.length===0){i.set(u,undefined),e.defaultUpdate=!1,a._handleAutoSubmit(e);return}var d=t.has("valuePrefix")?t.get("valuePrefix"):"",v=t.has("valueSuffix")?t.get("valueSuffix"):"",m=t.has("delimiter")?t.get("delimiter"):" ";p=r(p).map(function(e){return d+e+v}).join(m)}var g="";if(p){var y=t.get("prefix");y&&(g+=y),g+=p;var b=t.get("suffix");b&&(g+=b)}i.set(u,g)}a._handleAutoSubmit(e)},_handleAutoSubmit:function(e,t){var n=e.vizSettings,r=n.get("searchWhenChanged")===!0||n.get("searchWhenChanged")==null&&!s.Components.get("submit");r&&(!a.isFormReady()&&e.defaultUpdate?e.defaultUpdate=!1:a.submitForm())},getInputType:function(e){var t=u[e];if(!t)throw new Error("Unkonwn input type: "+e);return t.clazz},getInputTypeSettings:function(e){var t=u[e];if(!t)throw new Error("Unkonwn input type: "+e);return t.settings},registerInputType:function(e,t,n){u[e]={clazz:t,settings:n}},onFormReady:r.once(function(){var e=i.Deferred();return o.onReady(function(){var t=a.getFormInputs();if(t.length>0){var n=r(t).invoke("_onReady");i.when.apply(i,n).always(e.resolve)}else e.resolve()}),e.promise()}),isFormReady:function(){return a.onFormReady().state()==="resolved"},isFormInput:function(e){return e&&e._isDashboardInput},getFormInputs:function(){return r(s.Components.toJSON()).filter(a.isFormInput)}};return a}),define("views/dashboards/PanelTimeRangePicker",["require","exports","module","underscore","jquery","views/Base","views/shared/controls/ControlGroup","util/console","uri/route","splunkjs/mvc","splunkjs/mvc/simpleform/formutils","splunkjs/mvc/tokenutils","splunk.util","bootstrap.tooltip"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("views/Base"),o=e("views/shared/controls/ControlGroup"),u=e("util/console"),a=e("uri/route"),f=e("splunkjs/mvc"),l=e("splunkjs/mvc/simpleform/formutils"),c=e("splunkjs/mvc/tokenutils"),h=e("splunk.util");return e("bootstrap.tooltip"),s.extend({moduleId:t.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.timeRange.on("applied",function(){this.updateReportTime(),this.updateTime()},this);var e=r(f.Components.toJSON()).chain().values().filter(function(e){return l.isFormInput(e)&&e.settings?e.settings.get("type")=="time":!1}).map(function(e){var t=e.settings.get("token")||"global",n=h.sprintf(r("Shared Time Picker (%s)").t(),t);return{value:t,label:n}}).value(),t="search",n=c.hasToken(this.model.report.get("dispatch.earliest_time"))&&c.hasToken(this.model.report.get("dispatch.latest_time"));if(n){var i=c.getTokenName(this.model.report.get("dispatch.earliest_time")),u=i.replace(/\.?earliest$/g,"");u=u===""?"global":u;var a=c.getTokenName(this.model.report.get("dispatch.latest_time")),p=a.replace(/\.?latest$/g,"");p=p===""?"global":p,this.model.timeRange.set({earliest_token:i,latest_token:a}),u===p&&r(e).find(function(e){return e.value===u})?t=u:t="tokens"}this.model.timeRange.set({useTimeFrom:t}),e.length>0?this.children.timeScope=new o({label:r("Time Range Scope").t(),controlType:"SyntheticSelect",controlOptions:{className:"btn-group time-range-scope-select",toggleClassName:"btn",groupedItems:[{items:e},{items:[{label:r("Explicit Selection").t(),value:"search"}]},{items:[{label:r("Tokens").t(),value:"tokens"}]}],model:this.model.timeRange,popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"},modelAttribute:"useTimeFrom",elastic:!0}}):this.model.timeRange.set("useTimeFrom","search"),this.children.advancedEarliest=new o({label:r("Earliest Token").t(),controlType:"Text",controlOptions:{model:this.model.timeRange,modelAttribute:"earliest_token"}}),this.children.advancedLatest=new o({label:r("Latest Token").t(),controlType:"Text",controlOptions:{model:this.model.timeRange,modelAttribute:"latest_token"}}),this.listenTo(this.model.timeRange,"change:useTimeFrom",this.updateTokens,this)},updateReportTime:function(){this.model.report.set({"dispatch.earliest_time":this.model.timeRange.get("earliest"),"dispatch.latest_time":this.model.timeRange.get("latest")},{tokens:!0})},updateTokens:function(){this.toggleTimeRangePicker(),this.toggleAdvancedTokens()},toggleAdvancedTokens:function(){this.model.timeRange.get("useTimeFrom")==="tokens"?(this.children.advancedEarliest.$el.show(),this.children.advancedLatest.$el.show()):(this.children.advancedEarliest.$el.hide(),this.children.advancedLatest.$el.hide())},toggleTimeRangePicker:function(){this.model.timeRange.get("useTimeFrom")==="search"?this.$(".timerange").show():this.$(".timerange").hide()},updateTime:function(){var e=this.model.timeRange.generateLabel(this.collection);this.$el.find("span.time-label").text(e)},render:function(){return this.children.timeScope&&this.children.timeScope.render().appendTo(this.el),this.children.advancedEarliest.render().$el.appendTo(this.$el),this.children.advancedLatest.render().$el.appendTo(this.$el),this.$el.append('<div class="timerange" style="display: block;"><label class="control-label">'+r("Time Range").t()+"</label></div>"),this.$("div.timerange").append('<div class="controls"><a href="#" class="btn timerange-control"><span class="time-label"></span><span class="icon-triangle-right-small"></span></a></div>'),this.toggleTimeRangePicker(),this.toggleAdvancedTokens(),this.updateTime(),this}})}),define("views/dashboards/panelcontrols/querydialog/Modal",["underscore","jquery","module","views/shared/controls/ControlGroup","views/shared/delegates/ModalTimerangePicker","views/shared/timerangepicker/dialog/Master","views/shared/Modal","models/shared/TimeRange","collections/services/data/ui/Times","splunk.util","splunkjs/mvc/utils","views/Base","uri/route","util/time","bootstrap.tooltip","util/console","splunkjs/mvc","views/shared/FlashMessages","views/dashboards/PanelTimeRangePicker","splunkjs/mvc/tokenawaremodel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){function w(e,t){return t?[e.replace(/[\|\s]$/g,""),t.replace(/^[\|\s]/g,"")].join(" | "):e}var E=u.extend({validation:e.extend({earliest_token:function(e,t,n){if(n.useTimeFrom==="tokens"&&!e)return"No value specified for earliest token."},latest_token:function(e,t,n){if(n.useTimeFrom==="tokens"&&!e)return"No value specified for latest token."}},u.prototype.validation)});return o.extend({moduleId:n.id,className:"modal edit-search-string",initialize:function(){o.prototype.initialize.apply(this,arguments),this.model.workingReport=new b(e.pick(this.model.report.entry.content.toJSON({tokens:!0}),["search","dispatch.earliest_time","dispatch.latest_time"]),{applyTokensByDefault:!0,retrieveTokensByDefault:!0}),this.children.title=new r({label:e("Title").t(),controlType:"Label",controlClass:"controls-block",controlOptions:{model:this.model.report.entry.content,modelAttribute:"display.general.title"}}),this.children.searchStringInput=new r({label:e("Search String").t(),controlType:"Textarea",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"search"}}),this.model.report.isPivotReport()?this.children.searchStringInput.options.help='<a href="#" class="run-pivot">'+e("Run Pivot").t()+' <i class="icon-external"></i></a>':this.children.searchStringInput.options.help='<a href="#" class="run-search">'+e("Run Search").t()+' <i class="icon-external"></i></a>',this.collection=this.collection||{},this.collection.times=new a,this.collection.times.fetch({data:{app:this.model.application.get("app"),owner:this.model.application.get("owner")}}),this.model.timeRange=new E,this.children.timeRangePickerView=new s({model:{state:this.model.workingReport,timeRange:this.model.timeRange,application:this.model.application,user:this.model.user,appLocal:this.model.appLocal},collection:this.collection.times,appendSelectDropdownsTo:".modal:visible"}),this.model.timeRange.on("applied",function(){this.timeRangeDelegate.closeTimeRangePicker()},this),this.children.panelTimeRangePicker=new y({model:{timeRange:this.model.timeRange,report:this.model.workingReport,state:this.model.state},collection:this.collection.times}),this.children.flashMessages=new g({model:this.model.dashboard}),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.listenTo(this.model.report,"successfulSave",this.hide,this)},events:t.extend({},o.prototype.events,{"click .modal-btn-primary":function(t){t.preventDefault();var n=this.model.timeRange.get("useTimeFrom"),r=n=="global"?"":n+".";this.children.flashMessages.flashMsgCollection.reset();if(n==="tokens"){var i=this.model.timeRange.validate();if(i){e.each(i,function(t){this.children.flashMessages.flashMsgCollection.add({key:"token-"+t,type:"error",html:e.escape(e(t).t())})},this);return}var s=this.model.timeRange.get("earliest_token"),o=this.model.timeRange.get("latest_token");this.model.workingReport.set({"dispatch.earliest_time":"$"+s+"$","dispatch.latest_time":"$"+o+"$"},{tokens:!0})}else n!=="search"?this.model.workingReport.set({"dispatch.earliest_time":"$"+r+"earliest$","dispatch.latest_time":"$"+r+"latest$"},{tokens:!0}):this.model.workingReport.set({"dispatch.earliest_time":this.model.timeRange.get("earliest")||"0","dispatch.latest_time":this.model.timeRange.get("latest")||""});var u=this.model.workingReport.toJSON();v.log("Applying attributes to report model: %o",u),this.model.report.trigger("updateSearchString",u)},"click a.run-search":function(e){e.preventDefault();var t=this.model.workingReport.get("search",{tokens:!1}),n=this.model.report.entry.content;if(n.get("display.general.search.type")==="postprocess"){var r=m.Components.get(n.get("display.general.managerid")).parent.settings.resolve();t=w(r,t)}if(!t)return;var i={q:t};this.model.workingReport.has("dispatch.earliest_time")&&(i.earliest=this.model.workingReport.get("dispatch.earliest_time",{tokens:!1}||"0"),i.latest=this.model.workingReport.get("dispatch.latest_time",{tokens:!1})||"");var s=l.getPageInfo(),o=h.search(s.root,s.locale,s.app,{data:i});l.redirect(o,!0)},"click a.run-pivot":function(e){e.preventDefault();var t=this.model.workingReport.get("search",{tokens:!1}),n={q:t};if(!t)return;this.model.workingReport.has("dispatch.earliest_time")&&(n.earliest=this.model.workingReport.get("dispatch.earliest_time",{tokens:!1}),n.latest=this.model.workingReport.get("dispatch.latest_time",{tokens:!1}));var r=l.getPageInfo(),i=h.pivot(r.root,r.locale,r.app,{data:n});l.redirect(i,!0)}}),handleSubmitButtonState:function(e){this.$(o.FOOTER_SELECTOR).find(".btn-primary")[e.get("elementCreateType")==="pivot"?"addClass":"removeClass"]("disabled")},render:function(){this.$el.html(o.TEMPLATE),this.$(o.HEADER_TITLE_SELECTOR).html(e("Edit Search").t()),this.$(o.BODY_SELECTOR).remove(),this.$(o.FOOTER_SELECTOR).before('<div class="vis-area"><div class="slide-area"><div class="content-wrapper query-dialog-wrapper"><div class="'+o.BODY_CLASS+'" >'+"</div>"+"</div>"+'<div class="timerange-picker-wrapper">'+"</div>"+"</div>"+"</div>"),this.$visArea=this.$(".vis-area").eq(0),this.$slideArea=this.$(".slide-area").eq(0),this.$editSearchContent=this.$(".query-dialog-wrapper").eq(0),this.$timeRangePickerWrapper=this.$(".timerange-picker-wrapper").eq(0),this.$modalParent=this.$el,this.$(o.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(o.BODY_SELECTOR).append(o.FORM_HORIZONTAL_JUSTIFIED),this.children.title.render().appendTo(this.$(o.BODY_FORM_SELECTOR)),this.children.searchStringInput.render().appendTo(this.$(o.BODY_FORM_SELECTOR));var t=this.model.timeRange.save({earliest:this.model.workingReport.get("dispatch.earliest_time",{tokens:!1}||"0"),latest:this.model.workingReport.get("dispatch.latest_time",{tokens:!1}||"now")});return t.done(e.bind(function(){this.$(o.BODY_FORM_SELECTOR).append(this.children.panelTimeRangePicker.render().el)},this)),this.$timeRangePickerWrapper.append(this.children.timeRangePickerView.render().el),this.timeRangeDelegate=new i({el:this.el,$visArea:this.$visArea,$slideArea:this.$slideArea,$contentWrapper:this.$editSearchContent,$timeRangePickerWrapper:this.$timeRangePickerWrapper,$modalParent:this.$modalParent,$timeRangePicker:this.children.timeRangePickerView.$el,activateSelector:"a.timerange-control",backButtonSelector:"a.btn.back"}),this.$(o.FOOTER_SELECTOR).append(o.BUTTON_CANCEL),this.$(o.FOOTER_SELECTOR).append(o.BUTTON_SAVE),this.$(o.FOOTER_SELECTOR).append('<a href="#" class="btn back modal-btn-back pull-left">'+e("Back").t()+"</a>"),this.$(".btn.back").hide(),this}})}),define("views/dashboards/panelcontrols/ReportDialog",["jquery","underscore","backbone","module","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/FlashMessages","splunk.util","uri/route","collections/search/Reports","splunkjs/mvc/utils","splunk.config"],function(e,t,n,r,i,s,o,u,a,f,l,c){return s.extend({moduleId:r.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.workingReport=new n.Model,this.model.workingReport.set({title:""}),this.model.workingReport.set("id",this.model.report.get("id")),this.children.flashMessage=new o({model:this.model.dashboard}),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.listenTo(this.model.report,"successfulManagerChange",this.hide,this),this.controller=this.options.controller,this.controller.reportsCollection||this.controller.fetchCollection(),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){this.ready=!0;var e=this.controller.reportsCollection.map(function(e){return{label:e.entry.get("name"),value:e.id}}),n=a.reports(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"));this.controller.reportsCollection.length===this.controller.reportsCollection.REPORTS_LIMIT?this.children.reportsControlGroup=new i({label:t("Select Report").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"id",items:e,toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},help:t("This does not contain all reports. Add a report that is not listed from ").t()+u.sprintf("<a href=%s>%s</a>.",n,t("Reports").t())}):this.children.reportsControlGroup=new i({label:t("Select Report").t(),controlType:"SyntheticSelect",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"id",items:e,toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}})},this)),this.children.panelTitleControlGroup=new i({label:t("Panel Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"title",placeholder:t("optional").t()}})},events:e.extend({},s.prototype.events,{"click .modal-btn-primary":"onSave"}),onSave:function(e){e.preventDefault(),this.model.report.trigger("updateReportID",this.model.workingReport.get("id"),this.model.workingReport.get("title"))},render:function(){this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(t("Select a New Report").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(s.LOADING_HORIZONTAL),this.$(s.LOADING_SELECTOR).html(t("Loading...").t()),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){this.$(s.LOADING_SELECTOR).remove(),this.$(s.BODY_FORM_SELECTOR).append(this.children.reportsControlGroup.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.panelTitleControlGroup.render().el)},this)),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE)}})}),define("views/dashboards/panelcontrols/CreateReportDialog",["jquery","underscore","backbone","module","views/shared/controls/ControlGroup","views/shared/Modal","views/shared/FlashMessages"],function(e,t,n,r,i,s,o){return s.extend({moduleId:r.id,initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.workingReport=new n.Model({name:this.model.report.entry.content.get("display.general.title")}),this.children.flashMessagesReport=new o({model:this.model.report}),this.children.flashMessagesDashboard=new o({model:this.model.dashboard}),this.on("hide",this.model.report.error.clear,this.model.report.error),this.on("hide",this.model.dashboard.error.clear,this.model.dashboard.error),this.children.reportNameControlGroup=new i({label:t("Report Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"name"}}),this.children.reportDescriptionControlGroup=new i({label:t("Description").t(),controlType:"Textarea",controlClass:"controls-block",controlOptions:{model:this.model.workingReport,modelAttribute:"description",placeholder:t("optional").t()}}),this.listenTo(this.model.report,"successfulReportSave",this.hide,this)},events:e.extend({},s.prototype.events,{"click .modal-btn-primary":"onSave"}),onSave:function(e){e.preventDefault(),this.model.report.trigger("saveAsReport",this.model.workingReport.get("name"),this.model.workingReport.get("description"))},render:function(){this.$el.html(s.TEMPLATE),this.$(s.HEADER_TITLE_SELECTOR).html(t("Convert to Report").t()),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessagesDashboard.render().el),this.$(s.BODY_SELECTOR).prepend(this.children.flashMessagesReport.render().el),this.$(s.BODY_SELECTOR).append(s.FORM_HORIZONTAL),this.$(s.BODY_FORM_SELECTOR).append(this.children.reportNameControlGroup.render().el),this.$(s.BODY_FORM_SELECTOR).append(this.children.reportDescriptionControlGroup.render().el),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_CANCEL),this.$(s.FOOTER_SELECTOR).append(s.BUTTON_SAVE)}})}),define("views/ValidatingView",["jquery","backbone","underscore","views/Base","util/general_utils"],function(e,t,n,r,i){return r.extend({modelToControlGroupMap:{},stopListening:function(){this.tearDownValidation(),r.prototype.stopListening.apply(this,arguments)},setupValidation:function(e,r){if(n.isUndefined(e))throw"The model or collection you passed into views/Base.setupValidation is undefined";e instanceof t.Model?this._setupModelValidationListener(e):e instanceof t.Collection&&(e.each(function(e){this._setupModelValidationListener(e)}),e.on("add",function(e){this._setupModelValidationListener(e)},this),e.on("remove",function(e){e.off("validated",this._modelValidatedHandler,this)},this)),this.__flashMessagesHelper__=r,this.__flashMessagesHelper__.register(this)},tearDownValidation:function(){this.__flashMessagesHelper__&&this.__flashMessagesHelper__.unregister(this)},_setupModelValidationListener:function(e){e.on("validated",this._modelValidatedHandler,this)},_modelValidatedHandler:function(e,t,r){var s=[];if(this.modelToControlGroupMap){var o=i.invert(this.modelToControlGroupMap);o=n.reduce(n.keys(o||{}),function(e,t){return e[t]=void 0,e},{}),n(r).each(function(e,t){r[t]={message:e,label:""}}),n(r).each(function(e,t){var r=this.modelToControlGroupMap[t],i=e.message,s,u="";n.isUndefined(r)?s=i.replace(/\{(label)\}/g,t):(this.children[r].options.label&&(u=this.children[r].options.label),s=i.replace(/\{(label)\}/g,u||t),o[r]=s),e.message=s,e.label=u},this),n(o).each(function(e,t){n.isUndefined(e)?this.children[t].error(!1,""):this.children[t].error(!0,e)},this)}else n(r).each(function(e,t){e.message=e.message.replace(/\{(label)\}/g,t)});this.trigger("validated",e,t,r,this)}})}),define("views/shared/dialogs/DialogBase",["jquery","underscore","backbone","views/ValidatingView","module","util/console","bootstrap.transition","bootstrap.modal"],function(e,t,n,r,i,s){var o=13,u='input[type="text"], input[type="password"], textarea';return r.extend({moduleId:i.id,className:"modal fade",attributes:{tabIndex:-1},settings:undefined,bodyClassName:"modal-body-scrolling",initialize:function(e){r.prototype.initialize.call(this,e),e=e||{},this.$el.modal({show:!1,keyboard:!0}),t.isUndefined(e.bodyClassName)||(this.bodyClassName=e.bodyClassName),this.settings=new n.Model,this.settings.set("footerTemplate",this._footerTemplate),this.settings.set("headerTemplate",this._headerTemplate),this.settings.on("change:primaryButtonLabel change:cancelButtonLabel change:titleLabel",this.debouncedRender,this),this.$el.on("click.dialog",".btn-dialog-primary",t.bind(function(e){e.preventDefault(),this.primaryButtonClicked()},this)),this.$el.on("click.dialog",".btn-dialog-cancel",t.bind(function(e){e.preventDefault(),this.cancelButtonClicked()},this)),this.$el.on("click.dialog",".btn-dialog-close",t.bind(function(e){e.preventDefault(),this.closeButtonClicked()},this)),this.$el.on("keypress",t.bind(function(e){e.which===o&&this.submitKeyPressed(e)},this)),this.$el.on("shown",t.bind(function(e){if(e.target!==e.currentTarget)return;this.dialogShown()},this)),this.$el.on("hide",t.bind(function(e){if(e.target!==e.currentTarget)return;this.cleanup()},this)),this.$el.on("hidden",t.bind(function(e){if(e.target!==e.currentTarget)return;this.trigger("hidden")},this))},render:function(){this.$(".modal-header").detach(),this.$(".modal-body").detach(),this.$(".modal-footer").detach();var e=this.compiledTemplate({bodyClassName:this.bodyClassName,showFooter:this.shouldRenderFooter()});return this.$el.html(e),this.renderHeader(this.$(".modal-header")),this.renderBody(this.$(".modal-body")),this.shouldRenderFooter()&&this.renderFooter(this.$(".modal-footer")),this},hide:function(){this.$el.modal("hide")},show:function(){this.$el.modal("show")},primaryButtonClicked:function(){this.trigger("click:primaryButton",this)},cancelButtonClicked:function(){this.trigger("click:cancelButton",this)},closeButtonClicked:function(){this.trigger("click:closeButton",this)},submitKeyPressed:function(t){var n=e(t.target);n.is(u)&&(n.blur(),this.primaryButtonClicked())},dialogShown:function(){this.trigger("show"),t.debounce(function(){this.setFocus()}.bind(this),0)();return},setFocus:function(){this.$("input:text:enabled:visible:first").focus()},cleanup:function(){this.trigger("hide");return},shouldRenderFooter:function(){return this.settings.has("primaryButtonLabel")||this.settings.has("cancelButtonLabel")},renderBody:function(e){},renderHeader:function(e){e.html(this.settings.get("headerTemplate")),e.find(".text-dialog-title").html(this.settings.get("titleLabel"))},renderFooter:function(e){e.html(this.settings.get("footerTemplate"));var t=e.find(".btn-dialog-primary.label_from_data");this.settings.has("primaryButtonLabel")?(t.html(this.settings.get("primaryButtonLabel")),t.show()):(t.html(""),t.hide());var n=e.find(".btn-dialog-cancel.label_from_data");this.settings.has("cancelButtonLabel")?(n.html(this.settings.get("cancelButtonLabel")),n.show()):(n.html(""),n.hide())},template:'                <div class="modal-header"></div>                <div class="modal-body <%- bodyClassName %>"></div>                <% if (showFooter) { %>                    <div class="modal-footer"></div>                <% } %>            ',_footerTemplate:'                <a href="#" class="btn btn-dialog-cancel label_from_data pull-left" data-dismiss="modal"></a>                <a href="#" class="btn btn-primary btn-dialog-primary label_from_data pull-right"></a>            ',_headerTemplate:'                <button type="button" class="close btn-dialog-close" data-dismiss="modal">x</button>                <h3 class="text-dialog-title"></h3>            '})}),define("views/shared/dialogs/TextDialog",["jquery","underscore","views/shared/dialogs/DialogBase","module","views/shared/FlashMessages"],function(e,t,n,r,i){return n.extend({moduleId:r.id,_text:"",initialize:function(e){n.prototype.initialize.call(this,e),this.settings.set("primaryButtonLabel",t("Ok").t()),this.settings.set("cancelButtonLabel",t("Cancel").t()),this.options.flashModel&&(this.children.flashMessages=new i({model:this.options.flashModel}),this.on("hide",this.options.flashModel.error.clear,this.options.flashModel.error)),this.on("hidden",this.remove,this),this.doDefault=!0},primaryButtonClicked:function(){n.prototype.primaryButtonClicked.call(this),this.doDefault&&this.hide()},setText:function(e){this._text=e,this.debouncedRender()},closeDialog:function(){this.hide(),this.remove()},preventDefault:function(){this.doDefault=!1},renderBody:function(e){e.html(this.bodyTemplate),e.find(".text-dialog-placeholder").html(this._text),this.children.flashMessages&&e.find(".text-dialog-placeholder").prepend(this.children.flashMessages.render().el)},bodyTemplate:'                <span class="text-dialog-placeholder"></span>            '})}),define("views/dashboards/panelcontrols/Master",["underscore","views/Base","models/Base","jquery","module","views/shared/controls/SyntheticSelectControl","views/shared/delegates/Popdown","views/shared/reportcontrols/details/Master","collections/services/authorization/Roles","models/shared/Application","views/dashboards/panelcontrols/titledialog/Modal","views/dashboards/panelcontrols/querydialog/Modal","views/dashboards/panelcontrols/ReportDialog","views/dashboards/panelcontrols/CreateReportDialog","uri/route","util/console","splunk.util","views/shared/dialogs/TextDialog","bootstrap.tooltip"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b=t.extend({moduleId:i.id,initialize:function(e){t.prototype.initialize.apply(this,arguments),this.model.report.on("change:id",this.updateReportView,this),this.model.report.entry.content.on("change",this.updateReportView,this),this.collection=this.collection||{},this.collection.roles=new a({}),this.collection.roles.fetch()},onChangeElementTitle:function(e){e.preventDefault(),this.children.titleDialogModal=new l({model:{report:this.model.working,dashboard:this.model.dashboard},onHiddenRemove:!0}),r("body").append(this.children.titleDialogModal.render().el),this.children.titleDialogModal.show(),this.children.popdown.hide()},onChangeSearchString:function(e){e.preventDefault();if(r(e.currentTarget).is(".disabled"))return;this.children.queryDialogModal=new c({model:{report:this.model.report,appLocal:this.model.appLocal,application:this.model.application,user:this.model.user,dashboard:this.model.dashboard,state:this.model.state},onHiddenRemove:!0}),r("body").append(this.children.queryDialogModal.render().el),this.children.queryDialogModal.show(),this.children.popdown.hide()},updateReportView:function(){this.debouncedRender()},render:function(){var e,t={};return this.model.report.get("id")?e=this.model.report.isPivotReport()?"icon-report-pivot":"icon-report-search":e=this.model.report.isPivotReport()?"icon-pivot":"icon-search-thin",t.panelClass=e,this.$el.html(this.compiledTemplate(t)),this.children.popdown=new o({el:this.el,mode:"dialog"}),this._renderPanelControls(),this},_renderPanelControls:function(){this.$(".dropdown-menu").html(e.template(this._panelControlsTemplate,{_:e}));var t;this.model.report.get("id")?t=this.model.report.isPivotReport()?e("PIVOT REPORT").t():e("SEARCH REPORT").t():t=this.model.report.isPivotReport()?e("INLINE PIVOT").t():e("INLINE SEARCH").t();var n=e.template('<li class="panelType"><%- panelType %></li>',{panelType:t});if(this.model.report.get("id")){var i=e.template('<ul class="report_actions"><%= panelTypeLI %><li><a class="viewPanelReport" href="#"><%- reportName %><span class="icon-triangle-right-small"></span></a></li></ul>',{panelTypeLI:n,reportName:this.model.report.entry.get("name")});this.$(".panel_actions").before(i),this.$(".panel_actions").prepend('<li><a href="#" class="changeElementTitle">'+e("Edit Title").t()+"</a></li>")}else{var s=r('<li><a class="convertToReport" href="#">'+e("Convert to Report").t()+"</a></li>"),o=r('<li><a href="#" class="changeSearchString">'+e("Edit Search String").t()+"</a></li>");this.model.report.entry.content.get("display.general.search.type")==="global"&&(s.find("a").addClass("disabled").tooltip({animation:!1,title:e("Cannot convert global search to report.").t()}),o.find("a").addClass("disabled").tooltip({animation:!1,title:e("Cannot edit global search.").t()})),this.$(".panel_actions").prepend(s),this.$(".panel_actions").prepend(o),this.$(".panel_actions").prepend('<li><a href="#" class="changeElementTitle">'+e("Edit Title").t()+"</a></li>"),this.$(".panel_actions").prepend(n)}},_panelControlsTemplate:'                <div class="arrow"></div>                <ul class="panel_actions">                    <li><a class="deletePanel" href="#"><%- _("Delete").t() %></a></li>                </ul>        ',template:'            <a class="dropdown-toggle btn-pill" href="#">                    <span class="<%- panelClass %>"></span><span class="caret"></span>            </a>            <div class="dropdown-menu">            </div>        ',onDelete:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_delete",flashModel:this.model.dashboard}),this.model.report.on("successfulDelete",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("primaryButtonLabel",e("Delete").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._dialogDeleteHandler,this),this.children.dialog.settings.set("titleLabel",e("Delete").t()),this.children.dialog.setText(m.sprintf(e("Are you sure you want to delete %s?").t(),"<em>"+e.escape(this.model.report.entry.content.get("display.general.title"))+"</em>")),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},_dialogDeleteHandler:function(e){e.preventDefault(),this.model.report.trigger("deleteReport"),v.log("deleteReport event triggered")},onViewPanelReport:function(t){t.preventDefault(),t.stopPropagation();var n="",i,s,o=this.model.application.get("root"),a=this.model.application.get("locale"),f=this.model.application.get("app");i=d.report(o,a,f,{data:{s:this.model.report.get("id")}}),this.model.report.isPivotReport()?(n=this.pivotReportDetailsTemplate,s=d.pivot(o,a,f,{data:{s:this.model.report.get("id")}})):(n=this.searchReportDetailsTemplate,s=d.search(o,a,f,{data:{s:this.model.report.get("id")}})),this.$(".dropdown-menu").html(e.template(n,{viewReportLink:i,editReportLink:s,_:e})),this.children.reportDetails&&this.children.reportDetails.remove(),this.children.reportDetails=new u({model:{report:this.model.report,application:this.model.application,appLocal:this.model.appLocal,user:this.model.user},collection:this.collection.roles}),this.$(".reportDetails").prepend(r("<li/>").addClass("reportDetailsView").append(this.children.reportDetails.render().el));var l=this.model.report.entry.content.get("description");l&&this.$(".reportDetails").prepend(r("<li/>").addClass("report-description").text(l)),this.$(".reportDetails").prepend(r("<li/>").addClass("report-name").text(this.model.report.entry.get("name"))),this.$(".dropdown-menu").addClass("show-details"),r(window).trigger("resize")},searchReportDetailsTemplate:'            <div class="arrow"></div>            <a class="dialogBack btn" href="#"><span class="icon-chevron-left"/> <%- _("Back").t() %></a>            <ul class="reportDetails">                <li><a href="<%- viewReportLink %>" class="viewSearchReport"><%- _("View").t() %></a></li>                <li><a href="<%- editReportLink %>" class="openSearchReport"><%- _("Open in Search").t() %></a></li>                <li><a href="#" class="cloneSearchReport"><%- _("Clone to an Inline Search").t() %></a></li>            </ul>            <ul class="reportActions">                <li><a href="#" class="selectNewReport"><%- _("Select New Report").t() %></a></li>                <li><a href="#" class="useReportFormatting"><%- _("Use Report\'s Formatting for this Content").t() %></a></li>            </ul>        ',pivotReportDetailsTemplate:'            <div class="arrow"></div>            <a class="dialogBack btn" href="#"><span class="icon-chevron-left"/> <%- _("Back").t() %></a>            <ul class="reportDetails">                <li><a href="<%- viewReportLink %>" class="viewPivotReport"><%- _("View").t() %></a></li>                <li><a href="<%- editReportLink %>" class="openPivotReport"><%- _("Open in Pivot").t() %></a></li>                <li><a href="#" class="clonePivotReport"><%- _("Clone to an Inline Pivot").t() %></a></li>            </ul>            <ul class="reportActions">                <li><a class="selectNewReport"><%- _("Select New Report").t() %></a></li>                <li><a class="useReportFormatting"><%- _("Use Report\'s Formatting for this Content").t() %></a></li>            </ul>        ',onDialogBack:function(e){e.preventDefault(),e.stopPropagation(),this._renderPanelControls(),this.$(".dropdown-menu").removeClass("show-details"),r(window).trigger("resize")},tbd:function(e){e.preventDefault(),alert("Coming soon to a Splunk near you!")},convertToInlineSearch:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_inline",flashModel:this.model.dashboard}),this.children.dialog.settings.set("primaryButtonLabel",e("Clone to Inline Search").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._convertToInlineSearch,this),this.model.report.on("successfulManagerChange",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("titleLabel",e("Clone to Inline Search").t()),this.children.dialog.setText("<div>                <p>"+e("The report will be cloned to an inline search.").t()+"</p>                <p>"+e("The inline search:").t()+"                </p><ul>                <li>"+e("Cannot be scheduled.").t()+"</li>                <li>"+e("Will run every time the dashboard is loaded.").t()+"</li>                <li>"+e("Will use the permissions of the dashboard.").t()+"</li>                </ul>                </div>"),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},convertToInlinePivot:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_inline",flashModel:this.model.dashboard}),this.children.dialog.settings.set("primaryButtonLabel",e("Clone to Inline Pivot").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._convertToInlineSearch,this),this.model.report.on("successfulManagerChange",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("titleLabel",e("Clone to Inline Pivot").t()),this.children.dialog.setText("<div>                <p>"+e("The report will be cloned to an inline pivot.").t()+"</p>                <p>"+e("The inline pivot:").t()+"                </p><ul>                <li>"+e("Cannot be scheduled.").t()+"</li>                <li>"+e("Will run every time the dashboard is loaded.").t()+"</li>                <li>"+e("Will use the permissions of the dashboard.").t()+"</li>                </ul>                </div>"),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},_convertToInlineSearch:function(e){e.preventDefault(),this.model.report.trigger("makeInline"),v.log("makeInline event triggered")},useReportFormatting:function(t){t.preventDefault(),this.children.dialog=new g({id:"modal_use_report_formatting",flashModel:this.model.dashboard}),this.children.dialog.settings.set("primaryButtonLabel",e("Use Report's Formatting").t()),this.children.dialog.settings.set("cancelButtonLabel",e("Cancel").t()),this.children.dialog.on("click:primaryButton",this._useReportFormatting,this),this.model.report.on("successfulReportFormatting",this.children.dialog.closeDialog,this.children.dialog),this.children.dialog.settings.set("titleLabel",e("Use Report's Formatting").t()),this.children.dialog.setText(e("This will change the content's formatting to the report's formatting. Are you sure you want use the report's formatting?").t()),r("body").append(this.children.dialog.render().el),this.children.dialog.show(),this.children.popdown.hide()},_useReportFormatting:function(e){e.preventDefault(),this.model.report.trigger("useReportFormatting"),v.log("useReportFormatting event triggered")},selectNewReport:function(e){e.preventDefault(),this.children.newReportDialog=new h({model:{report:this.model.report,dashboard:this.model.dashboard,application:this.model.application},controller:this.options.controller,onHiddenRemove:!0}),r("body").append(this.children.newReportDialog.render().el),this.children.newReportDialog.show(),this.children.popdown.hide()},convertToReport:function(e){e.preventDefault();if(r(e.currentTarget).is(".disabled"))return;this.children.createReportDialog=new p({model:{report:this.model.report,dashboard:this.model.dashboard},onHiddenRemove:!0}),r("body").append(this.children.createReportDialog.render().el),this.children.createReportDialog.show(),this.children.popdown.hide()},events:{"click a.deletePanel":"onDelete","click a.viewPanelReport":"onViewPanelReport","click a.changeElementTitle":"onChangeElementTitle","click a.changeSearchString":"onChangeSearchString","click a.dialogBack":"onDialogBack","click a.cloneSearchReport":"convertToInlineSearch","click a.clonePivotReport":"convertToInlinePivot","click a.selectNewReport":"selectNewReport","click a.convertToReport":"convertToReport","click a.useReportFormatting":"useReportFormatting","click a":function(e){var t=r(e.currentTarget).attr("href");t&&t[t.length-1]!=="#"&&(e.preventDefault(),window.open(t))},"click li.reportDetailsView a":function(e){this.children.popdown.hide()}}});return b}),define("splunkjs/mvc/simplexml/paneleditor",["require","exports","module","../mvc","../basesplunkview","views/shared/vizcontrols/Master","views/dashboards/panelcontrols/Master","../savedsearchmanager","../searchmanager","splunkjs/mvc/utils","underscore","splunk.config","models/Base","util/console","./controller","../tokenawaremodel","models/dashboards/DashboardReport"],function(e,t,n){var r=e("../mvc"),i=e("../basesplunkview"),s=e("views/shared/vizcontrols/Master"),o=e("views/dashboards/panelcontrols/Master"),u=e("../savedsearchmanager"),a=e("../searchmanager"),f=e("splunkjs/mvc/utils"),l=e("underscore"),c=e("splunk.config"),h=e("models/Base"),p=e("util/console"),d=e("./controller"),v=e("../tokenawaremodel"),m=e("models/dashboards/DashboardReport"),g=m.extend({initialize:function(e,t){m.prototype.initialize.apply(this,arguments),this._report=t.report,this.entry.content=new v({},{applyTokensByDefault:!0,retrieveTokensByDefault:!0}),this.setFromSplunkD(this._report.toSplunkD()),this.contentSyncer=f.syncModels({source:this._report.entry.content,dest:this.entry.content,auto:"push"}),this.entrySyncer=f.syncModels({source:this._report.entry,dest:this.entry,auto:"push"})},save:function(e,t){return e&&this.set(e,t),this._report.entry.set(this.entry.toJSON()),this._report.entry.content.set(this.entry.content.toJSON({tokens:!0})),this._report.saveXML(t)},syncOff:function(){this.contentSyncer.destroy(),this.entrySyncer.destroy(),this.off()}}),y=i.extend({className:"panel-editor",initialize:function(){this.children=this.children||{},i.prototype.initialize.call(this),this.model=this.model||{},this.model.report=this.model.report||new m,this.model.working=new g({},{report:this.model.report}),this.model.application=d.model.app,this.manager=this.options.manager,this._instantiateChildren(),this.bindToComponent(this.manager,this.onManagerChange,this),this.listenTo(this.model.report,"makeInline",this._makePanelInline,this),this.listenTo(this.model.report,"useReportFormatting",this._useReportFormatting,this),this.listenTo(this.model.report,"updateReportID",this._updateReportID,this),this.listenTo(this.model.report,"saveAsReport",this._saveAsReport,this),this.listenTo(this.model.report,"updateSearchString",this._updateSearchManager,this),this.listenTo(this.model.report,"deleteReport",this._deleteReport,this),this.listenTo(this.model.working,"saveTitle",this._saveTitle,this),this.model.user=d.model.user,this.model.appLocal=d.model.appLocal},_instantiateChildren:function(){this.children.vizControl=new s({model:{report:this.model.working,application:this.model.application},vizTypes:["events","statistics","visualizations"],saveOnApply:!0,dashboard:!0}),this.children.panelControl=new o({model:{report:this.model.report,working:this.model.working,application:this.model.application,appLocal:this.model.appLocal,user:this.model.user,dashboard:d.model.view,state:d.getStateModel()},controller:d})},remove:function(){this.model.working.syncOff(),this._removeChildren(),i.prototype.remove.apply(this,arguments)},_removeChildren:function(){this.children.vizControl.remove(),this.children.panelControl.remove()},_updateSearchManager:function(e){var t=this.model.report.toSplunkD();this.model.report.entry.content.set(e);var n=this.model.report.saveXML();n.done(l.bind(function(){this.model.report.trigger("successfulSave");var e=r.Components.get(this.manager);e.settings&&(e.settings.set("search",this.model.report.entry.content.get("search",{tokens:!0}),{tokens:!0,silent:!1}),e.settings.set({earliest_time:this.model.report.entry.content.get("dispatch.earliest_time",{tokens:!0}),latest_time:this.model.report.entry.content.get("dispatch.latest_time",{tokens:!0})},{tokens:!0}))},this)),n.fail(l.bind(function(){this.model.report.setFromSplunkD(t,{silent:!1})},this))},onManagerChange:function(){this._removeChildren(),this._instantiateChildren(),this.render()},render:function(){return this.$el.append(this.children.panelControl.render().el),this.$el.append(this.children.vizControl.render().el),this},_makePanelInline:function(){var e=this.model.report.toSplunkD(),t=this.model.report.entry.get("name"),n=this.model.report.get("id");delete this.model.report.id,this.model.report.unset("id",{silent:!0}),this.model.report.entry.unset("name",{silent:!0});var r=this.model.report.saveXML();r.fail(l.bind(function(){this.model.report.setFromSplunkD(e,{silent:!1})},this)),r.done(l.bind(function(){this.model.report.trigger("successfulManagerChange"),new a({id:this.manager,latest_time:this.model.report.entry.content.get("dispatch.latest_time"),earliest_time:this.model.report.entry.content.get("dispatch.earliest_time"),search:this.model.report.entry.content.get("search"),app:f.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0}),this.model.report.set({id:n},{silent:!0}),this.model.report.unset("id",{silent:!1}),this.model.report.entry.set({name:t},{silent:!0}),this.model.report.entry.unset("name",{silent:!1})},this))},_useReportFormatting:function(){var e=this.model.report.toSplunkD(),t=this.model.report.fetch({},{silent:!0});t.done(l.bind(function(){var t=this.model.report.toSplunkD(),n=this.model.report.saveXML({clearOptions:!0});n.fail(l.bind(function(){this.model.report.setFromSplunkD(e,{silent:!1})},this)),n.done(l.bind(function(){this.model.report.setFromSplunkD(e,{silent:!0}),this.model.report.setFromSplunkD(t,{silent:!1}),this.model.report.trigger("successfulReportFormatting")},this))},this))},_updateReportID:function(e,t){var n=this.model.report.toSplunkD();e&&(this.model.report.set({id:e},{silent:!0}),this.model.report.entry.set({id:e},{silent:!0}),this.model.report.id=e),t&&this.model.report.entry.content.set({"display.general.title":t});var r=this.model.report.fetch({},{silent:!0});r.done(l.bind(function(){var e=this.model.report.saveXML();e.fail(l.bind(function(){this.model.report.setFromSplunkD(n,{silent:!1})},this)),e.done(l.bind(function(){this.model.report.trigger("successfulManagerChange"),new u({id:this.manager,searchname:this.model.report.entry.get("name"),app:f.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0})},this))},this))},_saveAsReport:function(e,t){var n=this.model.report.toSplunkD();this.model.report.entry.content.set({name:e,description:t,"display.general.title":e}),this.model.report.entry.set({name:e},{silent:!0}),this.model.report.entry.content.get("display.general.search.type")==="postprocess"&&this.model.report.entry.content.set("search",r.Components.get(this.manager).settings.resolve());var i=this.model.report.save({},{data:{app:f.getCurrentApp(),owner:c.USERNAME}});i.done(l.bind(function(){var t=this.model.report.saveXML();t.fail(l.bind(function(){this.model.report.destroy(),this.model.report.unset("id",{silent:!0}),this.model.report.setFromSplunkD(n,{silent:!1})},this)),t.done(l.bind(function(){this.model.report.trigger("successfulReportSave"),new u({id:this.manager,searchname:e,app:f.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0})},this))},this))},_saveTitle:function(e){var t=this.model.report.toSplunkD();this.model.working.entry.content.set({"display.general.title":e});var n=this.model.working.save();n.fail(l.bind(function(){this.model.report.setFromSplunkD(t,{silent:!1})},this)),n.done(l.bind(function(){this.model.working.trigger("successfulSave"),this.model.report.entry.content.set({"display.general.title":""},{silent:!1}),this.model.report.entry.content.set({"display.general.title":e},{silent:!1})},this))},_deleteReport:function(){var e=this.model.report.deleteXML();e.done(l.bind(function(){this.model.report.trigger("successfulDelete"),this.model.report.trigger("removedPanel")},this))}});return y}),define("splunkjs/mvc/simplexml/element/base",["require","underscore","jquery","backbone","../../basesplunkview","../../../mvc","../../utils","../controller","models/dashboards/DashboardReport","util/console","../../progressbarview","../../refreshtimeindicatorview","../../resultslinkview","../paneleditor","../../savedsearchmanager","../../postprocessmanager","../../messages","../../tokenutils","util/general_utils"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../basesplunkview"),s=e("../../../mvc"),o=e("../../utils"),u=e("../controller"),a=e("models/dashboards/DashboardReport"),f=e("util/console"),l=e("../../progressbarview"),c=e("../../refreshtimeindicatorview"),h=e("../../resultslinkview"),p=e("../paneleditor"),d=e("../../savedsearchmanager"),v=e("../../postprocessmanager"),m=e("../../messages"),g=e("../../tokenutils"),y=e("util/general_utils"),b=!1,w={},E=(new a).fetch(),S=i.extend({initialVisualization:"#abstract",configure:function(){this.options.settingsOptions=t.extend({retainUnmatchedTokens:!0},this.options.settingsOptions||{}),this.options=t.extend(this.options,{id:this.id,manager:this.options.managerid,title:this.$("h3").text()}),b&&this.options.settingsOptions.tokens!==!0&&f.warn("element created without tokens=true: "+this.id),i.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.visualization=null,this.model=new a,this.managerid=this.options.managerid,this.settings._sync=o.syncModels(this.settings,this.model.entry.content,{auto:!0,prefix:"display.general.",include:["id","title","manager","managerid"]}),this.bindToComponent(this.managerid,this.onManagerChange,this);var e=this.typeModel=new r.Model({type:this.initialVisualization});this.reportReady=n.Deferred(),this.listenTo(this.typeModel,"change",this.createVisualization,this),this.listenTo(u.getStateModel(),"change:edit",this.onEditModeChange,this),this.reportReady.done(t.bind(function(){this.listenTo(this.model.entry.content,"change:display.general.type change:display.visualizations.type change:display.events.type",function(t){var n=t.get("display.general.type"),r=["display",n,"type"].join("."),i=t.get(r),s=i?[n,i].join(":"):n;e.set("type",w.hasOwnProperty(s)?s:n)},this),this.listenTo(this.settings,"change:title",this.updateTitle,this),this.listenTo(this.model,"removedPanel",this.remove,this)},this)),this._setupTokenDependencies()},remove:function(){this._removeVisualization(),t([this.refreshTime,this.panelEditor]).chain().filter(t.identity).invoke("remove"),this.settings&&this.settings._sync&&this.settings._sync.destroy(),s.Components.get("dashboard").removeElement(this.id),i.prototype.remove.call(this)},onManagerChange:function(e,n){var r=this;if(n instanceof d){var i=n.get("searchname"),s=u.getStateModel().app,o=!this.model.entry.content.has("display.general.type");this.model.id=["","servicesNS",encodeURIComponent(s.get("owner")),encodeURIComponent(s.get("app")),"saved","searches",encodeURIComponent(i)].join("/"),this.model.fetch({tokens:!1}).done(function(){o&&r.model.entry.content.set(r._initialVisualizationToAttributes()),r.reportReady.resolve(r.model)}).fail(function(e){f.error("Failed to load saved search",arguments),e.status===404&&r.showErrorMessage(t("Warning: saved search not found: ").t()+JSON.stringify(i))})}else n?E.done(function(e){r.model.entry.content.has("display.general.type")||(r.model.entry.content.set(e.entry[0].content,{tokens:!1}),r.initialVisualization!=="#abstract"&&r.model.entry.content.set(r._initialVisualizationToAttributes()));var t="inline";n instanceof v?(t="postprocess",r.model.entry.content.set("fullSearch",n.settings.resolve())):n.has("metadata")&&n.get("metadata").global&&(t="global"),r.model.entry.content.set("display.general.search.type",t),r.model.entry.content.set({search:n.get("search",{tokens:!0}),"dispatch.earliest_time":n.get("earliest_time",{tokens:!0}),"dispatch.latest_time":n.get("latest_time",{tokens:!0})},{tokens:!0}),r.reportReady.resolve(r.model)}):E.done(function(e){r.model.entry.content.has("display.general.type")||(r.model.entry.content.set(e.entry[0].content,{tokens:!1}),r.initialVisualization!=="#abstract"&&r.model.entry.content.set(r._initialVisualizationToAttributes())),r.reportReady.resolve(r.model)})},showErrorMessage:function(e){this._removeInitialPlaceholder();var t=this.$(".panel-body>.msg");t.length||(t=n('<div class="msg"></div>').appendTo(this.$(".panel-body"))),m.render({level:"error",icon:"warning-sign",message:e},t)},_initialVisualizationToAttributes:function(){var e=this.initialVisualization.split(":"),t={"display.general.type":e[0]};return e.length>1&&(t[["display",e[0],"type"].join(".")]=e[1]),t},onEditModeChange:function(e){var n=this._debouncedOnEditModeChange;n||(n=this._debouncedOnEditModeChange=t.debounce(t.bind(this._onEditModeChange,this),0)),this.reportReady.done(function(){n(e)})},_onEditModeChange:function(e){e.get("edit")?(this.refreshTime&&(this.refreshTime.remove(),this.refreshTime=null),this.updateTitle(),this.createPanelElementEditor(),this.$el.is(".hidden")&&this.$el.show().parents(".dashboard-panel").trigger("elementVisibilityChanged")):(this.panelEditor&&(this.panelEditor.remove(),this.panelEditor=null),this.createRefreshTimeIndicator(),this.updateTitle(),this.$el.is(".hidden")&&this.$el.hide().parents(".dashboard-panel").trigger("elementVisibilityChanged"))},_setupTokenDependencies:function(){var e=this.settings.get("tokenDependencies",{tokens:!0});if(e){var n=this,r=s.Components,i=e.depends?g.getTokens(e.depends,{tokenNamespace:"submitted"}):[],o=e.rejects?g.getTokens(e.rejects,{tokenNamespace:"submitted"}):[],u=i.concat(o);function a(e){return r.get(e.namespace).has(e.name)}function f(){t(i).all(a)&&!t(o).any(a)?n.show():n.hide()}t(u).each(function(e){var t=r.get(e.namespace);n.listenTo(t,"change:"+e.name,f,n)}),f()}},hide:function(){this.$el.is(".hidden")||(u.getStateModel().get("edit")||this.$el.hide(),this.$el.addClass("hidden").parents(".dashboard-panel").trigger("elementVisibilityChanged"))},show:function(){this.$el.is(".hidden")&&(this.$el.show().removeClass("hidden").parents(".dashboard-panel").trigger("elementVisibilityChanged"),this.visualization&&this.visualization.render())},createPanelElementEditor:function(){this.panelEditor&&(this.panelEditor.remove(),this.panelEditor=null),this.panelEditor=new p({manager:this.managerid,model:{report:this.model}}),this.$el.prepend(this.panelEditor.render().el)},createRefreshTimeIndicator:function(){var e=this.settings.get("refresh.time.visible"),r=e===undefined||y.normalizeBoolean(e,{"default":!1}),i=this.settings.get("refresh.auto.interval");!this.refreshTime&&(r||i)&&(this.refreshTime=(new c({id:t.uniqueId(this.id+"-refreshtime"),el:n('<div class="refresh-time-indicator pull-right"></div>').prependTo(this.$(".panel-head")),manager:this.managerid,"refresh.auto.interval":this.settings.get("refresh.auto.interval"),"refresh.time.visible":this.settings.get("refresh.time.visible")})).render())},createVisualization:function(e){var r=this._debouncedCreateViz;r||(r=this._debouncedCreateViz=t.debounce(t.bind(this._createVisualization,this),0)),n.when(this.reportReady).then(function(){r(e===!0)})},_removeVisualization:function(){this.visualization&&(this.visualization.panelClassName&&this.$el.removeClass(this.visualization.panelClassName),this.visualization.off(),this.visualization.remove(),this.visualization=null),this.resultsLink&&(this.resultsLink.off(),this.resultsLink.remove(),this.resultsLink=null)},_removeInitialPlaceholder:function(){this.$(".panel-body > .msg, .panel-body > .initial-placeholder").remove()},_createVisualization:function(e){var r=!this.visualization;this._removeInitialPlaceholder(),this._removeVisualization();var i=this.typeModel.get("type"),o=w[i];if(!o){this.showErrorMessage(t("Unsupported visualization type: ").t()+JSON.stringify(i));return}var u={el:n("<div></div>").appendTo(this.$(".panel-body")),reportModel:this.model.entry.content,managerid:this.settings.get("manager"),id:t.uniqueId(this.id+"-viz-")};if(r||e)u=t.extend({},this.options,u);u.settingsOptions&&(u.settingsOptions.retainUnmatchedTokens=!1),b&&(u.settingsOptions||{}).tokens!==!0&&f.warn("viz created without tokens=true: "+u.id),this.visualization=(new o(u)).render(),this.visualization.panelClassName&&this.$el.addClass(this.visualization.panelClassName);if(i.indexOf("events")===0){var a=s.Components.getInstance(this.settings.get("manager"));a.settings.set("status_buckets",300)}this.trigger("create:visualization",this.visualization),r&&this.model.entry.content.set(t.defaults(this.model.entry.content.toJSON({tokens:!0}),this.visualization.reportDefaults));if(typeof this.visualization.getResultsLinkOptions=="function"){var l=this.visualization.getResultsLinkOptions(this.options)||{};this.resultsLink=(new h(t.extend({},l,this.options,{id:t.uniqueId(this.id+"-resultslink"),el:n('<div class="view-results pull-left"></div>').appendTo(this.$(".panel-footer")),manager:this.managerid,model:this.model}))).render()}this.visualization.on("all",this.trigger,this)},getVisualization:function(e){var t=n.Deferred();return e&&t.done(e),this.visualization?t.resolve(this.visualization):this.once("create:visualization",t.resolve,t),t.promise()},render:function(){return this.createPanelStructure(),this.progressBar||(this.progressBar=(new l({id:t.uniqueId(this.id+"-progressbar"),manager:this.managerid,el:n('<div class="progress-container pull-right"></div>').prependTo(this.$(".panel-footer"))})).render()),this.createRefreshTimeIndicator(),this.createVisualization(),this.onEditModeChange(u.getStateModel()),this},createPanelStructure:function(){this.$(".panel-head").length||n('<div class="panel-head"></div>').prependTo(this.$el);var e=this.$(".panel-head>h3");e.length||n("<h3></h3>").prependTo(this.$(".panel-head")),this.updateTitle(),this.$(".panel-body").length||n('<div class="panel-body"></div>').appendTo(this.$el);var t=n('<div class="initial-placeholder"></div>').addClass("placeholder-"+this.initialVisualization.replace(/\W+/,"-"));t.appendTo(this.$(".panel-body")),this.$("panel-footer").length||n('<div class="panel-footer"></div>').appendTo(this.$el)},updateTitle:function(){var e=this.settings.get("title")||"";u.getStateModel().get("edit")&&!e?this.$(".panel-head>h3").empty().append(n('<span class="untitled">'+t("Untitled Panel").t()+"</span>")):this.$(".panel-head>h3").text(e)},getExportParams:function(e){var t=s.Components.get(this.managerid),n={};return t&&!(t instanceof v)&&t.job&&t.job.sid&&(n[e]=t.job.sid),n}},{registerVisualization:function(e,t){w[e]=t},getVisualization:function(e){var t=w[e];return t||(t=w[e.split(":")[0]]),t}});return S}),define("splunkjs/mvc/simplexml/dialog/addpanel/inline",["require","underscore","jquery","views/Base","views/shared/controls/ControlGroup","util/console","../../../utils","uri/route","util/time","views/dashboards/PanelTimeRangePicker","bootstrap.tooltip"],function(e){var t=e("underscore"),n=e("jquery"),r=e("views/Base"),i=e("views/shared/controls/ControlGroup"),s=e("util/console"),o=e("../../../utils"),u=e("uri/route"),a=e("util/time"),f=e("views/dashboards/PanelTimeRangePicker");return e("bootstrap.tooltip"),r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments),this.children.searchField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"search",model:this.model.report},label:t("Search String").t(),help:'<a href="#" class="run-search">'+t("Run Search").t()+' <i class="icon-external"></i></a>'}),this.listenTo(this.model.report,"change:elementCreateType",this.onModeChange,this),this.children.panelTimeRangePicker=new f({model:{timeRange:this.model.timeRange,report:this.model.report,state:this.model.state},collection:this.collection}),this.model.report.set({"dispatch.earliest_time":this.model.timeRange.get("earliest"),"dispatch.latest_time":this.model.timeRange.get("latest")},{tokens:!0})},events:{"click a.run-search":function(e){e.preventDefault();var t=this.model.report.get("search"),n={q:t},r=o.getPageInfo();if(!t)return;this.model.report.has("dispatch.earliest_time")&&(n.earliest=this.model.report.get("dispatch.earliest_time"),n.latest=this.model.report.get("dispatch.latest_time")),o.redirect(u.search(r.root,r.locale,r.app,{data:n}),!0)}},onModeChange:function(){var e=this.model.report.get("elementCreateType")==="inline"?"show":"hide";this.$el[e]()},render:function(){return this.children.searchField.render().appendTo(this.el),this.children.panelTimeRangePicker.render().appendTo(this.el),this.onModeChange(),this}})}),define("splunkjs/mvc/simplexml/dialog/addpanel/report",["require","underscore","jquery","views/Base","views/shared/controls/ControlGroup","../../../utils","util/time","models/shared/Cron","splunk.util","uri/route","collections/services/SavedSearches","views/shared/Modal"],function(e){var t=e("underscore"),n=e("jquery"),r=e("views/Base"),i=e("views/shared/controls/ControlGroup"),s=e("../../../utils"),o=e("util/time"),u=e("models/shared/Cron"),a=e("splunk.util"),f=e("uri/route"),l=e("collections/services/SavedSearches"),c=e("views/shared/Modal");return r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments),this.children.reportPlaceholder=new r,this.controller=this.options.controller,this.controller.reportsCollection||this.controller.fetchCollection(),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){var e=this.controller.reportsCollection.map(function(e){return{label:e.entry.get("name"),value:e.entry.get("name")}}),n=s.getPageInfo(),r=f.reports(n.root,n.locale,n.app);this.controller.reportsCollection.length===this.controller.reportsCollection.REPORTS_LIMIT?this.children.report=new i({label:"",controlType:"SyntheticSelect",controlOptions:{className:"btn-group add-panel-report",toggleClassName:"btn",model:this.model,modelAttribute:"savedSearchName",items:e,popdownOptions:this.options.popdownOptions||{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},help:t("This does not contain all reports. Add a report that is not listed from ").t()+a.sprintf("<a href=%s>%s</a>.",r,t("Reports").t())}):this.children.report=new i({label:"",controlType:"SyntheticSelect",controlOptions:{className:"btn-group add-panel-report",toggleClassName:"btn",model:this.model,modelAttribute:"savedSearchName",items:e,popdownOptions:this.options.popdownOptions||{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}}),this.model.get("savedSearchName")||this.model.set("savedSearchName",e[0].value)},this)),this.children.searchField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"savedSearchString",model:this.model},label:t("Search String").t(),help:'<a href="#" class="run-search">'+t("Run Search").t()+' <i class="icon-external"></i></a>'}),this.children.timerangeField=new i({controlType:"Label",controlOptions:{modelAttribute:"savedSearchTimerange",model:this.model},label:t("Time Range").t()}),this.children.schedule=new i({controlType:"Label",controlOptions:{modelAttribute:"savedSearchSchedule",model:this.model},label:t("Schedule").t()}),this.children.permissions=new i({controlType:"Label",controlOptions:{modelAttribute:"savedSearchPermissions",model:this.model},label:t("Permissions").t()}),this.model.set("savedSearchString","..."),this.listenTo(this.model,"change:elementCreateType",this.onModeChange,this),this.listenTo(this.model,"change:savedSearchName",this.searchSelected,this)},events:{"click a.run-search":function(e){e.preventDefault();var t=this.model.get("savedSearchName");if(!t)return;var n=s.getPageInfo(),r=f.search(n.root,n.locale,n.app,{data:{s:t}});s.redirect(r,!0)}},searchSelected:function(){var e=this.model.get("savedSearchName"),n=this.controller.reportsCollection.find(function(t){return t.entry.get("name")===e});if(!n)return;this.model.set("savedSearch",n.get("id")),this.model.set("savedSearchString",n.entry.content.get("search"));var r=n.entry.content.get("dispatch.earliest_time"),i=n.entry.content.get("dispatch.latest_time"),s="statistics",f;n.entry.content.has("display.general.type")&&(s=n.entry.content.get("display.general.type"),f=["display",s,"type"].join("."),n.entry.content.has(f)&&(s=[s,n.entry.content.get(f)].join(":"))),this.model.set("savedSearchVisualization",s),this.model.set("savedSearchTimerange",o.generateLabel(this.collection.timeRanges,r,null,i,null));var l=t("Never").t();if(n.entry.content.get("is_scheduled")){var c=u.createFromCronString(n.entry.content.get("cron_schedule"));l=c.getScheduleString()}this.model.set("savedSearchSchedule",l),this.model.set("savedSearchPermissions",a.sprintf(t("%s. Owned by %s.").t(),n.entry.acl.get("perms")?t("Shared").t():t("Not Shared").t(),n.entry.acl.get("owner")))},onModeChange:function(){this.$el[this.model.get("elementCreateType")==="saved"?"show":"hide"](),this.model.get("elementCreateType")==="saved"&&this.controller.reportsCollection.initialFetchDfd.readyState!==4&&this.$(c.LOADING_SELECTOR).length===0&&(this.$el.append(c.LOADING_HORIZONTAL),this.$(c.LOADING_SELECTOR).html(t("Loading...").t()))},render:function(){return this.children.reportPlaceholder.render().appendTo(this.el),this.controller.reportsCollection.initialFetchDfd.done(t.bind(function(){this.$(c.LOADING_SELECTOR).length>0&&this.$(c.LOADING_SELECTOR).remove(),this.children.report.render().appendTo(this.children.reportPlaceholder.el),this.searchSelected(),this.children.searchField.render().appendTo(this.el),this.children.searchField.$("textarea").attr("readonly","readonly"),this.children.timerangeField.render().appendTo(this.el),this.children.schedule.render().appendTo(this.el),this.children.permissions.render().appendTo(this.el),this.onModeChange()},this)),this}})}),define("splunkjs/mvc/simplexml/dialog/addpanel/pivot",["require","underscore","views/Base","../../../utils","uri/route"],function(e){var t=e("underscore"),n=e("views/Base"),r=e("../../../utils"),i=e("uri/route");return n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:elementCreateType",this.onModeChange,this)},render:function(){if(!this.el.innerHTML){var e=r.getPageInfo();this.$el.html(t.template(this.template,{pivotLink:i.pivot(e.root,e.locale,e.app)}))}return this.onModeChange(),this},onModeChange:function(){var e=this.model.get("elementCreateType")==="pivot"?"show":"hide";this.$el[e]()},template:'<label class="control-label"></label><div class="controls">'+t("Use the Pivot tool to summarize Data Model information and add it as a dashboard panel. You'll need to know the name of this dashboard when you save from the Pivot tool.").t()+"</div>"})}),define("splunkjs/mvc/simplexml/dialog/addpanel/master",["require","exports","module","underscore","jquery","splunkjs/mvc","views/Base","views/shared/controls/ControlGroup","../../controller","./inline","./report","./pivot","util/console"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("splunkjs/mvc"),o=e("views/Base"),u=e("views/shared/controls/ControlGroup"),a=e("../../controller"),f=e("./inline"),l=e("./report"),c=e("./pivot"),h=e("util/console");return o.extend({moduleId:t.id,className:"add-panel",initialize:function(){o.prototype.initialize.apply(this,arguments),this.children.panelTitleControlGroup=new u({label:r("Content Title").t(),controlType:"Text",controlClass:"controls-block",controlOptions:{model:this.model.report,modelAttribute:"title",placeholder:r("optional").t()}}),this.children.elementCreateType=new u({label:r("Content Type").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group btn-group-3 add-panel-select",items:[{value:"inline",label:'<i class="icon-search-thin"></i>',tooltip:r("Inline Search").t()},{value:"pivot",label:'<i class="icon-pivot"></i>',tooltip:r("Inline Pivot").t()},{value:"saved",label:'<i class="icon-report"></i>',tooltip:r("Report").t()}],model:this.model.report,modelAttribute:"elementCreateType"}});var e=a.collection.times;this.children.inline=new f({model:this.model,collection:{timeRanges:e}}),this.children.report=new l({model:this.model.report,collection:{timeRanges:e},controller:this.options.controller}),this.children.pivot=new c({model:this.model.report})},render:function(){return this.$el.append(this.children.panelTitleControlGroup.render().el),this.$el.append(this.children.elementCreateType.render().el),this.$el.append(this.children.inline.render().el),this.$el.append(this.children.pivot.render().el),this.$el.append(this.children.report.render().el),this}})}),define("splunkjs/mvc/simplexml/dialog/addpanel",["require","exports","module","underscore","jquery","splunkjs/mvc","views/shared/Modal","models/Base","../../utils","../controller","../element/base","../mapper","./addpanel/master","../../searchmanager","../../savedsearchmanager","util/console","views/shared/timerangepicker/dialog/Master","models/shared/TimeRange","views/shared/delegates/ModalTimerangePicker","../controller","uri/route","views/shared/FlashMessages"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("splunkjs/mvc"),o=e("views/shared/Modal"),u=e("models/Base"),a=e("../../utils"),f=e("../controller"),l=e("../element/base"),c=e("../mapper"),h=e("./addpanel/master"),p=e("../../searchmanager"),d=e("../../savedsearchmanager"),v=e("util/console"),m=e("views/shared/timerangepicker/dialog/Master"),g=e("models/shared/TimeRange"),y=e("views/shared/delegates/ModalTimerangePicker"),b=e("../controller"),w=e("uri/route"),E=e("views/shared/FlashMessages"),S=u.extend({defaults:{elementCreateType:"inline","dispatch.earliest_time":"0","dispatch.latest_time":""},validation:{search:{fn:"validateSearchQuery"}},validateSearchQuery:function(e,t,n){if(n.elementCreateType==="inline"&&!e)return"Search string is required."},sync:function(e,t,n){v.log("NewPanelModel.sync(%o, %o, %o)",e,t,n);if(e!=="create")throw new Error("Unsupported sync method: "+e);if(!t.isValid())return!1;var o=i.Deferred(),u=this.get("elementCreateType"),h,m=1;do h="element"+m++;while(s.Components.has(h));var g=u==="saved"?this.get("savedSearchVisualization")||"visualizations:charting":"visualizations:charting",y=c.get(g);return f.getStateModel().view.addElement(h,{type:y.tagName,title:this.get("title"),search:{type:u,search:this.get("search"),earliest_time:this.get("dispatch.earliest_time"),latest_time:this.get("dispatch.latest_time"),name:this.get("savedSearchName")}}).done(r.bind(function(){var e=s.Components.get("dashboard").createNewElement({title:this.get("title"),id:h}),t=r.uniqueId("new-search");switch(u){case"inline":new p({id:t,search:this.get("search"),earliest_time:this.get("dispatch.earliest_time")||"0",latest_time:this.get("dispatch.latest_time")||"",app:a.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0,runOnSubmit:!0},{tokens:!0});break;case"saved":new d({id:t,searchname:this.get("savedSearchName"),app:a.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0})}var n=l.extend({initialVisualization:g}),i=new n({id:h,managerid:t,el:e},{tokens:!0});i.render(),o.resolve()},this)),o.promise()}}),x=g.extend({validation:r.extend({earliest_token:function(e,t,n){if(n.useTimeFrom==="tokens"&&!e)return"No value specified for earliest token."},latest_token:function(e,t,n){if(n.useTimeFrom==="tokens"&&!e)return"No value specified for latest token."}})});return o.extend({moduleId:t.id,className:"modal add-panel",initialize:function(){o.prototype.initialize.apply(this,arguments),this.model=this.model||{},this.model.report=new S,this.model.timeRange=new x({earliest:"0",latest:""});var e=f.model.app,t=f.model.user,n=f.model.appLocal,r=f.collection.times;this.children.addPanel=new h({model:{report:this.model.report,timeRange:this.model.timeRange,state:b.getStateModel()},collection:{times:r},controller:this.options.controller}),this.children.timeRangePickerView=new m({model:{timeRange:this.model.timeRange,user:t,appLocal:n,application:e},collection:r,appendSelectDropdownsTo:".modal:visible"}),this.children.flashMessages=new E({model:this.model}),this.model.timeRange.on("applied",function(){this.timeRangeDelegate.closeTimeRangePicker()},this),this.listenTo(this.model.report,"change:elementCreateType",this.handleSubmitButtonState,this)},events:{"click a.modal-btn-primary":function(e){if(this.model.report.get("elementCreateType")==="pivot")return;e.preventDefault(),f.getStateModel().set("edit",!1);var t=this,n=this.model.timeRange.get("useTimeFrom"),i=n=="global"?"":n+".",s=this.model.report.validate();if(n==="tokens"){var o=this.model.timeRange.validate();o&&(s=s?r.extend(s,o):o)}if(s){this.children.flashMessages.flashMsgCollection.reset(),r.each(s,function(e){this.children.flashMessages.flashMsgCollection.add({key:"addpanel-"+e,type:"error",html:r.escape(r(e).t())})},this);return}n==="tokens"?this.model.report.set({"dispatch.earliest_time":"$"+this.model.timeRange.get("earliest_token")+"$","dispatch.latest_time":"$"+this.model.timeRange.get("latest_token")+"$",useTimeFrom:"tokens"},{tokens:!0}):n!=="search"&&this.model.report.set({"dispatch.earliest_time":"$"+i+"earliest$","dispatch.latest_time":"$"+i+"latest$"},{tokens:!0});var u=this.model.report.save();u?u.done(function(){setTimeout(function(){f.getStateModel().set("edit",!0)},250),t.hide()}):f.getStateModel().set("edit",!0)},hide:function(e){e.target===this.el&&this.remove()}},handleSubmitButtonState:function(e){if(this.model.report.get("elementCreateType")==="pivot"){var t=a.getPageInfo();this.$(o.FOOTER_SELECTOR).find(".btn-primary").replaceWith('<a href="'+w.pivot(t.root,t.locale,t.app)+'" class="btn btn-primary modal-btn-primary">'+r("Go to Pivot").t()+"</a>")}else this.$(o.FOOTER_SELECTOR).find(".btn-primary").replaceWith('<a href="#" class="btn btn-primary modal-btn-primary">'+r("Add Panel").t()+"</a>")},setLabel:function(){var e=this.model.timeRange.generateLabel(this.collection);this.$el.find("span.time-label").text(e)},render:function(){return this.$el.html(o.TEMPLATE),this.$(o.HEADER_TITLE_SELECTOR).html(r("Add Panel").t()),this.$(o.BODY_SELECTOR).remove(),this.$(o.FOOTER_SELECTOR).before('<div class="vis-area"><div class="slide-area"><div class="content-wrapper add-panel-wrapper"><div class="'+o.BODY_CLASS+'" >'+"</div>"+"</div>"+'<div class="timerange-picker-wrapper">'+"</div>"+"</div>"+"</div>"),this.$(o.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(o.BODY_SELECTOR).append(o.FORM_HORIZONTAL_JUSTIFIED),this.$visArea=this.$(".vis-area").eq(0),this.$slideArea=this.$(".slide-area").eq(0),this.$addpanelContent=this.$(".add-panel-wrapper").eq(0),this.$timeRangePickerWrapper=this.$(".timerange-picker-wrapper").eq(0),this.$(o.BODY_FORM_SELECTOR).append(this.children.addPanel.render().el),this.$timeRangePickerWrapper.append(this.children.timeRangePickerView.render().el),this.$modalParent=this.$el,this.timeRangeDelegate=new y({el:this.el,$visArea:this.$visArea,$slideArea:this.$slideArea,$contentWrapper:this.$addpanelContent,$timeRangePickerWrapper:this.$timeRangePickerWrapper,$modalParent:this.$modalParent,$timeRangePicker:this.children.timeRangePickerView.$el,activateSelector:"a.timerange-control",backButtonSelector:"a.btn.back"}),this.$(o.FOOTER_SELECTOR).append(o.BUTTON_CANCEL),this.$(o.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+r("Add Panel").t()+"</a>"),this.$(o.FOOTER_SELECTOR).append('<a href="#" class="btn back modal-btn-back pull-left">'+r("Back").t()+"</a>"),this.$(".btn.back").hide(),this}})}),define("views/shared/documentcontrols/dialogs/TitleDescriptionDialog",["underscore","backbone","module","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,initialize:function(t){r.prototype.initialize.apply(this,arguments),this.model={inmem:this.model.clone(),report:this.model},this.children.flashMessage=new s({model:this.model.inmem}),this.children.titleField=new i({controlType:"Label",controlOptions:{modelAttribute:"name",model:this.model.inmem.entry},label:e("Title").t()}),this.children.descriptionField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.inmem.entry.content,placeholder:e("optional").t()},label:e("Description").t()}),this.on("hidden",function(){this.model.inmem.get("updated")>this.model.report.get("updated")&&this.model.report.entry.content.set("description",this.model.inmem.entry.content.get("description"))},this)},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){this.model.inmem.save({},{success:function(e,t){this.hide()}.bind(this)}),e.preventDefault()}}),render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Description").t()),this.children.flashMessage.render().prependTo(this.$(r.BODY_SELECTOR)),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.children.titleField.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.children.descriptionField.render().appendTo(this.$(r.BODY_FORM_SELECTOR)),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this}})}),define("views/shared/documentcontrols/dialogs/DeleteDialog",["underscore","backbone","module","models/search/Report","views/shared/Modal","views/shared/FlashMessages","uri/route","splunk.util"],function(e,t,n,r,i,s,o,u){return i.extend({moduleId:n.id,initialize:function(e){i.prototype.initialize.apply(this,arguments),this.children.flashMessage=new s({model:this.model.report})},events:$.extend({},i.prototype.events,{"click .btn-primary":function(e){var t=this.model.report.destroy({wait:!0});$.when(t).then(function(){this.hide(),this.options.deleteRedirect&&(this.model.report.isAlert()?window.location=o.alerts(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app")):window.location=o.reports(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app")))}.bind(this)),e.preventDefault()}}),render:function(){return this.$el.html(i.TEMPLATE),this.children.flashMessage.render().prependTo(this.$(i.BODY_SELECTOR)),this.model.report.isAlert()?this.$(i.HEADER_TITLE_SELECTOR).html(e("Delete Alert").t()):this.$(i.HEADER_TITLE_SELECTOR).html(e("Delete Report").t()),this.$(i.BODY_SELECTOR).append("<span>"+u.sprintf(e("Are you sure you want to delete %s?").t(),"<em>"+e.escape(this.model.report.entry.get("name"))+"</em>")+"</span>"),this.$(i.FOOTER_SELECTOR).append(i.BUTTON_CANCEL),this.$(i.FOOTER_SELECTOR).append(this.compiledTemplate({_:e})),this},template:'            <a href="#" class="btn btn-primary"><%- _("Delete").t() %></a>        '})}),define("views/dashboards/table/controls/ConvertSuccess",["jquery","underscore","module","views/shared/Modal","uri/route","views/shared/documentcontrols/dialogs/permissions_dialog/Master"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,options:{refreshOnDismiss:!1},initialize:function(){r.prototype.initialize.apply(this,arguments),this.options.refreshOnDismiss&&this.on("hide hidden",function(){window.location.reload()})},events:e.extend({},r.prototype.events,{"click .edit-perms":function(n){n.preventDefault();var r=this,i=r.model,o=r.collection.roles;t.defer(function(){var t=new s({model:{document:i.dashboard,nameModel:i.dashboard.entry.content,user:i.user},collection:o,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0});r.options.refreshOnDismiss&&t.on("hide hidden",function(){window.location.reload()}),e("body").append(t.render().el),t.show()}),r.options.refreshOnDismiss&&r.off("hide hidden"),r.hide(),r.remove()}}),render:function(){this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(t("Dashboard has been converted.").t()),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL);var e=this.model.dashboard.entry.acl.get("app"),n=this.model.dashboard.entry.get("name"),s=i.page(this.model.application.get("root"),this.model.application.get("locale"),e,n),o=i.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),this.model.dashboard.entry.get("name")),u="/manager/"+e+"/data/ui/views/"+n+"?action=edit&ns="+e+"&redirect_override="+encodeURIComponent(o);return this.$(r.BODY_FORM_SELECTOR).append(t.template(this.messageTemplate,{dashboardLink:s,_:t})),this.$(r.FOOTER_SELECTOR).append(t.template(this.buttonTemplate,{dashboardLink:s,editLink:u,_:t})),this.$(r.FOOTER_SELECTOR).append(""),this},buttonTemplate:'<a href="<%= editLink %>" class="btn edit-panels"><%- _("Edit HTML").t() %></a><a href="<%= dashboardLink %>" class="btn btn-primary modal-btn-primary"><%- _("View").t() %></a>',messageTemplate:'<p><%- _("You may now view your dashboard, change additional settings, or edit the HTML.").t() %></p><p><%- _("Additional Settings").t() %>:<ul><li><a href="#" class="edit-perms"><%- _("Permissions").t() %></a></li></ul></p>'})}),define("views/shared/delegates/PairedTextControls",["jquery","underscore","backbone","views/shared/controls/TextControl","views/shared/delegates/Base"],function(e,t,n,r,i){return i.extend({transformFunction:undefined,initialize:function(e){e=e||{},this.sourceDelegate=e.sourceDelegate,this.destDelegate=e.destDelegate,this.transformFunction=e.transformFunction;if(!(this.sourceDelegate instanceof r&&this.destDelegate instanceof r))throw new Error("SourceDelegate and destDelegate must be TextControls");this.enablePairing()},enablePairing:function(){this.sourceDelegate.on("keyup",this.sourceChangeHandler,this),this.destDelegate.on("keyup",this.destChangeHandler,this)},disablePairing:function(){this.sourceDelegate.off("keyup",this.sourceChangeHandler,this)},sourceChangeHandler:function(e,t){var n=t;this.transformFunction&&(n=this.transformFunction(t)),this.destDelegate.setValue(n)},destChangeHandler:function(e,t){e.keyCode!=9&&e.keyCode!=16&&(this.disablePairing(),this.destDelegate.off("keyup",this.destChangeHandler))}})}),define("views/dashboards/table/controls/ConvertDashboard",["underscore","jquery","module","views/shared/Modal","views/shared/controls/ControlGroup","models/Base","models/search/Dashboard","views/shared/FlashMessages","views/dashboards/table/controls/ConvertSuccess","views/shared/delegates/PairedTextControls","views/shared/controls/TextControl","util/splunkd_utils","uri/route","util/xml"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d={NEW:0,REPLACE:1};return r.extend({moduleId:n.id,initialize:function(){var t=this;r.prototype.initialize.apply(this,arguments),this.model.perms=new s({perms:"private"}),this.model.convertMode=new s({mode:d.NEW}),this.children.flashMessages=new u({model:{dashboard:this.model.dashboard,dashboardMeta:this.model.dashboard.meta}}),this.model.dashboard.meta.set({label:this.model.dashboard.meta.get("label")+e(" HTML").t()}),this.children.titleTextControl=new l({modelAttribute:"label",model:this.model.dashboard.meta,placeholder:e("optional").t(),save:!1}),this.children.filenameTextControl=new l({modelAttribute:"name",model:this.model.dashboard.entry.content,save:!1}),this.children.filenameTextControl.setValue(c.nameFromString(this.model.dashboard.meta.get("label"))),this.pairedTextControls=new f({sourceDelegate:this.children.titleTextControl,destDelegate:this.children.filenameTextControl,transformFunction:c.nameFromString}),this.children.mode=new i({controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group btn-group-2",modelAttribute:"mode",model:this.model.convertMode,items:[{label:e("Create New").t(),value:d.NEW},{label:e("Replace Current").t(),value:d.REPLACE}],save:!1},label:e("Dashboard").t(),help:e("Recommended").t()}),this.children.title=new i({controls:this.children.titleTextControl,label:e("Title").t()}),this.children.filename=new i({controls:this.children.filenameTextControl,label:e("ID").t(),help:e("Can only contain letters, numbers and underscores.").t(),tooltip:e("The ID is used as the filename on disk. Cannot be changed later.").t()}),this.children.description=new i({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.dashboard.meta,placeholder:e("optional").t(),save:!1},label:e("Description").t()}),this.children.permissions=new i({controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group btn-group-2",modelAttribute:"perms",model:this.model.perms,items:[{label:e("Private").t(),value:"private"},{label:e("Shared").t(),value:"shared"}],save:!1},label:e("Permissions").t()}),this.model.convertMode.on("change:mode",function(){t.children.flashMessages.flashMsgCollection.reset(),t.model.convertMode.get("mode")===d.NEW?(t.children.title.show(),t.children.filename.show(),t.children.description.show(),t.children.permissions.show()):(t.children.flashMessages.flashMsgCollection.add({type:"warning",html:e("This change cannot be undone.").t()}),t.children.title.hide(),t.children.filename.hide(),t.children.description.hide(),t.children.permissions.hide())})},events:t.extend({},r.prototype.events,{"click a.modal-btn-primary":function(e){e.preventDefault(),this.submit()}}),submit:function(){var n=this,r=n.model.dashboard,i=n.model.currentDashboard,s=n.model.application,o=n.model.user,u=h.page(s.get("root"),s.get("locale"),i.entry.acl.get("app"),i.entry.get("name"))+"/converttohtml",f=n.collection&&n.collection.dashboards;if(this.model.convertMode.get("mode")===d.NEW){r.meta.validate();if(r.meta.isValid()){var l=r.meta.toJSON();r.entry.content.set("eai:data",i.entry.content.get("eai:data")),r.entry.content.set("eai:type","views"),r.meta.set(l),r.meta.apply(),t.post(u,{xmlString:r.entry.content.get("eai:data"),newViewID:r.entry.content.get("name")}).done(function(t){r.entry.content.set("eai:type","html"),r.entry.content.set("eai:data",t),r.save({},{data:s.getPermissions(n.model.perms.get("perms"))}).done(function(){f&&n.collection.dashboards.add(n.model.dashboard),e.defer(function(){var e=new a({model:{dashboard:r,application:s,user:o},collection:n.collection});e.render().show()}),n.hide(),n.remove()})})}}else t.post(u,{xmlString:i.entry.content.get("eai:data")}).done(function(t){i.entry.content.set("eai:type","html"),i.entry.content.set("eai:data",t),i.save().done(function(){f&&i.trigger("updateCollection"),e.defer(function(){var e=new a({model:{dashboard:i,application:s},collection:n.collection,refreshOnDismiss:!f});e.render().show()}),n.hide(),n.remove()})})},render:function(){var t=h.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.html.dashboard");return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Convert Dashboard to HTML").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(r.BODY_SELECTOR).append("<p>"+e("HTML dashboards cannot be edited using Splunk's visual editors.").t()+"<br />"+e("Integrated PDF generation is not available for HTML dashboards.").t()+"<br />"+"<a href="+t+">"+e("Learn More").t()+' <i class="icon-external"></i></a></p>'),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.mode.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.title.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.filename.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.description.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.permissions.render().el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Convert Dashboard").t()+"</a>"),this}})}),define("models/services/ScheduledView",["jquery","underscore","backbone","models/SplunkDBase","models/Base","splunk.util","backbone_validation"],function(e,t,n,r,i,s,o){var u=r.extend({defaults:{is_scheduled:!1,"action.email.subject.view":"Splunk Dashboard: '$name$'","action.email.message.view":"A PDF was generated for $name$","action.email.useNSSubject":"1","action.email.papersize":"letter","action.email.paperorientation":"portrait","action.email.priority":"3",cron_schedule:"0 6 * * 1"},initialize:function(){r.prototype.initialize.apply(this,arguments)},url:function(){return"scheduled/views/"+this.viewName},findByName:function(e,n,r){this.viewName=e,this.id="scheduled/views/"+e;var i=this.fetch({data:{app:n,owner:r}});return i.done(t.bind(this.applyDefaultsIfNotScheduled,this)),i},applyDefaultsIfNotScheduled:function(){this.entry.content.get("is_scheduled")||this.entry.content.set(this.defaults)}});return u.Entry=u.Entry.extend({}),u.Entry.Content=u.Entry.Content.extend({validation:{"action.email.to":{fn:"validateEmailList"},"action.email.subject.view":{fn:"validateNSSubject"},"action.email.subject":{fn:"validateSubject"}},validateSubject:function(n,r,i){if(s.normalizeBoolean(i.is_scheduled)&&!s.normalizeBoolean(i["action.email.useNSSubject"])&&(t.isUndefined(n)||e.trim(n).length===0))return t("Subject is empty").t()},validateNSSubject:function(n,r,i){if(s.normalizeBoolean(i.is_scheduled)&&s.normalizeBoolean(i["action.email.useNSSubject"])&&(t.isUndefined(n)||e.trim(n).length===0))return t("Subject is empty").t()},validateEmailList:function(e,n,r){if(r.is_scheduled){if(!e)return t("Email Address list is empty").t();if(t(e.split(/\s*,\s*/)).any(function(e){return!o.patterns.email.test(e)}))return t("Email Address list is invalid").t()}}}),u}),define("views/dashboards/table/controls/SchedulePDF",["module","jquery","underscore","backbone","util/console","util/pdf_utils","models/services/ScheduledView","models/shared/Cron","views/Base","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/EmailOptions","views/shared/ScheduleSentence","views/shared/FlashMessages","uri/route"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=a.extend({render:function(){this.el.innerHTML||this.$el.html(n.template(this.template,{label:this.options.label||"",controlClass:this.options.controlClass||"",body:n.template(this.options.body||"")(this.model?this.model.toJSON?this.model.toJSON():this.model:{})}));var e=this.$(".controls");return n.each(this.options.children,function(t){t.render().appendTo(e)}),this},template:'<label class="control-label"><%- label %></label><div class="controls <%- controlClass %>"><%= body %></div>'});return f.extend({moduleId:e.id,className:"modal schedule-pdf modal-wide",initialize:function(){f.prototype.initialize.apply(this,arguments),this.model.inmem=new o.Entry.Content(this.model.scheduledView.entry.content.toJSON()),this.model.inmem.get("action.email.papersize")||s.getEmailAlertSettings().done(n.bind(function(e){this.model.inmem.get("action.email.papersize")||this.model.inmem.set("action.email.papersize",e.entry.content.get("reportPaperSize"))},this)),this.model.inmem.get("action.email.paperorientation")||s.getEmailAlertSettings().done(n.bind(function(e){this.model.inmem.get("action.email.paperorientation")||this.model.inmem.set("action.email.paperorientation",e.entry.content.get("reportPaperOrientation"))},this));var e=this.model.cron=u.createFromCronString(this.model.inmem.get("cron_schedule")||"0 6 * * 1");this.listenTo(e,"change",function(){this.model.inmem.set("cron_schedule",e.getCronString())},this);var t=d.docHelp(this.model.application.get("root"),this.model.application.get("locale"),"learnmore.alert.email");this.children.flashMessages=new p({model:{scheduledView:this.model.scheduledView,content:this.model.inmem}}),this.children.name=new l({controlType:"Label",controlOptions:{modelAttribute:"label",model:this.model.dashboard.entry.content},label:n("Dashboard").t()}),this.children.schedule=new l({controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"is_scheduled",model:this.model.inmem,save:!1},label:n("Schedule PDF").t()}),this.children.scheduleSentence=new h({model:{cron:this.model.cron,application:this.model.application},lineOneLabel:n("Schedule").t(),popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}}),this.children.emailOptions=new c({model:{state:this.model.inmem,application:this.model.application},toLabel:n("Email To").t(),suffix:"view"}),this.children.paperSize=new l({className:"control-group",controlType:"SyntheticSelect",controlOptions:{modelAttribute:"action.email.papersize",model:this.model.inmem,items:[{label:n("A2").t(),value:"a2"},{label:n("A3").t(),value:"a3"},{label:n("A4").t(),value:"a4"},{label:n("A5").t(),value:"a5"},{label:n("Letter").t(),value:"letter"},{label:n("Legal").t(),value:"legal"}],save:!1,toggleClassName:"btn",popdownOptions:{attachDialogTo:".modal:visible",scrollContainer:".modal:visible .modal-body:visible"}},label:n("Paper Size").t()}),this.children.paperLayout=new l({controlType:"SyntheticRadio",controlOptions:{modelAttribute:"action.email.paperorientation",model:this.model.inmem,items:[{label:n("Portrait").t(),value:"portrait"},{label:n("Landscape").t(),value:"landscape"}],save:!1},label:n("Paper Layout").t()}),this.children.previewLinks=new v({body:'<div class="preview-actions"><div class="test-email"><a href="#" class="action-send-test">'+n("Send Test Email").t()+"</a></div> "+'<a href="#" class="action-preview">'+n("Preview PDF").t()+"</a>"+"</div>"}),this.model.inmem.on("change:is_scheduled",this._toggle,this)},events:t.extend({},f.prototype.events,{"click .action-send-test":function(e){e.preventDefault(),this.model.inmem.validate();if(this.model.inmem.isValid()){var t=this.$(".test-email"),r=this.children.flashMessages.flashMsgCollection;t.html(n("Sending...").t()),s.sendTestEmail(this.model.dashboard.entry.get("name"),this.model.dashboard.entry.acl.get("app"),this.model.inmem.get("action.email.to"),{paperSize:this.model.inmem.get("action.email.papersize"),paperOrientation:this.model.inmem.get("action.email.paperorientation")}).done(function(){t.html('<i class="icon-check"></i> '+n("Email sent.").t())}).fail(function(e){t.html('<span class="error"><i class="icon-warning-sign"></i> '+n("Failed!").t()+"</span>"),e&&r.add({type:"warning",html:n("Sending the test email failed: ").t()+n.escape(e)})}).always(function(){setTimeout(function(){t.html('<a href="#" class="action-send-test">'+n("Send Test Email").t()+"</a>")},5e3)})}},"click .action-preview":function(e){e.preventDefault();var t="",n=this.model.inmem.get("action.email.paperorientation"),r=this.model.inmem.get("action.email.papersize")||"a2";n==="landscape"&&(t="-landscape"),s.getRenderURL(this.model.dashboard.entry.get("name"),this.model.dashboard.entry.acl.get("app"),{"paper-size":r+t}).done(function(e){window.open(e)})},"click .modal-btn-primary":function(e){e.preventDefault(),this.model.inmem.validate();if(this.model.inmem.isValid())if(this.model.inmem.get("is_scheduled")==0&&this.model.scheduledView.entry.content.get("is_scheduled")===!1)this.hide();else{this.model.scheduledView.entry.content.set(this.model.inmem.toJSON());var t=this;this.model.scheduledView.save({},{success:function(){t.hide()}})}}}),_toggle:function(){var e=this.model.inmem.get("is_scheduled")?"show":"hide";this.children.scheduleSentence.$el[e](),this.$emailOptions[e](),this.children.paperSize.$el[e](),this.children.paperLayout.$el[e](),this.children.previewLinks.$el[e]()},render:function(){return this.$el.html(f.TEMPLATE),this.$(f.HEADER_TITLE_SELECTOR).html(n("Edit PDF Schedule").t()),this.children.flashMessages.render().prependTo(this.$(f.BODY_SELECTOR)),this.$(f.BODY_SELECTOR).append(f.FORM_HORIZONTAL_COMPLEX),this.children.name.render().appendTo(this.$(f.BODY_FORM_SELECTOR)),this.children.schedule.render().appendTo(this.$(f.BODY_FORM_SELECTOR)),this.children.scheduleSentence.render().appendTo(this.$(f.BODY_FORM_SELECTOR)),this.$(f.BODY_FORM_SELECTOR).append('<fieldset class="email-options outline"></fieldset>'),this.$emailOptions=this.$el.find(".email-options"),this.children.emailOptions.render().appendTo(this.$emailOptions),this.children.paperSize.render().appendTo(this.$(f.BODY_FORM_SELECTOR)),this.children.paperLayout.render().appendTo(this.$(f.BODY_FORM_SELECTOR)),this.children.previewLinks.render().appendTo(this.$(f.BODY_FORM_SELECTOR)),this.$(f.FOOTER_SELECTOR).append(f.BUTTON_CANCEL),this.$(f.FOOTER_SELECTOR).append(f.BUTTON_SAVE),this._toggle(),this}})}),define("views/dashboards/table/controls/CloneSuccess",["underscore","module","views/shared/Modal","uri/route","views/shared/documentcontrols/dialogs/permissions_dialog/Master","views/dashboards/table/controls/SchedulePDF","models/services/ScheduledView"],function(e,t,n,r,i,s,o){return n.extend({moduleId:t.id,events:$.extend({},n.prototype.events,{"click .edit-perms":function(t){t.preventDefault();var n=this.model,r=this.collection.roles;e.defer(function(){var e=new i({model:{document:n.dashboard,nameModel:n.dashboard.entry.content,user:n.user},collection:r,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0});$("body").append(e.render().el),e.show()}),this.hide(),this.remove()},"click .schedule-pdf":function(t){t.preventDefault();var n=this.model,r=function(){var e=new s({model:{scheduledView:n.scheduledView,dashboard:n.dashboard,application:n.application,appLocal:n.appLocal},onHiddenRemove:!0});$("body").append(e.render().el),e.show()};if(!this.model.scheduledView){var i=n.scheduledView=new o,u=i.findByName(this.model.dashboard.entry.get("name"),this.model.application.get("app"),this.model.application.get("owner"));u.done(r)}else e.defer(r);this.hide(),this.remove()}}),render:function(){this.$el.html(n.TEMPLATE),this.$(n.HEADER_TITLE_SELECTOR).html(e("Dashboard has been cloned.").t()),this.$(n.BODY_SELECTOR).append(n.FORM_HORIZONTAL);var t=r.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.dashboard.entry.acl.get("app"),this.model.dashboard.entry.get("name")),i=this.model.dashboard.entry.acl.get("can_change_perms"),s=this.model.user.canScheduleSearch()&&!this.model.user.isFree()&&(this.model.dashboard.isSimpleXML()||this.model.dashboard.isAdvanced()&&this.model.state.get("pdfgen_type")==="deprecated");return this.$(n.BODY_FORM_SELECTOR).append(e.template(this.messageTemplate,{dashboardLink:t,canChangePerms:i,canSchedule:s})),this.$(n.FOOTER_SELECTOR).append(e.template(this.buttonTemplate,{dashboardLink:t,_:e})),this.$(n.FOOTER_SELECTOR).append(""),this},buttonTemplate:'<a href="<%= dashboardLink %>/edit" class="btn edit-panels"><%- _("Edit Panels").t() %></a><a href="<%= dashboardLink %>" class="btn btn-primary modal-btn-primary"><%- _("View").t() %></a>',messageTemplate:'<p><%- _("You may now view your dashboard, change additional settings, or edit the panels.").t() %></p><p><% if(canChangePerms || canSchedule){ %><%- _("Additional Settings").t() %>:<ul><% if(canChangePerms) { %><li><a href="#" class="edit-perms"><%- _("Permissions").t() %><% } %></a></li><% if(canSchedule) { %><li><a href="#" class="schedule-pdf"><%- _("Schedule PDF Delivery").t() %><% } %></a></li></ul><% } %></p>'})}),define("views/dashboards/table/controls/CloneDashboard",["underscore","module","views/shared/Modal","views/shared/controls/ControlGroup","models/Base","models/search/Dashboard","views/shared/FlashMessages","util/splunkd_utils","views/dashboards/table/controls/CloneSuccess","views/shared/delegates/PairedTextControls","views/shared/controls/TextControl"],function(e,t,n,r,i,s,o,u,a,f,l){return n.extend({moduleId:t.id,initialize:function(){n.prototype.initialize.apply(this,arguments),this.model.perms=new i({clonePermissions:!1}),this.children.flashMessages=new o({model:{dashboard:this.model.dashboard,dashboardMeta:this.model.dashboard.meta}}),this.model.dashboard.meta.set({label:this.model.dashboard.meta.get("label")+e(" Clone").t()}),this.children.titleTextControl=new l({modelAttribute:"label",model:this.model.dashboard.meta,placeholder:e("optional").t(),save:!1}),this.children.filenameTextControl=new l({modelAttribute:"name",model:this.model.dashboard.entry.content,save:!1}),this.children.filenameTextControl.setValue(u.nameFromString(this.model.dashboard.meta.get("label"))),this.pairedTextControls=new f({sourceDelegate:this.children.titleTextControl,destDelegate:this.children.filenameTextControl,transformFunction:u.nameFromString}),this.children.title=new r({controls:this.children.titleTextControl,label:e("Title").t()}),this.children.filename=new r({controls:this.children.filenameTextControl,label:e("ID").t(),help:e("Can only contain letters, numbers and underscores.").t(),tooltip:e("The ID is used as the filename on disk. Cannot be changed later.").t()}),this.children.description=new r({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.dashboard.meta,placeholder:e("optional").t(),save:!1},label:e("New Description").t()}),this.children.permissions=new r({controlType:"SyntheticRadio",controlClass:"controls-halfblock",controlOptions:{className:"btn-group btn-group-2",modelAttribute:"clonePermissions",model:this.model.perms,items:[{label:e("Private").t(),value:!1},{label:e("Clone").t(),value:!0}],save:!1},label:e("Permissions").t()})},events:$.extend({},n.prototype.events,{"click a.modal-btn-primary":function(e){e.preventDefault(),this.submit()}}),createSuccess:function(){this.collection&&this.collection.dashboards&&this.collection.dashboards.add(this.model.dashboard),e.defer(function(){var e=new a({model:{dashboard:this.model.dashboard,application:this.model.application,scheduledView:this.model.scheduledView,appLocal:this.model.appLocal,state:this.model.state,user:this.model.user},collection:this.collection});e.render().show()}.bind(this)),this.hide(),this.remove()},submit:function(){var e=this.model.dashboard;e.meta.validate();if(e.meta.isValid()){e.entry.content.get("eai:type")==="views"&&e.meta.apply();var t=this.model.perms.get("clonePermissions"),n={app:this.model.application.get("app")};n.owner=t&&this.model.acl.get("sharing")!==u.USER?u.NOBODY:this.model.application.get("owner"),e.save({},{data:n,success:function(n,r){if(t){var i=this.model.acl.toDataPayload();i.owner=this.model.application.get("owner"),e.acl.save({},{data:i,success:function(e,t){this.createSuccess()}.bind(this)})}else this.createSuccess()}.bind(this)})}},render:function(){this.$el.html(n.TEMPLATE),this.$(n.HEADER_TITLE_SELECTOR).html(e("Clone").t()),this.$(n.BODY_SELECTOR).prepend(this.children.flashMessages.render().el),this.$(n.BODY_SELECTOR).append(n.FORM_HORIZONTAL),this.$(n.BODY_FORM_SELECTOR).append(this.children.title.render().el),this.$(n.BODY_FORM_SELECTOR).append(this.children.filename.render().el),this.$(n.BODY_FORM_SELECTOR).append(this.children.description.render().el);var t=this.model.acl.get("sharing");return(t===u.APP&&this.model.dashboard.entry.acl.get("can_share_app")||t===u.GLOBAL&&this.model.dashboard.entry.acl.get("can_share_global"))&&this.$(n.BODY_FORM_SELECTOR).append(this.children.permissions.render().el),this.$(n.FOOTER_SELECTOR).append(n.BUTTON_CANCEL),this.$(n.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary">'+e("Clone Dashboard").t()+"</a>"),this}})}),define("splunkjs/mvc/simplexml/dialog/dashboardtitle",["underscore","backbone","module","views/shared/Modal","views/shared/controls/ControlGroup","views/shared/FlashMessages"],function(e,t,n,r,i,s){return r.extend({moduleId:n.id,initialize:function(t){r.prototype.initialize.apply(this,arguments),this.workingModel=this.model.clone(),this.children.flashMessage=new s({model:this.model}),this.children.titleField=new i({controlType:"Text",controlOptions:{modelAttribute:"label",model:this.workingModel,placeholder:e("optional").t()},label:e("Title").t()}),this.children.descriptionField=new i({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.workingModel,placeholder:e("optional").t()},label:e("Description").t()})},events:$.extend({},r.prototype.events,{"click .btn-primary":function(e){this.model.set("label",this.workingModel.get("label")),this.model.set("description",this.workingModel.get("description")),this.hide(),e.preventDefault()}}),render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Edit Title or Description").t()),this.$(r.BODY_SELECTOR).prepend(this.children.flashMessage.render().el),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.titleField.render().el),this.$(r.BODY_FORM_SELECTOR).append(this.children.descriptionField.render().el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_SAVE),this}})}),define("splunkjs/mvc/simplexml/editdashboard/editmenu",["module","jquery","underscore","../dashboardurl","views/shared/PopTart","views/shared/documentcontrols/dialogs/TitleDescriptionDialog","views/shared/documentcontrols/dialogs/permissions_dialog/Master","views/shared/documentcontrols/dialogs/DeleteDialog","uri/route","bootstrap.modal","models/search/Dashboard","views/dashboards/table/controls/ConvertDashboard","views/dashboards/table/controls/CloneDashboard","views/dashboards/table/controls/SchedulePDF","views/shared/dialogs/TextDialog","splunk.util","../dialog/dashboardtitle","models/services/ScheduledView","../../utils","models/ACLReadOnly"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){return i.extend({moduleId:e.id,className:"dropdown-menu",initialize:function(){i.prototype.initialize.apply(this,arguments);var e={button:!0,showOpenActions:!0,deleteRedirect:!1};n.defaults(this.options,e)},events:{"click a.edit-panels":function(e){e.preventDefault(),this.hide(),this.remove(),this.model.state.set("edit",!0)},"click a.schedule-pdf":function(e){e.preventDefault();if(t(e.currentTarget).is(".disabled"))return;this.hide(),this.remove();var n=new p({model:{scheduledView:this.model.scheduledView,dashboard:this.model.dashboard,application:this.model.application,appLocal:this.model.state.appLocal},onHiddenRemove:!0});n.render().appendTo(t("body")),n.show()},"click a.delete":function(e){e.preventDefault(),this.hide(),this.remove();var t=new d({id:"modal-delete-dashboard"});t.dialogShown=function(){this.trigger("show"),n.debounce(function(){this.$(".btn-primary:first").focus()}.bind(this),0)();return},t.settings.set("primaryButtonLabel",n("Delete").t()),t.settings.set("cancelButtonLabel",n("Cancel").t()),t.settings.set("titleLabel",n("Delete").t()),t.setText(v.sprintf(n("Are you sure you want to delete %s?").t(),"<em>"+n.escape(this.model.state.get("label")!==""?this.model.state.get("label"):this.model.dashboard.entry.get("name"))+"</em>")),t.render().appendTo(document.body),t.once("click:primaryButton",function(){this.model.dashboard.destroy().done(function(){var e=y.getPageInfo();y.redirect(a.page(e.root,e.locale,e.app,"dashboards"))})},this),t.on("hidden",function(){t.remove()},this),t.show()},"click a.edit-title-desc":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.titleDialog=new m({model:this.model.state,onHiddenRemove:!0}),t("body").append(this.children.titleDialog.render().el),this.children.titleDialog.show()},"click a.edit-perms":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.permissionsDialog=new o({model:{document:this.model.dashboard,nameModel:this.model.dashboard.entry.content,user:this.model.state.user},collection:this.collection,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0}),t("body").append(this.children.permissionsDialog.render().el),this.children.permissionsDialog.show()},"click a.convert-to-html":function(e){e.preventDefault(),this.hide(),this.remove();var n=new l;n.meta.set(this.model.dashboard.meta.toJSON());var r=this.children.convertDialog=new c({model:{dashboard:n,currentDashboard:this.model.dashboard,application:this.model.application,user:this.model.state.user},collection:{roles:this.collection},onHiddenRemove:!0});t("body").append(r.render().el),r.show()},"click a.clone":function(e){e.preventDefault(),this.hide(),this.remove();var n=new l;n.fetch({success:function(){this.model.dashboard.entry.content.get("eai:type")==="html"?n.setHTML(this.model.dashboard.entry.content.get("eai:data")):n.setXML(this.model.dashboard.entry.content.get("eai:data")),n.meta.set(this.model.dashboard.meta.toJSON());var e=this.children.cloneDialog=new h({model:{dashboard:n,acl:new b(t.extend(!0,{},this.model.dashboard.entry.acl.toJSON())),application:this.model.application,appLocal:this.model.state.appLocal,state:this.model.state,user:this.model.state.user},collection:{roles:this.collection},onHiddenRemove:!0});t("body").append(e.render().el),e.show()}.bind(this)})}},render:function(){var e=this.model.application.toJSON(),t={dashboard:this.model.dashboard.isDashboard(),editLinkViewMode:a.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:a.page(e.root,e.locale,e.app,e.page)}}),editLinkEditMode:a.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:a.page(e.root,e.locale,e.app,e.page)+"/edit"}}),dashboardType:this.model.dashboard.getViewType(),editable:this.model.state.get("editable"),canWrite:this.model.dashboard.entry.acl.canWrite(),canCangePerms:this.model.dashboard.entry.acl.get("can_change_perms"),canEditHtml:this.model.state.user.canEditViewHtml(),removable:this.model.dashboard.entry.acl.get("removable"),isXML:this.model.dashboard.isXML(),isForm:this.model.dashboard.isForm(),isSimpleXML:this.model.dashboard.isSimpleXML(),isHTML:this.model.dashboard.isHTML(),canSchedulePDF:this.model.state.user.canScheduleSearch()&&!this.model.state.user.isFree()&&(this.model.dashboard.isSimpleXML()||this.model.dashboard.isAdvanced()&&this.model.state.get("pdfgen_type")==="deprecated"),isPdfServiceAvailable:this.model.state.get("pdf_available"),showAddTRP:!this.model.state.get("default_timerange"),_:n},r=this.compiledTemplate(t);return this.$el.html(i.prototype.template_menu),this.$el.append(r),this},template:'                <% if (canWrite && (editable || (!isHTML || canEditHtml) || (isSimpleXML && canEditHtml))) { %>                    <ul class="first-group">                        <% if(editable) { %>                        <li><a href="#" class="edit-panels"><%- _("Edit Panels").t() %></a></li>                        <% } %>                        <% if (!isHTML || canEditHtml) { %>                        <li><a href="<%- editLinkViewMode %>" class="edit-source"><%- _("Edit Source").t() %> <span class="dashboard-source-type"><%= dashboardType %></span></a></li>                        <% } %>                        <% if (isSimpleXML && canEditHtml) { %>                        <li><a href="#" class="convert-to-html"><%- _("Convert to HTML").t() %></a></li>                        <% } %>                    </ul>                    <% } %>                    <% if(canCangePerms || (canWrite && isXML) || canSchedulePDF) { %>                    <ul class="second-group">                        <% if(isXML && canWrite) { %>                        <li><a href="#" class="edit-title-desc"><%- _("Edit Title or Description").t() %></a></li>                        <% } %>                        <% if(canCangePerms) { %>                            <li><a href="#" class="edit-perms"><%- _("Edit Permissions").t() %></a></li>                        <% } %>                        <% if(canSchedulePDF) { %>                        <li>                        <% if(isForm) {%>                            <a class="schedule-pdf disabled" href="#" title="<%- _("You cannot schedule PDF delivery for a dashboard with form elements.").t() %>">                        <% } else { %>                            <a class="schedule-pdf" href="#">                        <% } %>                                <%- _("Schedule PDF Delivery").t() %>                            </a>                        </li>                        <% } %>                    </ul>                    <% } %>                    <% if ((!isHTML || canEditHtml) || (canWrite && removable)) { %>                    <ul class="third-group">                        <% if (!isHTML || canEditHtml) { %>                        <li><a href="#" class="clone"><%- _("Clone").t() %></a></li>                        <% } %>                        <% if(canWrite && removable) { %>                        <li><a href="#" class="delete"><%- _("Delete").t() %></a></li>                        <% } %>                    </ul>                <% } %>            '})}),define("splunkjs/mvc/simplexml/editdashboard/moreinfomenu",["module","jquery","underscore","../dashboardurl","views/shared/PopTart","views/shared/documentcontrols/dialogs/TitleDescriptionDialog","views/shared/documentcontrols/dialogs/permissions_dialog/Master","views/shared/documentcontrols/dialogs/DeleteDialog","uri/route","bootstrap.modal","util/splunkd_utils","views/dashboards/table/controls/SchedulePDF","models/services/ScheduledView","models/shared/Cron"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return i.extend({moduleId:e.id,className:"dropdown-menu more-info popdown-dialog",initialize:function(){i.prototype.initialize.apply(this,arguments);var e={button:!0,showOpenActions:!0,deleteRedirect:!1};n.defaults(this.options,e)},events:{"click .edit-schedule":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.schedulePDF=new c({model:{scheduledView:this.model.scheduledView,dashboard:this.model.dashboard,application:this.model.application,appLocal:this.model.state.appLocal},onHiddenRemove:!0}),t("body").append(this.children.schedulePDF.render().el),this.children.schedulePDF.show()},"click a.edit-permissions":function(e){e.preventDefault(),this.hide(),this.remove(),this.children.permissionsDialog=new o({model:{document:this.model.dashboard,nameModel:this.model.dashboard.entry.content,user:this.model.state.user},collection:this.collection,nameLabel:"Dashboard",nameKey:"label",onHiddenRemove:!0}),t("body").append(this.children.permissionsDialog.render().el),this.children.permissionsDialog.show()}},render:function(){var e=this.model.scheduledView.entry.content.get("is_scheduled"),t="-",r=[],s=this.model.dashboard.entry.acl.get("sharing"),o=this.model.dashboard.entry.acl.get("owner"),u=l.getPermissionLabel(s,o),a=this.model.dashboard.entry.acl.get("app");if(e){var f=this.model.scheduledView.entry.content.get("cron_schedule"),c=f?p.createFromCronString(f):null;if(c)switch(c.get("cronType")){case"hourly":t=n("Sent Hourly").t();break;case"daily":t=n("Sent Daily").t();break;case"weekly":t=n("Sent Weekly").t();break;case"monthly":t=n("Sent Monthly").t();break;case"custom":t=n("Sent on a custom schedule").t()}r=(this.model.scheduledView.entry.content.get("action.email.to")||"").split(/\s*,\s*/)}var h={_:n,isScheduled:e,schedule:t,recipients:n(r).chain().filter(n.identity).map(function(e){return['<a href="mailto:',encodeURIComponent(e),'">',n.escape(e),"</a>"].join("")}).value(),shared:this.model.dashboard.entry.acl.get("perms"),owner:o,permissionString:u,canChangePerms:this.model.dashboard.entry.acl.get("can_change_perms"),canScheduleXML:this.model.dashboard.isSimpleXML()&&!this.model.dashboard.isForm()||this.model.dashboard.isAdvanced()&&this.model.state.get("pdfgen_type")==="deprecated",canScheduleUser:this.model.state.user.canScheduleSearch()&&!this.model.state.user.isFree(),isPdfServiceAvailable:this.model.state.get("pdf_available"),appString:a},d=this.compiledTemplate(h);return this.$el.html(i.prototype.template_menu),this.$el.append(d),this},template:'                <div class="popdown-dialog-body">                    <div>                        <dl class="list-dotted">                            <dt class="app"><%- _("App").t() %></dt>                            <dd>                                <%= appString %>                            </dd>                            <% if(canScheduleXML) { %>                                <dt class="schedule"><%- _("Schedule").t() %></dt>                                <dd>                                    <% if(isScheduled) { %>                                        <%= schedule %> <%- _("to").t() %>                                         <%= recipients.join(", ") %>.                                    <% } else { %>                                        <%- _("Not scheduled").t() %>.                                    <% } %>                                     <% if(canScheduleUser && isPdfServiceAvailable) { %>                                        <a href="#" class="edit-schedule"><%- _("Edit").t() %></a>                                    <% } %>                                 </dd>                            <% } %>                             <dt class="permissions"><%- _("Permissions").t() %></dt>                            <dd class="edit-permissions">                                <%- _(permissionString).t() %>                                <% if(canChangePerms) { %>                                    <a href="#" class="edit-permissions"><%- _("Edit").t() %></a>                                <% } %>                         </dl>                    </div>                </div>            '})}),define("splunkjs/mvc/simpleform/inputsettings",["require","underscore","jquery","../settings","../simplexml/controller"],function(e){var t=e("underscore"),n=e("jquery"),r=e("../settings"),i=e("../simplexml/controller"),s=r.extend({validation:{token:{fn:"validateToken"},labelField:{fn:"validateLabelAndValueFields"},valueField:{fn:"validateLabelAndValueFields"},choices:{fn:"validateChoices"}},validateToken:function(e,n){if(!e&&this.get("type")!=="time")return t("Token is required").t()},validateLabelAndValueFields:function(e,n,r){var i=this.get("type")!=="time"&&this.get("type")!=="text",s;r.searchType=="inline"?s=!r.search:s=!1;if(i&&!e&&!s)return t("Field For Label and Value are required for search").t()},validateChoices:function(e,n,r){var i=this.get("type")!=="time"&&this.get("type")!=="text";if(i&&r.choices.length>0){var s=!1,o=!1,u={};t.each(r.choices,function(e){e.value&&(e.label||(s=!0),t.has(u,e.value)&&(o=!0),u[e.value]=!0)});if(s)return t("Static option values must have a name attributed to them").t();if(o)return t("Static option values must be unique").t()}},save:function(e,n,r){var s,o,u,a=this.attributes;e==null||typeof e=="object"?(s=e,r=n):(s={})[e]=n,r=t.extend({validate:!0},r);if(s&&!r.wait){if(!this.set(s,r))return!1}else if(!this._validate(s,r))return!1;return i.model.view.updateInput(this)},destroy:function(){var e=n.Deferred(),t=this;return i.model.view.deleteInput(t.get("id")).done(function(){e.resolve(),t.trigger("removeInput")}).fail(function(t){e.reject(t)}),e.promise()}});return s}),define("views/shared/delegates/Concertina",["jquery","underscore","views/shared/delegates/Base"],function(e,t,n){return n.extend({initialize:function(){var n={body:".concertina-body",group:".concertina-group",heading:".concertina-heading",toggle:".concertina-toggle",groupBody:".concertina-group-body",dockTop:".concertina-dock-top",dockBottom:".concertina-dock-bottom",icon:".icon-concertina-toggle",activeClass:"active",speedMin:100,speedMax:300,speedMinDistance:200,speedMaxDistance:800,easing:"swing"};t.defaults(this.options,n),this.events={},this.events["click "+this.options.body+" "+this.options.toggle]="clickToggle",this.events["click "+this.options.dockTop+" "+this.options.toggle]="clickToggleTop",this.events["click "+this.options.dockBottom+" "+this.options.toggle]="clickToggleBottom",t.defer(this.delegateEvents.bind(this),this.events),this.measurements={},this.elements={},this.reset(),e(window).on("resize."+this.cid,this.reset.bind(this))},clickToggleTop:function(t){t.preventDefault();var n=e(t.currentTarget),r=n.parent().data("original"),i=n.parent().position().top,s=this.elements.$body.scrollTop(),o=r.position().top-i+s;this.elements.$body.animate({scrollTop:o},this.adjustSpeed(s,o),this.options.easing)},clickToggle:function(t){t.preventDefault(),this.scrollUp(e(t.currentTarget).closest(this.options.group),this.elements.$bottomDock.outerHeight())},clickToggleBottom:function(t){t.preventDefault();var n=e(t.currentTarget),r=e(t.currentTarget).parent().data("original").closest(this.options.group);this.scrollUp(r,r.nextAll().length*n.outerHeight())},scrollUp:function(e,t){var n=this.elements.$body.height(),r=this.elements.$body.scrollTop(),i=e.height()+(e.position().top+r)-n+t,s=e.prevAll().length*(e.find(this.options.toggle).outerHeight()-1),o=e.position().top;if(r>i)return;o+r<i+s&&(i=r+o-s),this.elements.$body.animate({scrollTop:i},this.adjustSpeed(r,i),this.options.easing)},adjustSpeed:function(e,t){var n=Math.abs(e-t),r=(n-this.options.speedMinDistance)/(this.options.speedMaxDistance-this.options.speedMinDistance)*(this.options.speedMax-this.options.speedMin)+this.options.speedMin;return Math.min(Math.max(r,this.options.speedMin),this.options.speedMax)},reset:function(){this.elements.$body=this.$(this.options.body),this.elements.$body.off("scroll."+this.cid),this.elements.$body.on("scroll."+this.cid,this.updateDocking.bind(this)),this.elements.$headings=this.elements.$body.find(this.options.heading),this.measurements.scrollBarWidth=this.elements.$body.parent().width()-this.elements.$headings.first().width(),this.elements.$topDock=this.$(this.options.dockTop).css("right",this.measurements.scrollBarWidth+"px").html(""),this.elements.$bottomDock=this.$(this.options.dockBottom).css("right",this.measurements.scrollBarWidth+"px").html(""),this.measurements.containerHeight=this.$el.height(),this.updateDocking()},updateDocking:function(){this.elements.$topDock.html(""),this.elements.$bottomDock.html(""),this.elements.$headings.each(function(t,n){var r=e(n);r.position().top<this.elements.$topDock.height()&&r.clone().appendTo(this.elements.$topDock).data("original",r)}.bind(this)),e(this.elements.$headings.get().reverse()).each(function(t,n){var r=e(n);r.position().top+r.height()>this.measurements.containerHeight-this.elements.$bottomDock.height()&&r.clone().prependTo(this.elements.$bottomDock).data("original",r)}.bind(this))},remove:function(){return n.prototype.remove.apply(this),e(window).off("resize."+this.cid),this.elements.$body&&this.elements.$body.off("scroll."+this.cid),this}})}),define("splunkjs/mvc/simpleform/edit/concertinasettingseditor",["require","exports","module","underscore","jquery","util/console","../../../mvc","views/Base","views/shared/delegates/Concertina","views/shared/controls/ControlGroup"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("util/console"),o=e("../../../mvc"),u=e("views/Base"),a=e("views/shared/delegates/Concertina"),f=e("views/shared/controls/ControlGroup");return u.extend({moduleId:n.id,className:"concertina",initialize:function(){u.prototype.initialize.apply(this,arguments)},render:function(){return this.children.concertina||(this.$el.html(this.template),this.children.concertina=new a({el:this.el}),r(this.options.panels||[]).each(function(e,t){this.renderPanel(e)},this)),this},renderPanel:function(e){var t=i(r.template(this.templatePanel,e)),n=t.find(".concertina-group-body");r(e.controls||[]).each(function(e,t){e.controlOptions.model=this.model;var i=e.controlTypeClass||f,s=this.children[r.unique("control_")]=new i(e);n.append(s.render().$el)},this),this.$(".concertina-body").append(t)},activate:function(){this.children.concertina&&this.children.concertina.reset()},template:'            <div class="concertina-dock-top"></div>            <div class="concertina-body"></div>            <div class="concertina-dock-bottom"></div>        ',templatePanel:'            <div class="concertina-group">            <div class="concertina-heading <%- headingClassName || \'\' %>">                <a href="#" class="concertina-toggle">                    <%- title %>                </a>            </div>            <div class="concertina-group-body panel-body <%- headingClassName ? (headingClassName + \'-body\') : \'\' %>">            </div>            </div>        '})}),function(e,t){function n(e,t,n){return e>t&&e<t+n}e.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var t=0,n=e.ui.ddmanager.droppables[this.options.scope];for(;t<n.length;t++)n[t]===this&&n.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){t==="accept"&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]===this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return!r||(r.currentItem||r.element)[0]===this.element[0]?!1:(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1)},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,t,r){if(!t.offset)return!1;var i,s,o=(e.positionAbs||e.position.absolute).left,u=o+e.helperProportions.width,a=(e.positionAbs||e.position.absolute).top,f=a+e.helperProportions.height,l=t.offset.left,c=l+t.proportions.width,h=t.offset.top,p=h+t.proportions.height;switch(r){case"fit":return l<=o&&u<=c&&h<=a&&f<=p;case"intersect":return l<o+e.helperProportions.width/2&&u-e.helperProportions.width/2<c&&h<a+e.helperProportions.height/2&&f-e.helperProportions.height/2<p;case"pointer":return i=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,s=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,n(s,h,t.proportions.height)&&n(i,l,t.proportions.width);case"touch":return(a>=h&&a<=p||f>=h&&f<=p||a<h&&f>p)&&(o>=l&&o<=c||u>=l&&u<=c||o<l&&u>c);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<s.length;r++){if(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))continue;for(i=0;i<u.length;i++)if(u[i]===s[r].element[0]){s[r].proportions.height=0;continue e}s[r].visible=s[r].element.css("display")!=="none";if(!s[r].visible)continue;o==="mousedown"&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions={width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight}}},drop:function(t,n){var r=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;if(!u)return;this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===i}),s.length&&(r=e.data(s[0],"ui-droppable"),r.greedyChild=u==="isover")),r&&u==="isover"&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this[u==="isout"?"isover":"isout"]=!1,this[u==="isover"?"_over":"_out"].call(this,n),r&&u==="isout"&&(r.isout=!1,r.isover=!0,r._over.call(r,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),define("jquery.ui.droppable",["jquery.ui.widget","jquery.ui.mouse"],function(){}),function(e,t){function n(e,t,n){return e>t&&e<t+n}function r(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||r(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=null,i=!1,s=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type==="static")return!1;this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,s.widgetName+"-item")===s)return r=e(this),!1}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target));if(!r)return!1;if(this.options.handle&&!n){e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)});if(!i)return!1}return this.currentItem=r,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i,s,o=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&o.cursor!=="auto"&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!=="x")this.helper[0].style.top=this.position.top+"px";for(n=this.items.length-1;n>=0;n--){r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r);if(!s)continue;if(r.instance!==this.currentContainer)continue;if(i!==this.currentItem[0]&&this.placeholder[s===1?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&(this.options.type==="semi-dynamic"?!e.contains(this.element[0],i):!0)){this.direction=s===1?"down":"up";if(this.options.tolerance!=="pointer"&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset(),s=this.options.axis,o={};if(!s||s==="x")o.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);if(!s||s==="y")o.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper==="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=this.options.axis==="x"||r+f>u&&r+f<a,h=this.options.axis==="y"||t+l>s&&t+l<o,p=c&&h;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t=this.options.axis==="x"||n(this.positionAbs.top+this.offset.click.top,e.top,e.height),r=this.options.axis==="y"||n(this.positionAbs.left+this.offset.click.left,e.left,e.width),i=t&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o==="right"||s==="down"?2:1:s&&(s==="down"?2:1):!1},_intersectsWithSides:function(e){var t=n(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=n(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s==="right"&&r||s==="left"&&!r:i&&(i==="down"&&t||i==="up"&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,r,i,s,o=[],u=[],a=this._connectWith();if(a&&t)for(n=a.length-1;n>=0;n--){i=e(a[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s])}u.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(n=u.length-1;n>=0;n--)u[n][0].each(function(){o.push(this)});return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--){i=e(h[n]);for(r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s))}for(n=c.length-1;n>=0;n--){o=c[n][1],u=c[n][0];for(r=0,f=u.length;r<f;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--){r=this.items[n];if(r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0])continue;i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;if(!r.placeholder||r.placeholder.constructor===String)n=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),i=e("<"+r+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return r==="tr"?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)}):r==="img"&&i.attr("src",t.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(e,i){if(n&&!r.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}};t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,o,u,a,f,l,c,h,p,d=null,v=null;for(i=this.containers.length-1;i>=0;i--){if(e.contains(this.currentItem[0],this.containers[i].element[0]))continue;if(this._intersectsWith(this.containers[i].containerCache)){if(d&&e.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],v=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0)}if(!d)return;if(this.containers.length===1)this.containers[v].containerCache.over||(this.containers[v]._trigger("over",t,this._uiHash(this)),this.containers[v].containerCache.over=1);else{o=1e4,u=null,p=d.floating||r(this.currentItem),a=p?"left":"top",f=p?"width":"height",l=this.positionAbs[a]+this.offset.click[a];for(s=this.items.length-1;s>=0;s--){if(!e.contains(this.containers[v].element[0],this.items[s].item[0]))continue;if(this.items[s].item[0]===this.currentItem[0])continue;if(p&&!n(this.positionAbs.top+this.offset.click.top,this.items[s].top,this.items[s].height))continue;c=this.items[s].item.offset()[a],h=!1,Math.abs(c-l)>Math.abs(c+this.items[s][f]-l)&&(h=!0,c+=this.items[s][f]),Math.abs(c-l)<o&&(o=Math.abs(c-l),u=this.items[s],this.direction=h?"up":"down")}if(!u&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[v])return;u?this._rearrange(t,u,null,!0):this._rearrange(t,null,this.containers[v].element,!0),this._trigger("change",t,this._uiHash()),this.containers[v]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[v],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[v]._trigger("over",t,this._uiHash(this)),this.containers[v].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper==="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!=="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;i.containment==="parent"&&(i.containment=this.helper[0].parentNode);if(i.containment==="document"||i.containment==="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(i.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(i.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r=e(t).css("overflow")!=="hidden",this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r=t==="absolute"?1:-1,i=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u=this.cssPosition!=="absolute"||this.scrollParent[0]!==document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return this.cssPosition==="relative"&&(this.scrollParent[0]===document||this.scrollParent[0]===this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){this.reverting=!1;var n,r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)if(this._storedCSS[n]==="auto"||this._storedCSS[n]==="static")this._storedCSS[n]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t&&r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(n=this.containers.length-1;n>=0;n--)t||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over=0);this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!t){this._trigger("beforeStop",e,this._uiHash());for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!t){for(n=0;n<r.length;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),define("jquery.ui.sortable",["jquery.ui.widget","jquery.ui.mouse","jquery.ui.draggable","jquery.ui.droppable"],function(){}),define("splunkjs/mvc/simpleform/edit/staticoptionscontrol",["require","exports","module","underscore","jquery","util/console","../../../mvc","views/Base","views/shared/controls/TextControl","jquery.ui.sortable"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("util/console"),o=e("../../../mvc"),u=e("views/Base"),a=e("views/shared/controls/TextControl"),f=e("jquery.ui.sortable"),l=u.extend({moduleId:n.id,initialize:function(){u.prototype.initialize.apply(this,arguments),this._optionsModel=this.options.controlOptions&&this.options.controlOptions.model,this._optionsAttribute=this.options.controlOptions&&this.options.controlOptions.modelAttribute,this._optionPairMap={}},events:{"click a.static-options-add":function(e){e.preventDefault(),this._addOptionPair()}},render:function(){this.$el.html(this.compiledTemplate({_:r}));var e=this._optionsModel&&this._optionsAttribute?this._optionsModel.get(this._optionsAttribute):null;if(e&&e.length)for(var t=0,n=e.length;t<n;t++)this._addOptionPair(e[t]);else this._addOptionPair();this._updateValue();var i=this,s=this.$(".static-options-body").sortable({handle:".drag-handle",tolerance:"pointer"}).on("sortupdate",function(e){i._updateValue()}).on("stop",function(e){i._updateValue()});return this},_addOptionPair:function(e){var t=new c(e||{});t.on("change",this._updateValue,this),t.on("click:remove",function(){this._removeOptionPair(t)},this),this.$(".static-options-body").append(t.render().$el),this._optionPairMap[t.cid]=t},_removeOptionPair:function(e){delete this._optionPairMap[e.cid],e.remove(),this._updateValue(),this.$(".static-option-pair").length===0&&this._addOptionPair()},_updateValue:function(){var e=[],t=this.$(".static-option-pair").removeClass("error"),n=this._optionPairMap,s,o,u,a,f={};for(var l=0,c=t.length;l<c;l++)s=i(t[l]).data("cid"),s&&(o=n[s],o&&(u=o.getLabel(),a=o.getValue(),(u||a)&&e.push({label:u,value:a}),a&&((!u||r.has(f,a))&&o.$el.addClass("error"),f[a]=!0)));this._optionsModel&&this._optionsAttribute&&this._optionsModel.set(this._optionsAttribute,e)},template:'            <div class="static-options-heading">                <div class="static-options-heading-name"><%- _("Name").t() %></div>                <div class="static-options-heading-value"><%- _("Value").t() %></div>            </div>            <div class="static-options-body">            </div>            <a class="static-options-add btn-link pull-right" href="#"><%- _("Add Option").t() %></a>        '}),c=u.extend({className:"static-option-pair control-group",initialize:function(){u.prototype.initialize.apply(this,arguments),this._labelControl=new a({defaultValue:this.options.label||""}),this._labelControl.on("change",this._notifyChange,this),this._valueControl=new a({defaultValue:this.options.value||""}),this._valueControl.on("change",this._notifyChange,this)},events:{"click a.static-option-remove":function(e){e.preventDefault(),this.trigger("click:remove")}},getLabel:function(){return this._labelControl.getValue()},setLabel:function(e){this._labelControl.setValue(e)},getValue:function(){return this._valueControl.getValue()},setValue:function(e){this._valueControl.setValue(e)},render:function(){return this.$el.append(i(this.template)),this.$(".static-option-label").append(this._labelControl.render().$el),this.$(".static-option-value").append(this._valueControl.render().$el),this},_notifyChange:function(){this.trigger("change")},template:'            <div class="drag-handle"></div>            <div class="static-option-label"></div>            <div class="static-option-value"></div>            <a class="static-option-remove btn-link" href="#"><i class="icon-x-circle"></i></a>        '});return l}),define("splunkjs/mvc/simpleform/edit/dynamicoptionscontrol",["require","exports","module","underscore","jquery","backbone","util/console","../../../mvc","views/Base","views/shared/controls/ControlGroup","../../simplexml/controller","../../simplexml/dialog/addpanel/report","../../timerangeview","../../utils","uri/route","util/time","bootstrap.tooltip"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("backbone"),o=e("util/console"),u=e("../../../mvc"),a=e("views/Base"),f=e("views/shared/controls/ControlGroup"),l=e("../../simplexml/controller"),c=e("../../simplexml/dialog/addpanel/report"),h=e("../../timerangeview"),p=e("../../utils"),d=e("uri/route"),v=e("util/time");e("bootstrap.tooltip");var m=a.extend({moduleId:n.id,initialize:function(){a.prototype.initialize.apply(this,arguments),this._optionsModel=this.options.controlOptions&&this.options.controlOptions.model||new s.Model,this._optionsModelProxy=new s.Model,this.listenTo(this._optionsModel,"change",this.onOptionsModelChange,this),this.listenTo(this._optionsModelProxy,"change",this.onProxyModelChange,this),this.onOptionsModelChange(),this.children.elementCreateType=new f({label:r("Content Type").t(),controlType:"SyntheticRadio",controlClass:"controls-thirdblock",controlOptions:{className:"btn-group btn-group-3 add-panel-select",items:[{value:"inline",label:'<i class="icon-search-thin"></i>',tooltip:r("Inline Search").t()},{value:"saved",label:'<i class="icon-report"></i>',tooltip:r("Report").t()}],model:this._optionsModelProxy,modelAttribute:"elementCreateType"}}),this.children.inline=new g({model:this._optionsModelProxy,collection:{timeRanges:l.collection.times}}),this.children.report=new c({model:this._optionsModelProxy,collection:{timeRanges:l.collection.times},controller:l,popdownOptions:{attachDialogTo:".popdown-dialog.open",scrollContainer:".popdown-dialog.open .concertina-body"}})},onOptionsModelChange:function(){if(this._isProxySyncing)return;try{this._isProxySyncing=!0,this._optionsModelProxy.set({elementCreateType:this._optionsModel.get("searchType")||"inline",savedSearchName:this._optionsModel.get("searchName"),search:this._optionsModel.get("search"),earliest_time:this._optionsModel.get("earliest_time"),latest_time:this._optionsModel.get("latest_time")})}finally{this._isProxySyncing=!1}},onProxyModelChange:function(){if(this._isProxySyncing)return;try{this._isProxySyncing=!0,this._optionsModel.set({searchType:this._optionsModelProxy.get("elementCreateType"),searchName:this._optionsModelProxy.get("savedSearchName"),search:this._optionsModelProxy.get("search"),earliest_time:this._optionsModelProxy.get("earliest_time"),latest_time:this._optionsModelProxy.get("latest_time")})}finally{this._isProxySyncing=!1}},render:function(){return this.$el.append(this.children.elementCreateType.render().el),this.$el.append(this.children.inline.render().el),this.$el.append(this.children.report.render().el),this}}),g=a.extend({initialize:function(){a.prototype.initialize.apply(this,arguments),this.children.searchField=new f({controlType:"Textarea",controlOptions:{modelAttribute:"search",model:this.model},label:r("Search String").t(),help:'<a href="#" class="run-search">'+r("Run Search").t()+' <i class="icon-external"></i></a>'}),this.children.timeRangeView=new h({popdownOptions:{attachDialogTo:".popdown-dialog.open",scrollContainer:".popdown-dialog.open .concertina-body"}}),this.children.timeRangeView.val({earliest_time:this.model.get("earliest_time"),latest_time:this.model.get("latest_time")}),this.listenTo(this.model,"change:elementCreateType",this.onModeChange,this),this.listenTo(this.children.timeRangeView,"change",this.onTimeRangeChange,this)},events:{"click a.run-search":function(e){e.preventDefault();var t=this.model.get("search"),n={q:t},r=p.getPageInfo();if(!t)return;this.model.has("dispatch.earliest_time")&&(n.earliest=this.model.get("dispatch.earliest_time"),n.latest=this.model.get("dispatch.latest_time")),p.redirect(d.search(r.root,r.locale,r.app,{data:n}),!0)}},onModeChange:function(){var e=this.model.get("elementCreateType")==="inline"?"show":"hide";this.$el[e]()},onTimeRangeChange:function(e){this.model.set(this.children.timeRangeView.val())},render:function(){return this.children.searchField.render().appendTo(this.el),this.children.timeRangeView.render().$el.appendTo(this.el),this.onModeChange(),this}});return m}),define("splunkjs/mvc/simpleform/edit/defaultcontrol",["require","exports","module","underscore","jquery","util/console","../../../mvc","../inputsettings","views/shared/controls/ControlGroup"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("util/console"),o=e("../../../mvc"),u=e("../inputsettings"),a=e("views/shared/controls/ControlGroup"),f=a.extend({moduleId:n.id,initialize:function(){this._optionsModel=this.options.controlOptions&&this.options.controlOptions.model,this._optionsAttribute=this.options.controlOptions&&this.options.controlOptions.modelAttribute,this._optionsModelProxy=new u(i.extend(!0,{},this._optionsModel?this._optionsModel.toJSON():{})),this.options.controlOptions&&this._optionsModelProxy.set(this.options.controlOptions),this._optionsModel&&this._optionsAttribute&&(this._optionsModelProxy.set("value",this._optionsModel.get(this._optionsAttribute)),this.listenTo(this._optionsModel,"change",this.onOptionsModelChange,this),this.listenTo(this._optionsModelProxy,"change:value",this.onProxyValueChange,this));var e=this.options.inputTypeClass;e&&(this.options.controls=[new e({settings:this._optionsModelProxy})]),a.prototype.initialize.apply(this,arguments)},events:{"click a.default-clear-selection":function(e){e.preventDefault(),this._optionsModelProxy.set("value",null)}},render:function(){return a.prototype.render.apply(this,arguments),this.options.enableClearSelection&&(this._clearSelectionButton||(this._clearSelectionButton=i(r.template(this.clearSelectionTemplate,{_:r}))),this.$(".controls").append(this._clearSelectionButton)),this},onOptionsModelChange:function(){if(this._isProxySyncing)return;try{this._isProxySyncing=!0;var e=i.extend(!0,{},this._optionsModel.changed);delete e.value,this._optionsModelProxy.set(e)}finally{this._isProxySyncing=!1}},onProxyValueChange:function(){if(this._isProxySyncing)return;try{this._isProxySyncing=!0,this._optionsModel.set(this._optionsAttribute,this._optionsModelProxy.get("value"))}finally{this._isProxySyncing=!1}},clearSelectionTemplate:'            <a class="default-clear-selection btn-link" href="#"><%- _("Clear Selection").t() %></a>        '});return f}),define("splunkjs/mvc/simpleform/edit/tokenpreviewcontrol",["require","exports","module","underscore","jquery","util/console","../../../mvc","views/shared/controls/ControlGroup"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("util/console"),o=e("../../../mvc"),u=e("views/shared/controls/ControlGroup"),a=u.extend({moduleId:n.id,initialize:function(){this.options=r.extend({controlType:"Label"},this.options),u.prototype.initialize.apply(this,arguments),this._optionsModel=this.options.controlOptions&&this.options.controlOptions.model,this._optionsModel&&(this.listenTo(this._optionsModel,"change",this.onOptionsModelChange,this),this.onOptionsModelChange())},onOptionsModelChange:function(){var e=this._optionsModel.get("prefix")||"",t=this._optionsModel.get("suffix")||"",n=this._optionsModel.get("valuePrefix")||"",r=this._optionsModel.get("valueSuffix")||"",i=this._optionsModel.get("delimiter")||"",s="";s+=e,s+=n+"value1"+r,s+=i,s+=n+"value2"+r,s+=i+"...",s+=t,this.getAllControls()[0].setValue(s)}});return a}),define("splunkjs/mvc/simpleform/edit/editinputmenu",["require","exports","module","underscore","jquery","util/console","../../../mvc","views/shared/PopTart","../inputsettings","./concertinasettingseditor","../../savedsearchmanager","../../searchmanager","../../utils","./staticoptionscontrol","./dynamicoptionscontrol","./defaultcontrol","./tokenpreviewcontrol","../../radiogroupview","../../dropdownview","../../checkboxgroupview","../../multiselectview","../../timerangeview","views/shared/FlashMessages"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("util/console"),o=e("../../../mvc"),u=e("views/shared/PopTart"),a=e("../inputsettings"),f=e("./concertinasettingseditor"),l=e("../../savedsearchmanager"),c=e("../../searchmanager"),h=e("../../utils"),p=e("./staticoptionscontrol"),d=e("./dynamicoptionscontrol"),v=e("./defaultcontrol"),m=e("./tokenpreviewcontrol"),g=e("../../radiogroupview"),y=e("../../dropdownview"),b=e("../../checkboxgroupview"),w=e("../../multiselectview"),E=e("../../timerangeview"),S=e("views/shared/FlashMessages"),x=u.extend({moduleId:n.id,initialize:function(){this.options.ignoreClasses=["select2-drop-mask","dropdown-menu","ui-datepicker"],u.prototype.initialize.apply(this,arguments),this.workingSettings=new a(this.model.toJSON({tokens:!0}),{applyTokensByDefault:!0,retrieveTokensByDefault:!0}),this.on("shown",this.onShown,this),this.children.flashMessage=new S({model:this.workingSettings})},events:{"click a.input-editor-toggle":function(e){e.preventDefault();var t=i(e.currentTarget).data("label");t&&this.toggleEditType(t)},"click .input-editor-apply":function(e){e.preventDefault(),this.applyChanges()},"click .input-editor-cancel":function(e){e.preventDefault(),this.hide()},"keypress .input-editor-apply":function(e){e.preventDefault(),this.applyChanges()},"keypress .input-editor-cancel":function(e){e.preventDefault(),this.hide()}},toggleEditType:function(e){this._currentToggle&&this._currentToggle.removeClass("selected"),this._currentEditor&&(this._currentEditor.remove(),this._currentEditor=null),this.workingSettings.set("type",e),this._currentToggle=this.$("[data-label='"+e+"']"),this._currentToggle.addClass("selected");var t=Z[e];t&&(this._currentEditor=new f({model:this.workingSettings,panels:t}),this.$(".input-editor-format").append(this._currentEditor.render().$el),this._currentEditor.activate())},onShown:function(){r.defer(r.bind(this._currentToggle.focus,this._currentToggle)),this._currentEditor&&this._currentEditor.activate()},applyChanges:function(){this.workingSettings.validate();if(this.workingSettings.isValid()){var e=this.model.get("search"),t=this.model.get("earliest_time"),n=this.model.get("latest_time"),i=this.model.get("searchName");this.model.set(this.workingSettings.toJSON({tokens:!0}),{tokens:!0}),this.model.save().done(r.bind(function(){var s=this.model.get("searchType");this.model.set("managerid",this.model.get("managerid")||r.uniqueId()),(!s||s==="inline")&&this.model.get("search")?(e!=this.model.get("search")||t!=this.model.get("earliest_time")||n!=this.model.get("latest_time"))&&new c({id:this.model.get("managerid"),latest_time:this.model.get("latest_time"),earliest_time:this.model.get("earliest_time"),search:this.model.get("search"),app:h.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0}):s==="saved"&&this.model.get("searchName")&&i!=this.model.get("searchName")&&new l({id:this.model.get("managerid"),searchname:this.model.get("searchName"),app:h.getCurrentApp(),auto_cancel:90,status_buckets:0,preview:!0,timeFormat:"%s.%Q",wait:0},{replace:!0}),this.hide()},this))}},render:function(){var e={_:r};return this.$el.html(u.prototype.template),this.$(".popdown-dialog-body").append(i(this.compiledTemplate(e))),this.$(".popdown-dialog-body").removeClass("popdown-dialog-padded"),i(".flash-messages-placeholder",this.$el).append(this.children.flashMessage.render().el),this.toggleEditType(this.workingSettings.get("type")),this},template:'            <div class="input-editor-body">                <ul class="input-editor-type">                    <li><a class="edit-text input-editor-toggle" href="#" data-label="text"><i class="icon-text"></i> <%- _("Text").t() %></a></li>                    <li><a class="edit-radio input-editor-toggle" href="#" data-label="radio"><i class="icon-boolean"></i> <%- _("Radio").t() %></a></li>                    <li><a class="edit-dropdown input-editor-toggle" href="#" data-label="dropdown"><i class="icon-triangle-down-small"></i> <%- _("Dropdown").t() %></a></li>                    <li><a class="edit-checkbox input-editor-toggle" href="#" data-label="checkbox"><i class="icon-box-checked"></i> <%- _("Checkbox").t() %></a></li>                    <li><a class="edit-multiselect input-editor-toggle" href="#" data-label="multiselect"><i class="icon-triangle-down-small"></i> <%- _("Multiselect").t() %></a></li>                    <li><a class="edit-trp input-editor-toggle" href="#" data-label="time"><i class="icon-clock"></i> <%- _("Time").t() %></a></li>                </ul>                <div class="input-editor-format"></div>                <div class="flash-messages-placeholder"></div>            </div>            <a class="input-editor-cancel btn pull-left" tabindex="0">'+r("Cancel").t()+'</a>            <a class="input-editor-apply btn btn-primary pull-right" tabindex="0"> '+r("Apply").t()+"</a>        "}),T={label:r("Label").t(),controlType:"Text",controlOptions:{modelAttribute:"label"}},N={label:r("Search on Change").t(),controlType:"SyntheticCheckbox",controlOptions:{modelAttribute:"searchWhenChanged"},className:"editcheckbox"},C={label:r("Token").t(),controlType:"Text",controlOptions:{modelAttribute:"token"},tooltip:r("ID to reference the selected value in search (reference as $token$)").t()},k={label:r("Default").t(),controlType:"Text",controlOptions:{modelAttribute:"default"},tooltip:r("The default value of the input.").t()},L={label:r("Default").t(),controlTypeClass:v,inputTypeClass:g,enableClearSelection:!0,controlOptions:{modelAttribute:"default"},tooltip:r("The default value of the input.").t()},A={label:r("Default").t(),controlTypeClass:v,inputTypeClass:y,enableClearSelection:!0,controlOptions:{modelAttribute:"default"},tooltip:r("The default value of the input.").t()},O={label:r("Default").t(),controlTypeClass:v,inputTypeClass:b,controlOptions:{modelAttribute:"default"},tooltip:r("The default value of the input.").t(),className:"editcheckbox"},M={label:r("Default").t(),controlTypeClass:v,inputTypeClass:w,controlOptions:{modelAttribute:"default"},tooltip:r("The default value of the input.").t()},_={label:r("Default").t(),controlTypeClass:v,inputTypeClass:E,controlOptions:{modelAttribute:"default",popdownOptions:{attachDialogTo:".popdown-dialog.open",scrollContainer:".popdown-dialog.open .concertina-body"}},tooltip:r("The default value of the input.").t()},D={label:r("Seed").t(),controlType:"Text",controlOptions:{modelAttribute:"seed"},tooltip:r("Initial value on page load. Ignored when Default is specified.").t()},P={label:r("Token Prefix").t(),controlType:"Text",controlOptions:{modelAttribute:"prefix",updateOnKeyUp:!0},tooltip:r("String prefixed to the value retrieved by the token").t()},H={label:r("Token Suffix").t(),controlType:"Text",controlOptions:{modelAttribute:"suffix",updateOnKeyUp:!0},tooltip:r("String appended to the value retrieved by the token").t()},B={label:r("Token Value Prefix").t(),controlType:"Text",controlOptions:{modelAttribute:"valuePrefix",updateOnKeyUp:!0},tooltip:r("String prefixed to each specified value of a multiple selection input").t()},j={label:r("Token Value Suffix").t(),controlType:"Text",controlOptions:{modelAttribute:"valueSuffix",updateOnKeyUp:!0},tooltip:r("String appended to each specified value of a multiple selection input").t()},F={label:r("Delimiter").t(),controlType:"Text",controlOptions:{modelAttribute:"delimiter",trimLeadingSpace:!1,trimTrailingSpace:!1,updateOnKeyUp:!0},tooltip:r("String inserted between each value (typical values: AND,OR). Specify a leading and trailing space in the string.").t()},I={label:r("Preview").t(),controlTypeClass:m,controlOptions:{modelAttribute:"TEMP"}},q={controlTypeClass:p,controlOptions:{modelAttribute:"choices"}},R={controlTypeClass:d,controlOptions:{modelAttribute:"TEMP"}},U={label:r("Field For Label").t(),controlType:"Text",controlOptions:{modelAttribute:"labelField"},tooltip:r("Field returned from the search to use as the option label").t()},z={label:r("Field For Value").t(),controlType:"Text",controlOptions:{modelAttribute:"valueField"},tooltip:r("Field returned from the search to use as the option value").t()},W={headingClassName:"general-input-settings",title:r("General").t(),controls:[T,N]},X={headingClassName:"token-input-settings",title:r("Token Options").t(),controls:[C,k,D,P,H]},V={headingClassName:"token-input-settings",title:r("Token Options").t(),controls:[C,L,P,H]},$={headingClassName:"token-input-settings",title:r("Token Options").t(),controls:[C,A,P,H]},J={headingClassName:"token-input-settings",title:r("Token Options").t(),controls:[C,O,P,H,B,j,F,I]},K={headingClassName:"token-input-settings",title:r("Token Options").t(),controls:[C,M,P,H,B,j,F,I]},Q={headingClassName:"token-input-settings",title:r("Token Options").t(),controls:[C,_]},G={headingClassName:"static-input-settings",title:r("Static Options").t(),controls:[q]},Y={headingClassName:"dynamic-input-settings",title:r("Dynamic Options").t(),controls:[R,U,z]},Z={text:[W,X],radio:[W,V,G,Y],dropdown:[W,$,G,Y],checkbox:[W,J,G,Y],multiselect:[W,K,G,Y],time:[W,Q]};return x}),define("splunkjs/mvc/simpleform/edit/menu",["require","exports","module","underscore","jquery","views/shared/dialogs/TextDialog","views/Base","../../simplexml/controller","splunk.util","./editinputmenu"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("views/shared/dialogs/TextDialog"),o=e("views/Base"),u=e("../../simplexml/controller"),a=e("splunk.util"),f=e("./editinputmenu"),l=o.extend({events:{"click a.edit-input":function(e){e.preventDefault();var t=i(e.currentTarget);if(this.editInputMenu&&this.editInputMenu.shown){this.editInputMenu.hide();return}t.addClass("active"),this.editInputMenu=new f({model:this.model,onHiddenRemove:!0}),i("body").append(this.editInputMenu.render().el),this.editInputMenu.show(t),this.editInputMenu.on("hide",function(){t.removeClass("active")},this)},"click a.delete-input":function(e){e.preventDefault();var t=new s({id:"modal_delete",flashModel:u.model.view}),n=this.model;t.on("click:primaryButton",function(){t.preventDefault(),n.destroy().then(function(){t.closeDialog()})}),t.settings.set("primaryButtonLabel",r("Delete").t()),t.settings.set("cancelButtonLabel",r("Cancel").t()),t.settings.set("titleLabel",r("Delete").t());var o=i.trim(this.model.get("label"))||a.sprintf(r("the %s input").t(),r(this.model.get("type")).t());t.setText(a.sprintf(r("Are you sure you want to delete %s?").t(),"<em>"+r.escape(o)+"</em>")),i("body").append(t.render().el),t.show()}},render:function(){return this.$el.html(this.template),this},template:'<div class="edit-dropdown"><a href="#" class="edit-input" title="'+r("Edit Input").t()+'"><i class="icon-pencil"></i></a>'+'<a href="#" class="delete-input" title="'+r("Delete Input").t()+'"><i class="icon-x"></i></a>'+"</div>"});return l}),define("splunkjs/mvc/simpleform/input/base",["require","underscore","jquery","../../basesplunkview","../inputsettings","../../utils","../../simplexml/controller","../edit/menu","splunkjs/mvc","util/console","splunkjs/mvc/tokenutils","../../savedsearchmanager","../formutils"],function(e){var t=e("underscore"),n=e("jquery"),r=e("../../basesplunkview"),i=e("../inputsettings"),s=e("../../utils"),o=e("../../simplexml/controller"),u=e("../edit/menu"),a=e("splunkjs/mvc"),f=e("util/console"),l=e("splunkjs/mvc/tokenutils"),c=e("../../savedsearchmanager"),h=e("../formutils"),p=r.extend({_isDashboardInput:!0,options:{submitOnChange:!1},omitted:["id","name","model","collection","el","attributes","className","tagName","events","settingsOptions"],initialize:function(e){this.configure(),this.initialVisualization&&this.settings.set("type",this.initialVisualization),e=e||{},this.inputId=e.inputId||t.uniqueId((this.id||"input")+"_"),this.settings.set("id",this.id),this._extractTokenName(),this.listenTo(this.settings,"change:label",this.renderLabel),this.listenTo(this.settings,"change:token change:type",this._applyTokenName),this.listenTo(this.settings,"change:type",this._updateType),this.listenToOnce(this.settings,"removeInput",this.remove),this.listenTo(o.getStateModel(),"change:edit",this.onEditModeChange),this.bindToComponent(this.settings.get("managerid"),this.onManagerChange,this)},configure:function(){r.prototype.configure.apply(this,arguments);var e=this.settings.toJSON({tokens:!0});return this.settings=new i(e,this.options.settingsOptions),this},onManagerChange:function(e,t){t instanceof c?this.settings.set({searchName:t.get("searchname"),searchType:"saved"},{tokens:!0}):t&&this.settings.set({searchType:"inline",search:t.get("search",{tokens:!0}),earliest_time:t.get("earliest_time",{tokens:!0}),latest_time:t.get("latest_time",{tokens:!0})},{tokens:!0})},_updateType:function(){this._removeVisualization();var e=this.settings.get("type")||this.initialVisualization,n=h.getInputType(e);f.log("Creating input of type=%o class=%o",e,n);if(!n){this.trigger("typenotfound",e);return}this._bindVizSettings();var r=this.vizSettings.toJSON({tokens:!0});r.settings=this.vizSettings,r.id=this.inputId;var i=this.visualization=new n(r);i.render().$el.appendTo(this.$el),this.listenTo(i,"all",this.trigger,this),this.trigger("create:visualization",i),t.defer(t.bind(function(){this.trigger("change",this.visualization.val(),this.visualization)},this))},_onReady:function(){var e=n.Deferred(),t=function(t){t._onReady(function(){e.resolve()})};return this.visualization?t(this.visualization):this.listenToOnce("create:visualization",t),e.promise()},_bindVizSettings:function(){this.vizSettings=new i(t.omit(this.options,this.omitted),this.options.settingsOptions),this.vizSettings.id=this.inputId,this.settings._sync=s.syncModels(this.settings,this.vizSettings,{auto:!0,exclude:this.omitted.concat(["value","earliest_time","latest_time"])})},_unbindVizSettings:function(){this.settings._sync&&(this.settings._sync.destroy(),this.settings._sync=null),this.vizSettings&&(this.vizSettings.dispose(),this.vizSettings=null)},_extractTokenName:function(){var e=this.settings.get("type"),t=function(e,t,n){return e.indexOf(t)===0?n&&e.slice(-n.length)===n?e.substring(t.length,e.length-n.length):e.substring(t.length):null};if(e!=="time"){var n=this.settings.get("value",{tokens:!0});if(l.isToken(n)){var r=t(l.getTokenName(n),"form.");r&&this.settings.set("token",r)}}else{var i=this.settings.get("earliest_time",{tokens:!0}),s=this.settings.get("latest_time",{tokens:!0});l.isToken(i)&&l.isToken(s)&&(i=t(l.getTokenName(i),"form.",".earliest"),s=t(l.getTokenName(s),"form.",".latest"),i&&s&&i===s&&this.settings.set("token",i))}},_applyTokenName:function(){var e=this.settings.get("type"),t=this.settings.get("token");if(e==="time"){this.settings.unset("value",{tokens:!0});var n={};n.earliest_time=t?"$form."+t+".earliest$":"$earliest$",n.latest_time=t?"$form."+t+".latest$":"$latest$",this.settings.set(n,{tokens:!0})}else this.settings.set({earliest_time:null,latest_time:null},{unset:!0,tokens:!0}),this.settings.set("value","$form."+t+"$",{tokens:!0})},remove:function(){this._removeEditMenu(),this._removeVisualization();var e=this.$el.parent();r.prototype.remove.call(this),e.trigger("itemRemoved")},_removeVisualization:function(){this._unbindVizSettings(),this.visualization&&(this.stopListening(this.visualization),this.visualization.off(),this.visualization.remove(),this.visualization=null)},_createEditMenu:function(){return new u({model:this.settings})},_removeEditMenu:function(){this.editMenu&&(this.editMenu.remove(),this.editMenu=null)},onEditModeChange:function(){this.$(".drag-handle").remove(),o.getStateModel().get("edit")?(n('<div class="drag-handle"></div>').prependTo(this.$el),this.editMenu||(this.editMenu=this._createEditMenu().render().prependTo(this.$el))):this._removeEditMenu()},renderLabel:function(){var e=this.$el.children("label");e.length||(e=n("<label></label>").appendTo(this.el)),e.attr("for",this.inputId);if(this.settings.has("label"))e.html(t.escape(this.settings.get("label"))||"&nbsp;");else{var r=e.text();r&&this.settings.set("label",r)}},hasValue:function(){return this.visualization?this.visualization._hasValueForDashboards():!1},val:function(e){if(this.visualization)return this.visualization.val.apply(this.visualization,arguments)},render:function(){return this.renderLabel(),this._updateType(),this.onEditModeChange(),this}});return p}),define("splunkjs/mvc/simpleform/input/submit",["require","underscore","jquery","../../basesplunkview","../../simplexml/controller","../formutils"],function(e){var t=e("underscore"),n=e("jquery"),r=e("../../basesplunkview"),i=e("../../simplexml/controller"),s=e("../formutils"),o=r.extend({className:"splunk-submit-button form-submit",options:{text:t("Submit").t(),useIcon:!1},events:{"click button":function(e){e.preventDefault(),this.$("button").is(".disabled")||this.trigger("submit",this)},"click .delete-input":function(e){e.preventDefault(),i.model.view.updateFormSettings({submitButton:!1}).done(t.bind(this.remove,this))}},initialize:function(){this.configure(),this.listenTo(this.settings,"change",this.render),this.listenTo(i.getStateModel(),"change:edit",this.onEditModeChange);var e=this.settings;e.set("formReady",s.isFormReady()),t.defer(function(){s.onFormReady().then(function(){e.set("formReady",!0)})}),this.listenTo(e,"change",this.render)},onEditModeChange:function(){this.$(".edit-dropdown").remove();if(i.isEditMode()){var e=n('<div class="edit-dropdown"><a href="#" class="delete-input"><i class="icon-x"/></a></div>');e.find(".delete-input").attr("title",t("Delete submit button").t()),e.prependTo(this.el)}},render:function(){var e=this.$("button");return e.length||(e=n('<button class="btn btn-primary"></button>').appendTo(this.el)),this.settings.get("useIcon")?e.html('<i class="icon-search"></i>'):this.settings.has("text")?e.text(this.settings.get("text")):this.settings.set("text",e.text()),e[this.settings.get("formReady")?"removeClass":"addClass"]("disabled"),this.onEditModeChange(),this}});return o}),define("splunkjs/mvc/simpleform/input/timerange",["require","./base","../../timerangeview","../formutils"],function(e){var t=e("./base"),n=e("../../timerangeview"),r=e("../formutils");r.registerInputType("time",n);var i=t.extend({initialVisualization:"time"});return i}),define("splunkjs/mvc/simplexml/editdashboard/addformmenu",["require","exports","module","underscore","jquery","util/console","../../../mvc","../controller","../../simpleform/input/base","../../simpleform/input/submit","../../simpleform/input/timerange","views/shared/PopTart","../../simpleform/formutils"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("util/console"),o=e("../../../mvc"),u=e("../controller"),a=e("../../simpleform/input/base"),f=e("../../simpleform/input/submit"),l=e("../../simpleform/input/timerange"),c=e("views/shared/PopTart"),h=e("../../simpleform/formutils"),p=c.extend({moduleId:n.id,className:"dropdown-menu",initialize:function(){c.prototype.initialize.apply(this,arguments),this.listenTo(o.Components,"change:submit",this.render)},events:{"click a.add-text":function(e){e.preventDefault(),this.hide(),this.remove(),v("text")},"click a.add-radio":function(e){e.preventDefault(),this.hide(),this.remove(),v("radio")},"click a.add-dropdown":function(e){e.preventDefault(),this.hide(),this.remove(),v("dropdown")},"click a.add-checkbox":function(e){e.preventDefault(),this.hide(),this.remove(),v("checkbox")},"click a.add-multiselect":function(e){e.preventDefault(),this.hide(),this.remove(),v("multiselect")},"click a.add-trp":function(e){e.preventDefault(),this.hide(),this.remove(),v("timerangepicker")},"click a.add-submit":function(e){e.preventDefault();if(i(e.currentTarget).is(".disabled"))return;this.hide(),this.remove(),v("submit")}},render:function(){var e=i("body>.dashboard-body>.fieldset"),t=e.find(".form-submit"),n={showAddSubmit:!t.length,_:r},s=this.compiledTemplate(n);return this.$el.html(c.prototype.template_menu),this.$el.append(s),this},template:'            <ul>                <li><a class="add-text" href="#"><i class="icon-text"></i> <%- _("Text").t() %></a></li>                <li><a class="add-radio" href="#"><i class="icon-boolean"></i> <%- _("Radio").t() %></a></li>                <li><a class="add-dropdown" href="#"><i class="icon-triangle-down-small"></i> <%- _("Dropdown").t() %></a></li>                <li><a class="add-checkbox" href="#"><i class="icon-box-checked"></i> <%- _("Checkbox").t() %></a></li>                <li><a class="add-multiselect" href="#"><i class="icon-triangle-down-small"></i> <%- _("Multiselect").t() %></a></li>                <li><a class="add-trp" href="#"><i class="icon-clock"></i> <%- _("Time").t() %></a></li>                <li>                    <% if (showAddSubmit) { %>                        <a class="add-submit" href="#">                    <% } else {%>                        <a class="add-submit disabled" href="#" title="<%- _("You cannot add more than one Submit Button.").t() %>">                    <% } %>                    <i class="icon-search"></i> <%- _("Submit").t() %></a>                </li>            </ul>        '}),d=function(){return r(o.Components.toJSON()).chain().filter(h.isFormInput).map(function(e){return[e.id,e.settings.get("token")]}).flatten().filter(function(e){return e&&/^field\d+$/.test(e)}).map(function(e){return parseInt(e.slice("field".length),10)}).push(0).max().value()},v=function(e){var t,n=i("body>.dashboard-body>.fieldset");if(e==="submit")t=i("<div></div>"),t.appendTo(n);else{t=i(r.template('<div class="input input-<%- type %>"><label>&nbsp;</label></div>',{type:e}));var s=n.find(".form-submit");s.length?t.insertBefore(s):t.appendTo(n)}var a=(d()||0)+1,f;do f="field"+a++;while(o.Components.has(f));e==="submit"?m(f,t):e==="timerangepicker"?g(f,t):y(e,f,t),u.trigger("formupdate")},m=function(e,t){var n=(new f({id:"search_btn",el:t},{tokens:!0})).render();n.on("submit",function(){h.submitForm()}),u.model.view.updateFormSettings({submitButton:!0}).fail(function(){n.remove()})},g=function(e,t){var n=(new l({id:e,el:t,earliest_time:"$form."+e+".earliest$",latest_time:"$form."+e+".latest$","default":{earliest_time:"0",latest_time:""}},{tokens:!0})).render();n.on("change",function(){h.handleValueChange(n)}),u.trigger("addInput",n.settings)},y=function(e,t,n){var i,s=h.getInputType(e);s.multiValue&&(i={valuePrefix:"",valueSuffix:"",delimiter:" "});var o=(new a(r.extend({type:e,id:t,el:n,label:t,value:"$form."+t+"$"},i),{tokens:!0})).render();o.on("change",function(){h.handleValueChange(o)}),u.trigger("addInput",o.settings)};return p}),define("splunkjs/mvc/simplexml/editdashboard/menuview",["require","exports","module","underscore","jquery","views/Base","../dialog/addpanel","util/pdf_utils","../controller","util/console","../../../mvc","../../utils","uri/route","./editmenu","./moreinfomenu","./addformmenu","helpers/Printer"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("views/Base"),o=e("../dialog/addpanel"),u=e("util/pdf_utils"),a=e("../controller"),f=e("util/console"),l=e("../../../mvc"),c=e("../../utils"),h=e("uri/route"),p=e("./editmenu"),d=e("./moreinfomenu"),v=e("./addformmenu"),m=e("helpers/Printer"),g=s.extend({moduleId:n.id,className:"edit-menu",initialize:function(){s.prototype.initialize.apply(this,arguments),this.model.state.on("change:edit",this.onEditModeChange,this),this.model.state.on("change:editable change:pdf_available",this.render,this),this.model.state.user.on("change",this.render,this)},events:{"click a.edit-btn":function(e){e.preventDefault();var t=i(e.currentTarget);if(this.children.editMenu&&this.children.editMenu.shown){this.children.editMenu.hide();return}this.children.moreInfoMenu&&this.children.moreInfoMenu.shown&&this.children.moreInfoMenu.hide(),t.addClass("active"),this.children.editMenu=new p({model:{application:this.model.application,dashboard:this.model.dashboard,state:this.model.state,scheduledView:this.model.scheduledView},collection:this.collection,showOpenActions:this.options.showOpenActions,deleteRedirect:this.options.deleteRedirect,onHiddenRemove:!0}),i("body").append(this.children.editMenu.render().el),this.children.editMenu.show(t),this.children.editMenu.on("hide",function(){t.removeClass("active")},this)},"click a.more-info-btn":function(e){e.preventDefault();var t=i(e.currentTarget);if(this.children.moreInfoMenu&&this.children.moreInfoMenu.shown){this.children.moreInfoMenu.hide();return}this.children.editMenu&&this.children.editMenu.shown&&this.children.editMenu.hide(),t.addClass("active"),this.children.moreInfoMenu=new d({model:{application:this.model.application,dashboard:this.model.dashboard,state:this.model.state,scheduledView:this.model.scheduledView},collection:this.collection,onHiddenRemove:!0}),i("body").append(this.children.moreInfoMenu.render().el),this.children.moreInfoMenu.show(t),this.children.moreInfoMenu.on("hide",function(){t.removeClass("active")},this)},"click a.edit-done":function(e){e.preventDefault(),this.model.state.set("edit",!1)},"click a.add-form":function(e){e.preventDefault();var t=i(e.currentTarget);if(t.hasClass("disabled"))return;if(this.children.addFormMenu&&this.children.addFormMenu.shown){this.children.addFormMenu.hide();return}t.addClass("active"),this.children.addFormMenu=new v({model:{application:this.model.application,dashboard:this.model.dashboard,state:this.model.state,scheduledView:this.model.scheduledView},collection:this.collection,onHiddenRemove:!0}),i("body").append(this.children.addFormMenu.render().el),this.children.addFormMenu.show(t),this.children.addFormMenu.on("hide",function(){t.removeClass("active")},this)},"click a.add-panel":function(e){e.preventDefault(),this.children.addPanelDialog=new o({controller:this.options.controller}),this.children.addPanelDialog.render().appendTo(i("body")).show()},"click a.print-dashboard":function(e){e.preventDefault(),m.printPage()},"click a.generate-pdf":function(e){e.preventDefault();var t=this.model.dashboard.entry.get("name"),n=this.model.dashboard.entry.acl.get("app"),i={},s=0;r.map(l.Components.get("dashboard").getElementIds(),function(e){var t=l.Components.get(e);t&&t.getExportParams&&r.extend(i,t.getExportParams("sid_"+s)),s++}),u.isPdfServiceAvailable().done(function(e,r){if(r==="pdfgen"){var s=a.model.view.getFlattenedXML({useLoadjob:!1,indent:!1,pdf:!0});f.DEBUG_ENABLED&&f.log(s),u.downloadReportFromXML(s,n,i)}else r==="deprecated"&&u.getRenderURL(t,n,i).done(function(e){window.open(e)})})}},onEditModeChange:function(){var e=this.model.state.get("edit");this.$(".dashboard-view-controls")[e?"hide":"show"](),this.$(".dashboard-edit-controls")[e?"show":"hide"](),this.setAddInputState()},setAddInputState:function(){var e=this.model.scheduledView.entry.content.get("is_scheduled");e?this.$(".add-form").addClass("disabled").tooltip({animation:!1,placement:"bottom",title:r('You must unschedule this dashboard to add form fields. To do this, use the "Schedule PDF Delivery" link in the edit menu.').t()}):this.$(".add-form").removeClass("disabled").tooltip("destroy")},render:function(){var e=this.model.application.toJSON(),t={dashboard:this.model.dashboard.isDashboard(),editLinkViewMode:h.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:h.page(e.root,e.locale,e.app,e.page)}}),editLinkEditMode:h.manager(e.root,e.locale,e.app,["data","ui","views",e.page],{data:{action:"edit",ns:e.app,redirect_override:h.page(e.root,e.locale,e.app,e.page)+"/edit"}}),dashboardType:this.model.dashboard.getViewType(),editable:this.model.state.get("editable"),canWrite:this.model.dashboard.entry.acl.canWrite(),removable:this.model.dashboard.entry.links.get("remove")?!0:!1,isSimpleXML:this.model.dashboard.isSimpleXML(),isHTML:this.model.dashboard.isHTML(),isPdfServiceAvailable:this.model.state.get("pdf_available"),showAddTRP:!this.model.state.get("default_timerange"),isScheduled:this.model.scheduledView.entry.content.get("is_scheduled"),_:r};return this.$el.html(this.compiledTemplate(t)),this.setAddInputState(),this.$(".generate-pdf").tooltip({animation:!1,title:r("Export PDF").t()}),this.$(".print-dashboard").tooltip({animation:!1,title:r("Print").t()}),this.onEditModeChange(),this},template:'            <span class="dashboard-view-controls">                <% if(canWrite) { %>                    <div class="btn-group">                        <a class="btn edit-btn" href="#"><%- _("Edit").t() %> <span class="caret"></span></a>                        <a class="btn more-info-btn" href="#"><%- _("More Info").t() %> <span class="caret"></span></a>                    </div>                <% }else{ %>                    <div class="btn-group">                        <a class="btn edit-btn" href="#"><%- _("Edit").t() %> <span class="caret"></span></a>                    </div>                <% } %>                <div class="btn-group">                    <% if(isSimpleXML && isPdfServiceAvailable) { %>                        <a class="btn generate-pdf" href="#"><i class="icon-export icon-large"></i></a>                    <% } %>                    <a class="btn print-dashboard" href="#"><i class="icon-print icon-large"></i></a>                </div>            </span>            <span class="dashboard-edit-controls" style="display:none;">                <div class="btn-group">                    <a class="btn add-form" href="#"><i class="icon-plus"></i> <%- _("Add Input").t() %> <span class="caret"></span></a>                    <a class="btn add-panel" href="#"><i class="icon-plus"></i> <%- _("Add Panel").t() %></a>                    <a class="btn edit-source" href="<%- editLinkEditMode %>"><i class="icon-code"></i> <%- _("Edit Source").t() %></a>                </div>                <a class="btn btn-primary edit-done" href="#"><%- _("Done").t() %></a>            </span>        '});return g}),define("splunkjs/mvc/simplexml/editdashboard/master",["require","exports","module","underscore","jquery","views/Base","collections/services/authorization/Roles","./menuview"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("views/Base"),o=e("collections/services/authorization/Roles"),u=e("./menuview");return s.extend({className:"splunk-dashboard-controls",initialize:function(){s.prototype.initialize.apply(this,arguments),this.rolesCollection=new o,this.rolesCollection.fetch(),this.children.menuView=new u({model:{state:this.model.state,dashboard:this.model.dashboard,application:this.model.application,scheduledView:this.model.scheduledView},collection:this.rolesCollection,controller:this.options.controller})},render:function(){return this.$el.append(this.children.menuView.render().el),this}})}),define("splunkjs/mvc/simplexml/dragndrop",["require","backbone","underscore","jquery","util/console","./controller"],function(e){var t=e("backbone"),n=e("underscore"),r=e("jquery"),i=e("util/console"),s=e("./controller"),o=r.Deferred(),u=document.createElement("div"),a="draggable"in u||"ondragstart"in u&&"ondrop"in u,f=!1,l=f?"sortable5":"sortable";return f?(i.log("loading html5 sortable"),e(["splunkjs/contrib/jquery.sortable.html5"],o.resolve)):(i.log("loading jquery ui sortable"),e(["jquery.ui.sortable"],o.resolve)),t.View.extend({render:function(){return o.done(this.startDragAndDrop.bind(this)),this},events:{"mouseover .drag-handle":function(e){r(e.target).parents(".dashboard-panel").addClass("drag-hover")},"mouseout .drag-handle":function(e){r(e.target).parents(".dashboard-panel").removeClass("drag-hover")}},startDragAndDrop:function(){this.$el.addClass("dragndrop-enabled"),n.defer(n.bind(function(){this.enablePanelDragAndDrop(),this.enableInputDragAndDrop()},this))},enablePanelDragAndDrop:function(){var e=this,t,s=n.debounce(e.updateDimensions.bind(this),0),o=n(this.enablePanelDragAndDrop).bind(this),u=n.once(function(){i.log("sort STOP");if(t){try{t[l]("destroy")}catch(s){}n.defer(o),e.cleanupEmptyRows(),e.trigger("sortupdate"),t=null,r(window).trigger("resize"),e.$(".dashboard-row").trigger("panelVisibilityChanged")}});this.createNewDropRow(),t=this.$(".dashboard-row")[l]({handle:".drag-handle",connectWith:this.$(".dashboard-row"),placeholder:{element:function(){return r('<div class="sortable-placeholder"><div class="dashboard-panel"></div></div>')},update:function(t,n){e.updateRow(n.parents(".dashboard-row"))}},tolerance:"pointer"}).on("sort",function(e){s()}).on("sortupdate",function(e){u()}).on("stop",function(e){u()}),s(),r(window).trigger("resize")},enableInputDragAndDrop:function(){var e=this,t,i=n.once(function(){if(t){try{t[l]("destroy")}catch(r){}n.defer(function(){e.enableInputDragAndDrop()}),e.trigger("sortupdate"),t=null}});t=this.$(".fieldset")[l]({handle:".drag-handle",connectWith:this.$(".fieldset"),items:">.input",tolerance:"pointer",placeholder:{element:function(e){var t=r('<div class="input ui-sortable-placeholder"><div class="placeholder-inner"></div></div>'),n=e.height();return t.height(n-5),t.children().height(n-15),t[0]},update:function(){}},start:function(){r(".dashboard-body").addClass("form-drag"),r("#search_btn").hide()},stop:function(){r(".dashboard-body").removeClass("form-drag");var e=r("#search_btn");e.length&&e.appendTo(e.parent()).show(),s.trigger("formupdate")}}).on("sortupdate",i).on("stop",i)},destroy:function(){this.$el.removeClass("dragndrop-enabled"),this.cleanupEmptyRows();try{this.$(".dashboard-row")[l]("destroy"),this.$(".fieldset")[l]("destroy")}catch(e){}this.updateDimensions()},updateRow:function(e){var t=r(e).children().not(".ui-sortable-helper"),i=String(Math.floor(1e4/t.not(".sortable-dragging").length)/100)+"%";t.css({width:i});var s=r(e).find(".dashboard-panel");s.css({"min-height":100}).css({"min-height":n.max(n.map(s,function(e){return r(e).height()}))})},updateDimensions:function(){n(this.$(".dashboard-row")).each(this.updateRow)},createNewDropRow:function(){this.cleanupEmptyRows(),this.$(".dashboard-row").after(r('<div class="dashboard-row empty"></div>')),this.$(".dashboard-row").first().before(r('<div class="dashboard-row empty"></div>'))},cleanupEmptyRows:function(){this.$(".dashboard-row").each(function(){var e=r(this);(e.is(":empty")||e.html().match(/^\s+$/))&&e.remove()}),this.$(".dashboard-row.empty").removeClass("empty")},getItemOrder:function(){return n(this.$(".dashboard-row")).map(function(e){return n(r(e).find(".dashboard-panel")).map(function(e){return n(r(e).find(".dashboard-element")).map(function(e){return r(e).attr("id")})})})}})}),define("splunkjs/mvc/simpleform/fieldsetview",["require","exports","module","underscore","jquery","views/Base","../simplexml/controller"],function(e,t){var n=e("underscore"),r=e("jquery"),i=e("views/Base"),s=e("../simplexml/controller");return i.extend({moduleId:t.id,className:"fieldset",initialize:function(){this.listenTo(s,"formupdate",this.render),this.listenTo(s.model,"change:edit change:rootNodeName",this.render),i.prototype.initialize.apply(this,arguments)},isEmpty:function(){return!r.trim(this.$el.html())},render:function(){s.isEditMode()||!n.all(this.$el.find(".input>label"),function(e){return!r.trim(r(e).text())})?this.$el.removeClass("hide-label"):this.$el.addClass("hide-label");var e=s.model.get("rootNodeName");return e!=null&&e!=="form"?this.$el.hide():this.$el.show(),this}})}),define("splunkjs/mvc/simplexml/dashboard/title",["require","underscore","jquery","backbone"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=r.View.extend({initialize:function(){this.model.on("change:edit change:label",this.render,this)},render:function(){return this.model.has("label")||this.model.set({label:this.$el.text()},{silent:!0}),this.$(".edit-label").remove(),this.$el.text(t(this.model.get("label")).t()),this.model.get("edit")&&n('<span class="edit-label">'+t("Edit").t()+": </span>").prependTo(this.$el),this}});return i}),define("splunkjs/mvc/simplexml/dashboard/description",["require","underscore","backbone"],function(e){var t=e("underscore"),n=e("backbone");return n.View.extend({initialize:function(){this.listenTo(this.model,"change:description",this.render,this),this.listenTo(this.model,"change:edit",this.render,this)},render:function(){if(this.model.has("description")){var e=t(this.model.get("description")||"").t(),n=this.model.get("edit");this.$el.text(e)[e&&!n?"show":"hide"]()}return this}})}),define("splunkjs/mvc/simplexml/dashboard/row",["require","underscore","jquery","backbone"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=r.View.extend({initialize:function(){this.listenTo(this.model,"change:edit",this.onEditStateChange,this)},onEditStateChange:function(){this.$el.off("DOMSubtreeModified");if(!this.model.get("edit")&&this.$(".dashboard-panel").length>1){var e=t.debounce(this.alignItemHeights.bind(this),1e3);this.$el.bind("DOMSubtreeModified",e),e()}},onContentChange:function(){this.$el.off("DOMSubtreeModified");var e=this.$(".dashboard-cell");if(e.length===0)return this.remove();e.removeClass("last-visible"),this.model.get("edit")||(e=t(e).filter(function(e){return n(e).find(".dashboard-element:not(.hidden)").length>0||!!n.trim(n(e).find(".fieldset").html())}),e.length>0&&n(e).last().addClass("last-visible")),n(e).css({width:String(100/e.length)+"%"}).find(".panel-element-row").each(function(){var e=n(this).find(".dashboard-element");e.css({width:String(100/e.length)+"%"})}),e.length>1&&this.alignItemHeights(),this.onEditStateChange()},onPanelVisibilityChange:function(){this.onContentChange(),n(window).trigger("resize")},alignItemHeights:function(){var e=this.$el,r=e.find(".dashboard-panel");r.css({"min-height":0}).css({"min-height":t.max(t.map(r,function(e){return n(e).height()}))})},render:function(){return this.onContentChange(),this.$el.off("cellRemoved"),this.$el.off("panelVisibilityChanged"),this.$el.on("cellRemoved",t.bind(this.onContentChange,this)),this.$el.on("panelVisibilityChanged",t.bind(this.onPanelVisibilityChange,this)),this}});return i}),define("splunkjs/mvc/simplexml/dashboard/panel",["require","underscore","jquery","backbone","../../simpleform/fieldsetview"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../simpleform/fieldsetview"),s=r.View.extend({initialize:function(){this.listenTo(this.model,"change:edit",this.onEditStateChange,this)},onElementVisibilityChange:function(){this.$(".dashboard-element:not(.hidden)").length!==0||this.fieldset!=null&&!this.fieldset.isEmpty()?this.show():this.hide();var e=this.model.get("edit");t(this.$el.children(".panel-element-row.grouped")).each(function(t){var r=".dashboard-element"+(e?"":":not(.hidden)"),i=n(t).children(r);i.length>0&&i.css({width:String(100/i.length)+"%"})})},hide:function(){this.$el.is(".hidden")||(this.model.get("edit")||this.$el.hide(),this.$el.addClass("hidden").trigger("panelVisibilityChanged"))},show:function(){this.$el.is(".hidden")&&this.$el.show().removeClass("hidden").trigger("panelVisibilityChanged")},onEditStateChange:function(e){e.get("edit")?(this._dragHandle||(this._dragHandle=n('<div class="drag-handle"><div class="handle-inner"></div></div>')),this._dragHandle.prependTo(this.el),this.$el.is(".hidden")&&this.$el.show().trigger("panelVisibilityChanged"),this.fieldset||(this.fieldset=(new i({el:n('<div class="fieldset"></div>').insertAfter(this._dragHandle)})).render())):(this._dragHandle&&this._dragHandle.detach(),this.$el.is(".hidden")&&this.$el.hide().trigger("panelVisibilityChanged"),this.fieldset&&this.fieldset.isEmpty()&&(this.fieldset.remove(),this.fieldset=null)),this.onElementVisibilityChange()},markGroupedElementRows:function(){t(this.$el.children(".panel-element-row")).chain().map(n).invoke("removeClass","grouped").filter(function(e){return e.children(".dashboard-element").length>1}).invoke("addClass","grouped")},render:function(){if(!this.fieldset){var e=this.$el.children(".fieldset");e.length&&(this.fieldset=(new i({el:e})).render())}return this.onEditStateChange(this.model),this.$el.off("elementVisibilityChanged"),this.markGroupedElementRows(),this.$el.on("elementVisibilityChanged",t.bind(this.onElementVisibilityChange,this)),this},isEmpty:function(){var e=this.$el.children(".panel-element-row"),t=this.$el.children(".fieldset").children(".input");return e.length===0&&t.length===0},events:{itemRemoved:function(e){this.isEmpty()&&this.remove()}},remove:function(){this.fieldset&&this.fieldset.remove(),this.$el.off("elementVisibilityChanged");var e=this.$el.parent();r.View.prototype.remove.call(this),e.trigger("panelRemoved")}});return s}),define("splunkjs/mvc/simplexml/dashboard/empty",["require","exports","module","underscore","jquery","backbone","splunk.util","uri/route"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("backbone"),o=e("splunk.util"),u=e("uri/route"),a=s.View.extend({initialize:function(e){s.View.prototype.initialize.apply(this,arguments),this.listenTo(this.model.state,"change:editable change:edit",this.render,this)},events:{"click a.start-edit":function(e){e.preventDefault(),this.model.state.set("edit",!0)}},render:function(){this.$el.empty().removeClass("empty-dashboard"),this.$el.addClass("empty-dashboard");var e=i('<div class="alert alert-error"><i class="icon-alert"></i></div>');if(this.model.state.get("editable")){var t;if(this.model.state.get("edit"))t=r("Click Add Panel to start.").t();else{t=r("This dashboard has no panels. %s to add panels.").t();var n=o.sprintf('<a class="start-edit" href="#edit">%s</a>',r("Start editing").t());t=o.sprintf(t,n)}i("<span></span>").html(t).appendTo(e)}else i("<span></span>").text(r("This dashboard has no panels.").t()).appendTo(e);return e.appendTo(this.$el),this}});return a}),define("splunkjs/mvc/simpleform/edit/formsettings",["require","exports","module","underscore","jquery","backbone","views/Base","../../simplexml/controller"],function(e,t,n){var r=e("underscore"),i=e("jquery"),s=e("backbone"),o=e("views/Base"),u=e("../../simplexml/controller");return o.extend({className:"form-settings",initialize:function(){o.prototype.initialize.apply(this,arguments),this.model=new s.Model({value:!!u.model.view.isFormAutoRun()}),this.listenTo(this.model,"change",this.update),this.listenTo(this.model,"change:value",function(e,t){u.model.view.updateFormSettings({autoRun:t}).fail(function(){e.set("value",!t)})}),this.listenTo(u.model,"change:rootNodeName",this.render)},events:{"click label":function(e){e.preventDefault(),this.model.get("disabled")||this.model.set("value",!this.model.get("value"))},"click .btn":function(e){e.preventDefault()}},update:function(){this.$("i.icon-check")[this.model.get("value")?"show":"hide"](),this.$("label,.btn")[this.model.get("disabled")?"addClass":"removeClass"]("disabled")},render:function(){return u.model.get("rootNodeName")==="form"?this.$el.html(this.compiledTemplate({label:r("Autorun dashboard").t(),checked:this.model.get("value")})):this.$el.empty(),this},template:'            <label class="checkbox">                  <a href="#" class="btn"><i class="icon-check" <% if (!checked) {%>style="display:none"<% } %>></i></a>                  <%= label%>            </label>        '})}),define("splunkjs/mvc/simplexml/dashboardview",["require","../basesplunkview","../mvc","underscore","jquery","./controller","./editdashboard/master","./dragndrop","util/console","../simpleform/fieldsetview","./dashboard/title","./dashboard/description","./dashboard/row","./dashboard/panel","models/services/ScheduledView","./dashboard/empty","../simpleform/edit/formsettings","views/dashboards/table/controls/SchedulePDF"],function(e){var t=e("../basesplunkview"),n=e("../mvc"),r=e("underscore"),i=e("jquery"),s=e("./controller"),o=e("./editdashboard/master"),u=e("./dragndrop"),a=e("util/console"),f=e("../simpleform/fieldsetview"),l=e("./dashboard/title"),c=e("./dashboard/description"),h=e("./dashboard/row"),p=e("./dashboard/panel"),d=e("models/services/ScheduledView"),v=e("./dashboard/empty"),m=e("../simpleform/edit/formsettings"),g=e("views/dashboards/table/controls/SchedulePDF"),y=t.extend({initialize:function(){this.model=s.getStateModel(),this.model.scheduledView=new d,this.scheduledViewDfd=i.Deferred(),s.onViewModelLoad(function(){var e=this.model.scheduledView.findByName(this.model.view.entry.get("name"),this.model.app.get("app"),this.model.app.get("owner"));e.done(r.bind(this.scheduledViewDfd.resolve,this.scheduledViewDfd)),e.fail(r.bind(this.scheduledViewDfd.reject,this.scheduledViewDfd))},this),this.editControls=new o({model:{state:this.model,dashboard:this.model.view,application:this.model.app,scheduledView:this.model.scheduledView},controller:s}),this.model.on("change:edit",this.onEditStateChange,this),this.listenTo(this.model,"change:dialog",this.handleDialog),this.model.has("dialog")&&this.handleDialog(this.model)},render:function(){var e=this.model;this.rows=r.map(this.$(".dashboard-row"),function(t){return(new h({el:t,model:e})).render()}),this.titleView=(new l({model:this.model,el:this.$(".dashboard-header h2")})).render();var t=this.$("p.description");t.length||(t=i('<p class="description"></p>').appendTo(this.$(".dashboard-header")).hide()),this.descriptionView=(new c({el:t,model:e})).render();var n=this.$el.children(".fieldset");n.length||(n=i('<div class="fieldset"></div>').insertAfter(this.$(".dashboard-header"))),this.fieldsetView=(new f({el:n})).render();var o=i('<div class="edit-dashboard-menu pull-right"></div>').prependTo(this.$(".dashboard-header"));return i.when(this.scheduledViewDfd).then(function(){this.editControls.render().appendTo(o)}.bind(this)),this.panels=r(this.$(".dashboard-panel")).map(function(t){return(new p({el:t,model:e})).render()}),this.onEditStateChange(),r.defer(function(){i("body").removeClass("preload")}),this.$el.addClass(this.model.get("edit")?"edit-mode":"view-mode"),s.onViewModelLoad(function(){if(this.model.view.isSimpleXML())try{this.model.view.captureDashboardStructure(this.getDashboardStructure())}catch(e){a.error("Error capturing dashboard structure - disabling edit mode!",e),this.model.set("editable",!1),this.model.set("edit",!1)}},this),this.updateEmptyState(),this},getController:function(){return s},getStateModel:function(){return this.model},getDashboardStructure:function(){return{fieldset:r(this.$el.children(".fieldset").children(":not(.form-submit)")).map(function(e){return i(e).attr("id")}),rows:r(this.$(".dashboard-row:not(.empty)")).map(function(e){return r(i(e).find(".dashboard-panel")).map(function(e){var t=r(i(e).find(".dashboard-element")).map(function(e){return i(e).attr("id")}),n=r(i(e).find(".input")).map(function(e){return i(e).attr("id")});return{inputs:n,elements:t}})})}},isEmptyDashboard:function(){return!r(this.getDashboardStructure().rows).any(function(e){return r(e).any(function(e){return e.elements.length||e.inputs.length})})},getElementIds:function(){return r(this.getDashboardStructure().rows).chain().flatten().pluck("elements").flatten().value()},updateEmptyState:function(e){this.isEmptyDashboard()&&e!==!0?(this.emptyStateView||(this.emptyStateView=new v({model:{app:this.model.app,state:this.model}})),this.emptyStateView.render().$el.appendTo(this.$el)):this.emptyStateView&&(this.emptyStateView.remove(),this.emptyStateView=null)},enterEditMode:function(){this.leaveEditMode();if(this.model.get("editable")){a.log("Entering edit mode"),this.dragnDrop=new u({el:this.el});try{this.model.view.captureDashboardStructure(this.getDashboardStructure())}catch(e){a.error("Error capturing dashboard structure - disabling edit mode!",e),this.model.set("editable",!1),this.model.set("edit",!1);return}this.dragnDrop.on("sortupdate",r.debounce(this.updatePanelOrder,0),this),this.dragnDrop.render(),this.$el.is(".view-mode")&&this.$el.addClass("edit-mode").removeClass("view-mode"),this.formSettings=(new m).render().insertBefore(this.$el.children(".fieldset"))}else a.log("Aborting edit mode: Dashboard is not editable"),this.model.set("edit",!1)},updatePanelOrder:function(){this.model.get("editable")&&this.model.view.updateStructure(this.getDashboardStructure())},leaveEditMode:function(){this.formSettings&&(this.formSettings.remove(),this.formSettings=null),this.dragnDrop&&(this.dragnDrop.off(),this.dragnDrop.destroy(),this.updatePanelOrder(),this.dragnDrop=null),this.$el.is(".edit-mode")&&this.$el.removeClass("edit-mode").addClass("view-mode"),this.updateEmptyState()},onEditStateChange:function(){this.model.get("edit")?s.onViewModelLoad(this.enterEditMode,this):this.leaveEditMode()},removeElement:function(e){var t=this.$("#"+e),n=t.parent();if(t.siblings(".dashboard-element").length)t.remove();else{var r=t.parents(".panel-element-row");if(r.siblings(".panel-element-row").length||r.siblings(".fieldset").children(".input").length)n=r.parent(),r.remove();else{var i=t.parents(".dashboard-cell");n=i.parent(),i.remove()}}n.trigger("cellRemoved"),this.updateEmptyState()},events:{panelRemoved:function(e){this.onPanelRemoved(i(e.target))}},onPanelRemoved:function(e){var t=e.parent();e.remove(),t.trigger("cellRemoved"),this.updateEmptyState()},createNewElement:function(e){var t=i(r.template(this.rowTemplate,e));return t.appendTo(this.$el),this.rows.push((new h({el:t,model:this.model})).render()),this.panels.push((new p({el:t.find(".dashboard-panel"),model:this.model})).render()),this.updateEmptyState(!0),t.find(".dashboard-element")},handleDialog:function(e){e.get("dialog")&&s.onViewModelLoad(function(){e.get("dialog")==="schedulePDF"&&(e.unset("dialog"),e.view.isForm()||this.openSchedulePDFDialog())},this)},openSchedulePDFDialog:function(){var e=this.model;this.scheduledViewDfd.done(function(){var t=new g({model:{scheduledView:e.scheduledView,dashboard:e.view,application:e.app,appLocal:e.appLocal},onHiddenRemove:!0});i("body").append(t.render().el),t.show()})},rowTemplate:'  <div class="dashboard-row">                            <div class="dashboard-cell" style="width: 100%;">                                <div class="dashboard-panel clearfix">                                    <div class="panel-element-row">                                        <div class="dashboard-element" id="<%= id %>" style="width: 100%">                                            <div class="panel-head"><h3><%- title %></h3></div>                                            <div class="panel-body"></div>                                        </div>                                    </div>                                </div>                            </div>                        </div>'});return y}),define("splunkjs/mvc/simplexml/dashboard",["require","util/console","./dashboardview"],function(e){var t=e("util/console");return t.warn("%s is deprecated. Please require %s instead.","splunkjs/mvc/simplexml/dashboard","splunkjs/mvc/dashboardview"),e("./dashboardview")}),define("splunkjs/mvc/simplexml/element/table",["require","underscore","../../../mvc","./base","../../tableview","util/console","../mapper","splunk.util","../../drilldown"],function(e){var t=e("underscore"),n=e("../../../mvc"),r=e("./base"),i=e("../../tableview"),s=e("util/console"),o=e("../mapper"),u=e("splunk.util"),a=e("../../drilldown"),f=o.extend({tagName:"table",map:function(e,n,r){n.options.wrap=String(u.normalizeBoolean(e.get("display.statistics.wrap",r))),n.options.rowNumbers=String(u.normalizeBoolean(e.get("display.statistics.rowNumbers",r))),n.options.dataOverlayMode=e.get("display.statistics.overlay",r),n.options.drilldown=a.getNormalizedDrilldownType(e.get("display.statistics.drilldown",r),{validValues:["cell","row","none"],"default":"row",aliasMap:{all:"cell",off:"none"}}),n.options.count=e.get("display.prefs.statistics.count",r),n.options.labelField=null,n.options.valueField=null;var i=e.get("display.statistics.fields",r);n.tags.fields=t.isArray(i)?t.isEmpty(i)?null:JSON.stringify(i):i==="[]"?null:i}});o.register("statistics",f);var l=i.extend({panelClassName:"table",prefix:"display.statistics.",reportDefaults:{"display.general.type":"statistics","display.prefs.statistics.count":10,"display.statistics.drilldown":"cell"},getResultsLinkOptions:function(e){return{}}});r.registerVisualization("statistics",l);var c=r.extend({initialVisualization:"statistics"});return c}),define("splunkjs/mvc/simplexml/element/chart",["require","underscore","jquery","backbone","../../../mvc","./base","../../chartview","../mapper","util/console","splunk.util","../../drilldown"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../chartview"),u=e("../mapper"),a=e("util/console"),f=e("splunk.util"),l=e("../../drilldown"),c="display.visualizations.charting.",h="display.visualizations.";u.register("visualizations:charting",u.extend({tagName:"chart",map:function(e,n,r){t(e.toJSON(r)).each(function(t,i){i.substring(0,c.length)===c&&(n.options[i.substring(h.length)]=e.get(i,r))}),r["charting.drilldown"]=l.getNormalizedDrilldownType(r["charting.drilldown"]||r.drilldown,{allowBoolean:!0}),delete r.drilldown,n.removeOptions=["drilldown"],n.options["charting.axisY2.enabled"]=String(f.normalizeBoolean(n.options["charting.axisY2.enabled"]))}}));var p=o.extend({panelClassName:"chart",reportDefaults:{"display.visualizations.show":!0,"display.visualizations.type":"charting","display.general.type":"visualizations"},options:t.defaults({resizable:!0},o.prototype.options),getResultsLinkOptions:function(){return{}}});s.registerVisualization("visualizations:charting",p),s.registerVisualization("visualizations",p);var d=s.extend({initialVisualization:"visualizations:charting"});return d}),define("splunkjs/mvc/simplexml/element/event",["require","underscore","jquery","backbone","../../../mvc","./base","../../eventsviewerview","../mapper","util/console","splunk.util"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../eventsviewerview"),u=e("../mapper"),a=e("util/console"),f=e("splunk.util"),l="display.events.",c=u.extend({tagName:"event",map:function(e,n,r){n.options.count=e.get("display.prefs.events.count",r),t(e.toJSON(r)).each(function(i,s){if(s.indexOf(l)===0){var o=e.get(s,r);t.isArray(o)&&(o=JSON.stringify(o)),n.options[s.substring(l.length)]=o!=null?String(o):null}}),n.options["table.drilldown"]&&(n.options["table.drilldown"]=f.normalizeBoolean(n.options["table.drilldown"])?"all":"none"),n.removeOptions=["drilldown","segmentation"]}});u.register("events:raw",c),u.register("events:list",c),u.register("events:table",c);var h=o.extend({reportDefaults:{"display.general.type":"events","display.prefs.events.count":10},getResultsLinkOptions:function(){return{}}});s.registerVisualization("events",h),s.registerVisualization("events:raw",h),s.registerVisualization("events:list",h),s.registerVisualization("events:table",h);var p=s.extend({initialVisualization:"events"});return p}),define("splunkjs/mvc/simplexml/element/single",["require","underscore","../../../mvc","./base","../../singleview","../mapper","util/console","../../drilldown"],function(e){var t=e("underscore"),n=e("../../../mvc"),r=e("./base"),i=e("../../singleview"),s=e("../mapper"),o=e("util/console"),u=e("../../drilldown");s.register("visualizations:singlevalue",s.extend({tagName:"single",map:function(e,n,r){var i="display.visualizations.singlevalue.";o.log(e.toJSON(r)),t(e.toJSON(r)).each(function(e,t){t.substring(0,i.length)===i&&(n.options[t.substring(i.length)]=e)}),o.log("single export options: ",n.options),n.options.drilldown=u.getNormalizedDrilldownType(n.options.drilldown,{"default":"none"})}}));var a=i.extend({panelClassName:"single",reportDefaults:{"display.visualizations.show":!0,"display.visualizations.type":"singlevalue","display.general.type":"visualizations"},getResultsLinkOptions:function(e){return{"link.visible":!1}}});r.registerVisualization("visualizations:singlevalue",a);var f=r.extend({initialVisualization:"visualizations:singlevalue"});return f}),define("splunkjs/mvc/simplexml/element/map",["require","underscore","jquery","backbone","../../../mvc","./base","../../splunkmapview","../mapper","util/console","../../drilldown"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("../../splunkmapview"),u=e("../mapper"),a=e("util/console"),f=e("../../drilldown"),l="display.visualizations.mapping.",c="display.visualizations.";u.register("visualizations:mapping",u.extend({tagName:"map",map:function(e,n,r){t(e.toJSON()).each(function(t,i){i.indexOf(l)===0&&(n.options[i.substring(c.length)]=e.get(i,r))}),(r||{}).pdf||delete n.options["mapping.data.bounds"],n.options.drilldown=f.getNormalizedDrilldownType(n.options["mapping.drilldown"],{allowBoolean:!0}),delete n.options["mapping.drilldown"]}}));var h=o.extend({panelClassName:"map",options:t.defaults({drilldown:!0,resizable:!0},o.prototype.options),reportDefaults:{"display.visualizations.show":!0,"display.visualizations.type":"mapping","display.general.type":"visualizations"},getResultsLinkOptions:function(){return{}}});s.registerVisualization("visualizations:mapping",h);var p=s.extend({initialVisualization:"visualizations:mapping"});return p}),define("splunkjs/mvc/simplexml/element/list",["require","underscore","jquery","backbone","../../../mvc","./base","util/console"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("./base"),o=e("util/console"),u=s.extend({initialVisualization:"statistics",constructor:function(e){return t.extend(e,{displayRowNumbers:!1,fields:[e.labelField||"",e.valueField||""],sortKey:e.initialSort||e.labelField,sortDirection:e.initialSortDir||"asc"}),o.log("[%o] Creating table with options: %o",e.id,e),s.prototype.constructor.call(this,e)}});return u}),define("splunkjs/mvc/simplexml/element/html",["require","underscore","jquery","backbone","../../../mvc","../../utils","./base","../controller","../../tokenutils","splunk.util"],function(e){var t=e("underscore"),n=e("jquery"),r=e("backbone"),i=e("../../../mvc"),s=e("../../utils"),o=e("./base"),u=e("../controller"),a=e("../../tokenutils"),f=e("splunk.util"),l=o.extend({configure:function(){this.options.settingsOptions=t.extend({tokenEscaper:a.getEscaper("html")},this.options.settingsOptions||{}),o.prototype.configure.apply(this,arguments)},initialize:function(){this.configure(),this.model=new r.Model,this.reportReady=n.Deferred(),this.reportReady.resolve(this.model),this.model.mapToXML=t.bind(this.mapToXML,this),this.settings.on("change",this.render,this),this.listenTo(u.getStateModel(),"change:edit",this.onEditModeChange,this),this._setupTokenDependencies()},mapToXML:function(e,t,n){return{type:"html",content:this.settings.get("html",n),cdata:!0,attributes:{encoded:"1"}}},updateTitle:function(){this.$(".panel-head").remove(),u.isEditMode()&&n('<div class="panel-head"><h3><span class="untitled">HTML Panel</span></h3></div>').prependTo(this.$el)},createPanelElementEditor:function(){},createRefreshTimeIndicator:function(){},render:function(){return this.$("script").remove(),this.settings.has("html")||this.settings.set("html",n.trim(this.$(".panel-body").html()),{tokens:!0}),this.$(".panel-body").html(this.settings.get("html")),this.$("a").each(function(){var e=n(this),t=e.attr("href");t&&t[0]==="/"&&t[1]!=="/"&&e.attr("href",f.make_url(t))}),this.onEditModeChange(u.getStateModel()),this},getExportParams:function(){return{}}});return l}),define("splunkjs/mvc/simplexml/urltokenmodel",["require","exports","module","../basetokenmodel","./dashboardurl","./controller","util/general_utils"],function(e,t,n){var r=e("../basetokenmodel"),i=e("./dashboardurl"),s=e("./controller"),o=e("util/general_utils"),u=r.extend({moduleId:n.id,initialize:function(){i.on("change",function(e,t){this.setFromClassicUrl()},this),this.setFromClassicUrl(),s.router.on("route",function(){this.trigger("url:navigate")},this)},save:function(e,t){this.set(e),this.saveClassicUrl(t)},saveOnlyWithPrefix:function(e,t,n){var r=["^"+e+".*","^earliest$","^latest$"];this.save(o.filterObjectByRegexes(t,r,{allowEmpty:!0,allowObject:!0}),n)},saveClassicUrl:function(e){i.save(this.toJSON(),e)},setFromClassicUrl:function(){this.set(i.toJSON())}});return u}),define("splunkjs/mvc/simpleform/input/text",["require","./base","../../textinputview","../formutils"],function(e){var t=e("./base"),n=e("../../textinputview"),r=e("../formutils");r.registerInputType("text",n,{blankIsUndefined:!0});var i=t.extend({initialVisualization:"text"});return i}),define("splunkjs/mvc/simpleform/input/dropdown",["require","./base","../../dropdownview","../formutils"],function(e){var t=e("./base"),n=e("../../dropdownview"),r=e("../formutils");r.registerInputType("dropdown",n,{choices:!0,multiValue:!1});var i=t.extend({initialVisualization:"dropdown"});return i}),define("splunkjs/mvc/simpleform/input/radiogroup",["require","./base","../../radiogroupview","../formutils"],function(e){var t=e("./base"),n=e("../../radiogroupview"),r=e("../formutils");r.registerInputType("radio",n,{choices:!0,multiValue:!1});var i=t.extend({initialVisualization:"radio"});return i}),define("splunkjs/mvc/simpleform/input",["require","./input/submit","./input/text","./input/dropdown","./input/radiogroup","./input/timerange","./input/submit","./input/text","./input/dropdown","./input/radiogroup","./input/timerange"],function(e){return{SubmitButton:e("./input/submit"),TextInput:e("./input/text"),DropdownInput:e("./input/dropdown"),RadioGroupInput:e("./input/radiogroup"),TimeRangeInput:e("./input/timerange"),Submit:e("./input/submit"),Text:e("./input/text"),Dropdown:e("./input/dropdown"),Radio:e("./input/radiogroup"),TimeRangePicker:e("./input/timerange")}}),define("splunkjs/mvc/simpleform/input/checkboxgroup",["require","./base","../../checkboxgroupview","../formutils"],function(e){var t=e("./base"),n=e("../../checkboxgroupview"),r=e("../formutils");r.registerInputType("checkbox",n,{choices:!0,multiValue:!0});var i=t.extend({initialVisualization:"checkbox"});return i}),define("splunkjs/mvc/simpleform/input/multiselect",["require","./base","../../multiselectview","../formutils"],function(e){var t=e("./base"),n=e("../../multiselectview"),r=e("../formutils");r.registerInputType("multiselect",n,{choices:!0,multiValue:!0});var i=t.extend({initialVisualization:"multiselect"});return i}),define("splunkjs/mvc/simplexml",["require","./simplexml/controller","./simplexml/dashboardview","./simplexml/dashboard","./simplexml/element/table","./simplexml/element/chart","./simplexml/element/event","./simplexml/element/single","./simplexml/element/map","./simplexml/element/list","./simplexml/element/html","./simplexml/urltokenmodel","./searchmanager","./savedsearchmanager","./postprocessmanager","./drilldown","./headerview","./footerview","./simpleform/formutils","./simpleform/input","./simpleform/input/submit","./simpleform/input/text","./simpleform/input/dropdown","./simpleform/input/radiogroup","./simpleform/input/timerange","./simpleform/input/checkboxgroup","./simpleform/input/multiselect","./utils"],function(e){var t=e("./simplexml/controller");return e("./simplexml/dashboardview"),e("./simplexml/dashboard"),e("./simplexml/element/table"),e("./simplexml/element/chart"),e("./simplexml/element/event"),e("./simplexml/element/single"),e("./simplexml/element/map"),e("./simplexml/element/list"),e("./simplexml/element/html"),e("./simplexml/urltokenmodel"),e("./searchmanager"),e("./savedsearchmanager"),e("./postprocessmanager"),e("./drilldown"),e("./headerview"),e("./footerview"),e("./simpleform/formutils"),e("./simpleform/input"),e("./simpleform/input/submit"),e("./simpleform/input/text"),e("./simpleform/input/dropdown"),e("./simpleform/input/radiogroup"),e("./simpleform/input/timerange"),e("./simpleform/input/checkboxgroup"),e("./simpleform/input/multiselect"),e("./utils"),t});
